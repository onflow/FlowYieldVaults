
[1/10] Running all preset scenarios (extreme, gradual, volatile)...
Running all preset scenarios...
Running test: testExtremePriceMovements

======================================================================
|== AUTO-BORROW SCENARIO: Extreme FLOW Price Volatility
======================================================================


======================================================================
| [PRICE UPDATE] Setting FLOW price
|    Token Identifier: A.0000000000000003.FlowToken.Vault
|    New Price: 1.00000000 MOET
|    Previous Price: (not tracked - consider adding if needed)
|    Price update successful
======================================================================


======================================================================
| [PRICE UPDATE] Setting MOET price
|    Token Identifier: A.0000000000000008.MOET.Vault
|    New Price: 1.00000000 MOET
|    Previous Price: (not tracked - consider adding if needed)
|    Price update successful
======================================================================

Creating position with 1000 FLOW...
Initial position health: 1.30000000

======================================================================
|== Stage 0: FLOW drops 50% to 0.5
======================================================================


======================================================================
| [PRICE UPDATE] Setting FLOW price
|    Token Identifier: A.0000000000000003.FlowToken.Vault
|    New Price: 0.50000000 MOET
|    Previous Price: (not tracked - consider adding if needed)
|    Price update successful
======================================================================

Health before rebalance: 0.65000000
Triggering rebalance...
Health after rebalance: 0.86666666

======================================================================
| POSITION STATE: After price = 0.50000000
======================================================================
| Position ID: 0
| Health Ratio: 0.86666666
======================================================================
| PRICES:
|   FLOW: 0.50000000 MOET
|   MOET: 1.00000000 (pegged)
======================================================================
| BALANCES:
|   MOET Debt: 23076.92307693 (BORROWED)
|   -> Value: 23076.92307693 MOET
|   FLOW Collateral: 50000.00000000
|   -> Value: 25000.00000000 MOET
======================================================================
| METRICS:
|   Effective Collateral: 20000.00000000 MOET
|   Utilization Rate: 115.38461500%
======================================================================


======================================================================
|== Stage 1: FLOW crashes 90% to 0.1
======================================================================


======================================================================
| [PRICE UPDATE] Setting FLOW price
|    Token Identifier: A.0000000000000003.FlowToken.Vault
|    New Price: 0.10000000 MOET
|    Previous Price: (not tracked - consider adding if needed)
|    Price update successful
======================================================================

Health before rebalance: 0.17333333
Triggering rebalance...
Health after rebalance: 0.19597989

======================================================================
| POSITION STATE: After price = 0.10000000
======================================================================
| Position ID: 0
| Health Ratio: 0.19597989
======================================================================
| PRICES:
|   FLOW: 0.10000000 MOET
|   MOET: 1.00000000 (pegged)
======================================================================
| BALANCES:
|   MOET Debt: 20410.25640238 (BORROWED)
|   -> Value: 20410.25640238 MOET
|   FLOW Collateral: 50000.00000000
|   -> Value: 5000.00000000 MOET
======================================================================
| METRICS:
|   Effective Collateral: 4000.00000000 MOET
|   Utilization Rate: 510.25641000%
======================================================================


======================================================================
|== Stage 2: FLOW recovers to 2.0 (2x original)
======================================================================


======================================================================
| [PRICE UPDATE] Setting FLOW price
|    Token Identifier: A.0000000000000003.FlowToken.Vault
|    New Price: 2.00000000 MOET
|    Previous Price: (not tracked - consider adding if needed)
|    Price update successful
======================================================================

Health before rebalance: 3.91959799
Triggering rebalance...
Health after rebalance: 1.30000000

======================================================================
| POSITION STATE: After price = 2.00000000
======================================================================
| Position ID: 0
| Health Ratio: 1.30000000
======================================================================
| PRICES:
|   FLOW: 2.00000000 MOET
|   MOET: 1.00000000 (pegged)
======================================================================
| BALANCES:
|   MOET Debt: 61538.46153846 (BORROWED)
|   -> Value: 61538.46153846 MOET
|   FLOW Collateral: 50000.00000000
|   -> Value: 100000.00000000 MOET
======================================================================
| METRICS:
|   Effective Collateral: 80000.00000000 MOET
|   Utilization Rate: 76.92307600%
======================================================================


======================================================================
|== Stage 3: FLOW moons to 5.0 (5x original)
======================================================================


======================================================================
| [PRICE UPDATE] Setting FLOW price
|    Token Identifier: A.0000000000000003.FlowToken.Vault
|    New Price: 5.00000000 MOET
|    Previous Price: (not tracked - consider adding if needed)
|    Price update successful
======================================================================

Health before rebalance: 3.25000000
Triggering rebalance...
Health after rebalance: 1.30000000

======================================================================
| POSITION STATE: After price = 5.00000000
======================================================================
| Position ID: 0
| Health Ratio: 1.30000000
======================================================================
| PRICES:
|   FLOW: 5.00000000 MOET
|   MOET: 1.00000000 (pegged)
======================================================================
| BALANCES:
|   MOET Debt: 153846.15384615 (BORROWED)
|   -> Value: 153846.15384615 MOET
|   FLOW Collateral: 50000.00000000
|   -> Value: 250000.00000000 MOET
======================================================================
| METRICS:
|   Effective Collateral: 200000.00000000 MOET
|   Utilization Rate: 76.92307600%
======================================================================


======================================================================
|== Stage 4: FLOW crashes back to 0.25
======================================================================


======================================================================
| [PRICE UPDATE] Setting FLOW price
|    Token Identifier: A.0000000000000003.FlowToken.Vault
|    New Price: 0.25000000 MOET
|    Previous Price: (not tracked - consider adding if needed)
|    Price update successful
======================================================================

Health before rebalance: 0.06500000
Triggering rebalance...
Health after rebalance: 0.06824146

======================================================================
| POSITION STATE: After price = 0.25000000
======================================================================
| Position ID: 0
| Health Ratio: 0.06824146
======================================================================
| PRICES:
|   FLOW: 0.25000000 MOET
|   MOET: 1.00000000 (pegged)
======================================================================
| BALANCES:
|   MOET Debt: 146538.46153846 (BORROWED)
|   -> Value: 146538.46153846 MOET
|   FLOW Collateral: 50000.00000000
|   -> Value: 12500.00000000 MOET
======================================================================
| METRICS:
|   Effective Collateral: 10000.00000000 MOET
|   Utilization Rate: 1465.38461500%
======================================================================


======================================================================
|== Stage 5: FLOW stabilizes at 1.0
======================================================================


======================================================================
| [PRICE UPDATE] Setting FLOW price
|    Token Identifier: A.0000000000000003.FlowToken.Vault
|    New Price: 1.00000000 MOET
|    Previous Price: (not tracked - consider adding if needed)
|    Price update successful
======================================================================

Health before rebalance: 0.27296587
Triggering rebalance...
Health after rebalance: 0.32725200

======================================================================
| POSITION STATE: After price = 1.00000000
======================================================================
| Position ID: 0
| Health Ratio: 0.32725200
======================================================================
| PRICES:
|   FLOW: 1.00000000 MOET
|   MOET: 1.00000000 (pegged)
======================================================================
| BALANCES:
|   MOET Debt: 122229.96142012 (BORROWED)
|   -> Value: 122229.96142012 MOET
|   FLOW Collateral: 50000.00000000
|   -> Value: 50000.00000000 MOET
======================================================================
| METRICS:
|   Effective Collateral: 40000.00000000 MOET
|   Utilization Rate: 305.57490300%
======================================================================


======================================================================
|== AUTO-BALANCER SCENARIO: Gradual YieldToken Price Changes
======================================================================

Creating Tide with TracerStrategy...
Initial AutoBalancer balance: 615.38461538 YieldToken

======================================================================
|== Stage 0: YieldToken +10% to 1.1
======================================================================


======================================================================
| [PRICE UPDATE] Setting YieldToken price
|    Token Identifier: A.0000000000000010.YieldToken.Vault
|    New Price: 1.10000000 MOET
|    Previous Price: (not tracked - consider adding if needed)
|    Price update successful
======================================================================


======================================================================
| AUTO-BALANCER STATE: Before Rebalance
======================================================================
| Tide ID: 0
| AutoBalancer ID: 0
======================================================================
| PRICES:
|   FLOW: 1.00000000 MOET
|   YieldToken: 1.10000000 MOET
|   MOET: 1.00000000 (pegged)
======================================================================
| HOLDINGS:
|   YieldToken Balance: 615.38461538
|   -> Value in MOET: 676.92307691
|   -> Value in USD: 676.92307691
======================================================================
| POSITION METRICS:
|   Initial FLOW Deposit: 1000.00000000
|   Initial Value: 1000.00000000 MOET
|   Expected MOET Borrowed: ~615.38461538
|   Expected YieldTokens: ~559.44055943
======================================================================
| PERFORMANCE:
|   Current/Expected Value: 109.99999900%
|   Status: ABOVE threshold (>105%) - should rebalance DOWN
======================================================================

Triggering rebalance...

======================================================================
| AUTO-BALANCER STATE: After Rebalance
======================================================================
| Tide ID: 0
| AutoBalancer ID: 0
======================================================================
| PRICES:
|   FLOW: 1.00000000 MOET
|   YieldToken: 1.10000000 MOET
|   MOET: 1.00000000 (pegged)
======================================================================
| HOLDINGS:
|   YieldToken Balance: 615.38461538
|   -> Value in MOET: 676.92307691
|   -> Value in USD: 676.92307691
======================================================================
| POSITION METRICS:
|   Initial FLOW Deposit: 1000.00000000
|   Initial Value: 1000.00000000 MOET
|   Expected MOET Borrowed: ~615.38461538
|   Expected YieldTokens: ~559.44055943
======================================================================
| PERFORMANCE:
|   Current/Expected Value: 109.99999900%
|   Status: ABOVE threshold (>105%) - should rebalance DOWN
======================================================================

Balance UNCHANGED

======================================================================
|== Stage 1: YieldToken +20% to 1.2
======================================================================


======================================================================
| [PRICE UPDATE] Setting YieldToken price
|    Token Identifier: A.0000000000000010.YieldToken.Vault
|    New Price: 1.20000000 MOET
|    Previous Price: (not tracked - consider adding if needed)
|    Price update successful
======================================================================


======================================================================
| AUTO-BALANCER STATE: Before Rebalance
======================================================================
| Tide ID: 0
| AutoBalancer ID: 0
======================================================================
| PRICES:
|   FLOW: 1.00000000 MOET
|   YieldToken: 1.20000000 MOET
|   MOET: 1.00000000 (pegged)
======================================================================
| HOLDINGS:
|   YieldToken Balance: 615.38461538
|   -> Value in MOET: 738.46153845
|   -> Value in USD: 738.46153845
======================================================================
| POSITION METRICS:
|   Initial FLOW Deposit: 1000.00000000
|   Initial Value: 1000.00000000 MOET
|   Expected MOET Borrowed: ~615.38461538
|   Expected YieldTokens: ~512.82051281
======================================================================
| PERFORMANCE:
|   Current/Expected Value: 119.99999900%
|   Status: ABOVE threshold (>105%) - should rebalance DOWN
======================================================================

Triggering rebalance...

======================================================================
| AUTO-BALANCER STATE: After Rebalance
======================================================================
| Tide ID: 0
| AutoBalancer ID: 0
======================================================================
| PRICES:
|   FLOW: 1.00000000 MOET
|   YieldToken: 1.20000000 MOET
|   MOET: 1.00000000 (pegged)
======================================================================
| HOLDINGS:
|   YieldToken Balance: 615.38461538
|   -> Value in MOET: 738.46153845
|   -> Value in USD: 738.46153845
======================================================================
| POSITION METRICS:
|   Initial FLOW Deposit: 1000.00000000
|   Initial Value: 1000.00000000 MOET
|   Expected MOET Borrowed: ~615.38461538
|   Expected YieldTokens: ~512.82051281
======================================================================
| PERFORMANCE:
|   Current/Expected Value: 119.99999900%
|   Status: ABOVE threshold (>105%) - should rebalance DOWN
======================================================================

Balance UNCHANGED

======================================================================
|== Stage 2: YieldToken +30% to 1.3
======================================================================


======================================================================
| [PRICE UPDATE] Setting YieldToken price
|    Token Identifier: A.0000000000000010.YieldToken.Vault
|    New Price: 1.30000000 MOET
|    Previous Price: (not tracked - consider adding if needed)
|    Price update successful
======================================================================


======================================================================
| AUTO-BALANCER STATE: Before Rebalance
======================================================================
| Tide ID: 0
| AutoBalancer ID: 0
======================================================================
| PRICES:
|   FLOW: 1.00000000 MOET
|   YieldToken: 1.30000000 MOET
|   MOET: 1.00000000 (pegged)
======================================================================
| HOLDINGS:
|   YieldToken Balance: 615.38461538
|   -> Value in MOET: 799.99999999
|   -> Value in USD: 799.99999999
======================================================================
| POSITION METRICS:
|   Initial FLOW Deposit: 1000.00000000
|   Initial Value: 1000.00000000 MOET
|   Expected MOET Borrowed: ~615.38461538
|   Expected YieldTokens: ~473.37278106
======================================================================
| PERFORMANCE:
|   Current/Expected Value: 129.99999900%
|   Status: ABOVE threshold (>105%) - should rebalance DOWN
======================================================================

Triggering rebalance...

======================================================================
| AUTO-BALANCER STATE: After Rebalance
======================================================================
| Tide ID: 0
| AutoBalancer ID: 0
======================================================================
| PRICES:
|   FLOW: 1.00000000 MOET
|   YieldToken: 1.30000000 MOET
|   MOET: 1.00000000 (pegged)
======================================================================
| HOLDINGS:
|   YieldToken Balance: 615.38461538
|   -> Value in MOET: 799.99999999
|   -> Value in USD: 799.99999999
======================================================================
| POSITION METRICS:
|   Initial FLOW Deposit: 1000.00000000
|   Initial Value: 1000.00000000 MOET
|   Expected MOET Borrowed: ~615.38461538
|   Expected YieldTokens: ~473.37278106
======================================================================
| PERFORMANCE:
|   Current/Expected Value: 129.99999900%
|   Status: ABOVE threshold (>105%) - should rebalance DOWN
======================================================================

Balance UNCHANGED

======================================================================
|== Stage 3: YieldToken +40% to 1.4
======================================================================


======================================================================
| [PRICE UPDATE] Setting YieldToken price
|    Token Identifier: A.0000000000000010.YieldToken.Vault
|    New Price: 1.40000000 MOET
|    Previous Price: (not tracked - consider adding if needed)
|    Price update successful
======================================================================


======================================================================
| AUTO-BALANCER STATE: Before Rebalance
======================================================================
| Tide ID: 0
| AutoBalancer ID: 0
======================================================================
| PRICES:
|   FLOW: 1.00000000 MOET
|   YieldToken: 1.40000000 MOET
|   MOET: 1.00000000 (pegged)
======================================================================
| HOLDINGS:
|   YieldToken Balance: 615.38461538
|   -> Value in MOET: 861.53846153
|   -> Value in USD: 861.53846153
======================================================================
| POSITION METRICS:
|   Initial FLOW Deposit: 1000.00000000
|   Initial Value: 1000.00000000 MOET
|   Expected MOET Borrowed: ~615.38461538
|   Expected YieldTokens: ~439.56043955
======================================================================
| PERFORMANCE:
|   Current/Expected Value: 139.99999900%
|   Status: ABOVE threshold (>105%) - should rebalance DOWN
======================================================================

Triggering rebalance...

======================================================================
| AUTO-BALANCER STATE: After Rebalance
======================================================================
| Tide ID: 0
| AutoBalancer ID: 0
======================================================================
| PRICES:
|   FLOW: 1.00000000 MOET
|   YieldToken: 1.40000000 MOET
|   MOET: 1.00000000 (pegged)
======================================================================
| HOLDINGS:
|   YieldToken Balance: 615.38461538
|   -> Value in MOET: 861.53846153
|   -> Value in USD: 861.53846153
======================================================================
| POSITION METRICS:
|   Initial FLOW Deposit: 1000.00000000
|   Initial Value: 1000.00000000 MOET
|   Expected MOET Borrowed: ~615.38461538
|   Expected YieldTokens: ~439.56043955
======================================================================
| PERFORMANCE:
|   Current/Expected Value: 139.99999900%
|   Status: ABOVE threshold (>105%) - should rebalance DOWN
======================================================================

Balance UNCHANGED

======================================================================
|== Stage 4: YieldToken +50% to 1.5
======================================================================


======================================================================
| [PRICE UPDATE] Setting YieldToken price
|    Token Identifier: A.0000000000000010.YieldToken.Vault
|    New Price: 1.50000000 MOET
|    Previous Price: (not tracked - consider adding if needed)
|    Price update successful
======================================================================


======================================================================
| AUTO-BALANCER STATE: Before Rebalance
======================================================================
| Tide ID: 0
| AutoBalancer ID: 0
======================================================================
| PRICES:
|   FLOW: 1.00000000 MOET
|   YieldToken: 1.50000000 MOET
|   MOET: 1.00000000 (pegged)
======================================================================
| HOLDINGS:
|   YieldToken Balance: 615.38461538
|   -> Value in MOET: 923.07692307
|   -> Value in USD: 923.07692307
======================================================================
| POSITION METRICS:
|   Initial FLOW Deposit: 1000.00000000
|   Initial Value: 1000.00000000 MOET
|   Expected MOET Borrowed: ~615.38461538
|   Expected YieldTokens: ~410.25641025
======================================================================
| PERFORMANCE:
|   Current/Expected Value: 150.00000000%
|   Status: ABOVE threshold (>105%) - should rebalance DOWN
======================================================================

Triggering rebalance...

======================================================================
| AUTO-BALANCER STATE: After Rebalance
======================================================================
| Tide ID: 0
| AutoBalancer ID: 0
======================================================================
| PRICES:
|   FLOW: 1.00000000 MOET
|   YieldToken: 1.50000000 MOET
|   MOET: 1.00000000 (pegged)
======================================================================
| HOLDINGS:
|   YieldToken Balance: 615.38461538
|   -> Value in MOET: 923.07692307
|   -> Value in USD: 923.07692307
======================================================================
| POSITION METRICS:
|   Initial FLOW Deposit: 1000.00000000
|   Initial Value: 1000.00000000 MOET
|   Expected MOET Borrowed: ~615.38461538
|   Expected YieldTokens: ~410.25641025
======================================================================
| PERFORMANCE:
|   Current/Expected Value: 150.00000000%
|   Status: ABOVE threshold (>105%) - should rebalance DOWN
======================================================================

Balance UNCHANGED

======================================================================
|== Stage 5: YieldToken drops to 1.3
======================================================================


======================================================================
| [PRICE UPDATE] Setting YieldToken price
|    Token Identifier: A.0000000000000010.YieldToken.Vault
|    New Price: 1.30000000 MOET
|    Previous Price: (not tracked - consider adding if needed)
|    Price update successful
======================================================================


======================================================================
| AUTO-BALANCER STATE: Before Rebalance
======================================================================
| Tide ID: 0
| AutoBalancer ID: 0
======================================================================
| PRICES:
|   FLOW: 1.00000000 MOET
|   YieldToken: 1.30000000 MOET
|   MOET: 1.00000000 (pegged)
======================================================================
| HOLDINGS:
|   YieldToken Balance: 615.38461538
|   -> Value in MOET: 799.99999999
|   -> Value in USD: 799.99999999
======================================================================
| POSITION METRICS:
|   Initial FLOW Deposit: 1000.00000000
|   Initial Value: 1000.00000000 MOET
|   Expected MOET Borrowed: ~615.38461538
|   Expected YieldTokens: ~473.37278106
======================================================================
| PERFORMANCE:
|   Current/Expected Value: 129.99999900%
|   Status: ABOVE threshold (>105%) - should rebalance DOWN
======================================================================

Triggering rebalance...

======================================================================
| AUTO-BALANCER STATE: After Rebalance
======================================================================
| Tide ID: 0
| AutoBalancer ID: 0
======================================================================
| PRICES:
|   FLOW: 1.00000000 MOET
|   YieldToken: 1.30000000 MOET
|   MOET: 1.00000000 (pegged)
======================================================================
| HOLDINGS:
|   YieldToken Balance: 615.38461538
|   -> Value in MOET: 799.99999999
|   -> Value in USD: 799.99999999
======================================================================
| POSITION METRICS:
|   Initial FLOW Deposit: 1000.00000000
|   Initial Value: 1000.00000000 MOET
|   Expected MOET Borrowed: ~615.38461538
|   Expected YieldTokens: ~473.37278106
======================================================================
| PERFORMANCE:
|   Current/Expected Value: 129.99999900%
|   Status: ABOVE threshold (>105%) - should rebalance DOWN
======================================================================

Balance UNCHANGED

======================================================================
|== Stage 6: YieldToken drops to 1.1
======================================================================


======================================================================
| [PRICE UPDATE] Setting YieldToken price
|    Token Identifier: A.0000000000000010.YieldToken.Vault
|    New Price: 1.10000000 MOET
|    Previous Price: (not tracked - consider adding if needed)
|    Price update successful
======================================================================


======================================================================
| AUTO-BALANCER STATE: Before Rebalance
======================================================================
| Tide ID: 0
| AutoBalancer ID: 0
======================================================================
| PRICES:
|   FLOW: 1.00000000 MOET
|   YieldToken: 1.10000000 MOET
|   MOET: 1.00000000 (pegged)
======================================================================
| HOLDINGS:
|   YieldToken Balance: 615.38461538
|   -> Value in MOET: 676.92307691
|   -> Value in USD: 676.92307691
======================================================================
| POSITION METRICS:
|   Initial FLOW Deposit: 1000.00000000
|   Initial Value: 1000.00000000 MOET
|   Expected MOET Borrowed: ~615.38461538
|   Expected YieldTokens: ~559.44055943
======================================================================
| PERFORMANCE:
|   Current/Expected Value: 109.99999900%
|   Status: ABOVE threshold (>105%) - should rebalance DOWN
======================================================================

Triggering rebalance...

======================================================================
| AUTO-BALANCER STATE: After Rebalance
======================================================================
| Tide ID: 0
| AutoBalancer ID: 0
======================================================================
| PRICES:
|   FLOW: 1.00000000 MOET
|   YieldToken: 1.10000000 MOET
|   MOET: 1.00000000 (pegged)
======================================================================
| HOLDINGS:
|   YieldToken Balance: 615.38461538
|   -> Value in MOET: 676.92307691
|   -> Value in USD: 676.92307691
======================================================================
| POSITION METRICS:
|   Initial FLOW Deposit: 1000.00000000
|   Initial Value: 1000.00000000 MOET
|   Expected MOET Borrowed: ~615.38461538
|   Expected YieldTokens: ~559.44055943
======================================================================
| PERFORMANCE:
|   Current/Expected Value: 109.99999900%
|   Status: ABOVE threshold (>105%) - should rebalance DOWN
======================================================================

Balance UNCHANGED

======================================================================
|== Stage 7: YieldToken drops to 0.9
======================================================================


======================================================================
| [PRICE UPDATE] Setting YieldToken price
|    Token Identifier: A.0000000000000010.YieldToken.Vault
|    New Price: 0.90000000 MOET
|    Previous Price: (not tracked - consider adding if needed)
|    Price update successful
======================================================================


======================================================================
| AUTO-BALANCER STATE: Before Rebalance
======================================================================
| Tide ID: 0
| AutoBalancer ID: 0
======================================================================
| PRICES:
|   FLOW: 1.00000000 MOET
|   YieldToken: 0.90000000 MOET
|   MOET: 1.00000000 (pegged)
======================================================================
| HOLDINGS:
|   YieldToken Balance: 615.38461538
|   -> Value in MOET: 553.84615384
|   -> Value in USD: 553.84615384
======================================================================
| POSITION METRICS:
|   Initial FLOW Deposit: 1000.00000000
|   Initial Value: 1000.00000000 MOET
|   Expected MOET Borrowed: ~615.38461538
|   Expected YieldTokens: ~683.76068375
======================================================================
| PERFORMANCE:
|   Current/Expected Value: 89.99999900%
|   Status: BELOW threshold (<95%) - should rebalance UP
======================================================================

Triggering rebalance...

======================================================================
| AUTO-BALANCER STATE: After Rebalance
======================================================================
| Tide ID: 0
| AutoBalancer ID: 0
======================================================================
| PRICES:
|   FLOW: 1.00000000 MOET
|   YieldToken: 0.90000000 MOET
|   MOET: 1.00000000 (pegged)
======================================================================
| HOLDINGS:
|   YieldToken Balance: 589.08612750
|   -> Value in MOET: 530.17751475
|   -> Value in USD: 530.17751475
======================================================================
| POSITION METRICS:
|   Initial FLOW Deposit: 1000.00000000
|   Initial Value: 1000.00000000 MOET
|   Expected MOET Borrowed: ~615.38461538
|   Expected YieldTokens: ~683.76068375
======================================================================
| PERFORMANCE:
|   Current/Expected Value: 86.15384600%
|   Status: BELOW threshold (<95%) - should rebalance UP
======================================================================

[WARNING] Potential underflow in balance change
|    Attempting: 589.08612750 - 615.38461538
|    Result would be negative, returning absolute difference
Balance DECREASED by: 26.29848788

======================================================================
|== Stage 8: YieldToken drops to 0.7
======================================================================


======================================================================
| [PRICE UPDATE] Setting YieldToken price
|    Token Identifier: A.0000000000000010.YieldToken.Vault
|    New Price: 0.70000000 MOET
|    Previous Price: (not tracked - consider adding if needed)
|    Price update successful
======================================================================


======================================================================
| AUTO-BALANCER STATE: Before Rebalance
======================================================================
| Tide ID: 0
| AutoBalancer ID: 0
======================================================================
| PRICES:
|   FLOW: 1.00000000 MOET
|   YieldToken: 0.70000000 MOET
|   MOET: 1.00000000 (pegged)
======================================================================
| HOLDINGS:
|   YieldToken Balance: 589.08612750
|   -> Value in MOET: 412.36028925
|   -> Value in USD: 412.36028925
======================================================================
| POSITION METRICS:
|   Initial FLOW Deposit: 1000.00000000
|   Initial Value: 1000.00000000 MOET
|   Expected MOET Borrowed: ~615.38461538
|   Expected YieldTokens: ~879.12087911
======================================================================
| PERFORMANCE:
|   Current/Expected Value: 67.00854700%
|   Status: BELOW threshold (<95%) - should rebalance UP
======================================================================

Triggering rebalance...

======================================================================
| AUTO-BALANCER STATE: After Rebalance
======================================================================
| Tide ID: 0
| AutoBalancer ID: 0
======================================================================
| PRICES:
|   FLOW: 1.00000000 MOET
|   YieldToken: 0.70000000 MOET
|   MOET: 1.00000000 (pegged)
======================================================================
| HOLDINGS:
|   YieldToken Balance: 456.72670393
|   -> Value in MOET: 319.70869275
|   -> Value in USD: 319.70869275
======================================================================
| POSITION METRICS:
|   Initial FLOW Deposit: 1000.00000000
|   Initial Value: 1000.00000000 MOET
|   Expected MOET Borrowed: ~615.38461538
|   Expected YieldTokens: ~879.12087911
======================================================================
| PERFORMANCE:
|   Current/Expected Value: 51.95266200%
|   Status: BELOW threshold (<95%) - should rebalance UP
======================================================================

[WARNING] Potential underflow in balance change
|    Attempting: 456.72670393 - 615.38461538
|    Result would be negative, returning absolute difference
Balance DECREASED by: 158.65791145

======================================================================
|== Stage 9: YieldToken drops to 0.5
======================================================================


======================================================================
| [PRICE UPDATE] Setting YieldToken price
|    Token Identifier: A.0000000000000010.YieldToken.Vault
|    New Price: 0.50000000 MOET
|    Previous Price: (not tracked - consider adding if needed)
|    Price update successful
======================================================================


======================================================================
| AUTO-BALANCER STATE: Before Rebalance
======================================================================
| Tide ID: 0
| AutoBalancer ID: 0
======================================================================
| PRICES:
|   FLOW: 1.00000000 MOET
|   YieldToken: 0.50000000 MOET
|   MOET: 1.00000000 (pegged)
======================================================================
| HOLDINGS:
|   YieldToken Balance: 456.72670393
|   -> Value in MOET: 228.36335196
|   -> Value in USD: 228.36335196
======================================================================
| POSITION METRICS:
|   Initial FLOW Deposit: 1000.00000000
|   Initial Value: 1000.00000000 MOET
|   Expected MOET Borrowed: ~615.38461538
|   Expected YieldTokens: ~1230.76923076
======================================================================
| PERFORMANCE:
|   Current/Expected Value: 37.10904400%
|   Status: BELOW threshold (<95%) - should rebalance UP
======================================================================

Triggering rebalance...

======================================================================
| AUTO-BALANCER STATE: After Rebalance
======================================================================
| Tide ID: 0
| AutoBalancer ID: 0
======================================================================
| PRICES:
|   FLOW: 1.00000000 MOET
|   YieldToken: 0.50000000 MOET
|   MOET: 1.00000000 (pegged)
======================================================================
| HOLDINGS:
|   YieldToken Balance: 281.06258702
|   -> Value in MOET: 140.53129351
|   -> Value in USD: 140.53129351
======================================================================
| POSITION METRICS:
|   Initial FLOW Deposit: 1000.00000000
|   Initial Value: 1000.00000000 MOET
|   Expected MOET Borrowed: ~615.38461538
|   Expected YieldTokens: ~1230.76923076
======================================================================
| PERFORMANCE:
|   Current/Expected Value: 22.83633500%
|   Status: BELOW threshold (<95%) - should rebalance UP
======================================================================

[WARNING] Potential underflow in balance change
|    Attempting: 281.06258702 - 615.38461538
|    Result would be negative, returning absolute difference
Balance DECREASED by: 334.32202836

======================================================================
|== AUTO-BORROW SCENARIO: Volatile Price Swings
======================================================================


======================================================================
| [PRICE UPDATE] Setting FLOW price
|    Token Identifier: A.0000000000000003.FlowToken.Vault
|    New Price: 1.00000000 MOET
|    Previous Price: (not tracked - consider adding if needed)
|    Price update successful
======================================================================


======================================================================
| [PRICE UPDATE] Setting MOET price
|    Token Identifier: A.0000000000000008.MOET.Vault
|    New Price: 1.00000000 MOET
|    Previous Price: (not tracked - consider adding if needed)
|    Price update successful
======================================================================

Creating position with 1000 FLOW...
Initial position health: 0.32725200

======================================================================
|== Stage 0: FLOW pumps to 1.5
======================================================================


======================================================================
| [PRICE UPDATE] Setting FLOW price
|    Token Identifier: A.0000000000000003.FlowToken.Vault
|    New Price: 1.50000000 MOET
|    Previous Price: (not tracked - consider adding if needed)
|    Price update successful
======================================================================

Health before rebalance: 0.49087800
Triggering rebalance...
Health after rebalance: 0.64168558

======================================================================
| POSITION STATE: After price = 1.50000000
======================================================================
| Position ID: 0
| Health Ratio: 0.64168558
======================================================================
| PRICES:
|   FLOW: 1.50000000 MOET
|   MOET: 1.00000000 (pegged)
======================================================================
| BALANCES:
|   MOET Debt: 93503.73656805 (BORROWED)
|   -> Value: 93503.73656805 MOET
|   FLOW Collateral: 50000.00000000
|   -> Value: 75000.00000000 MOET
======================================================================
| METRICS:
|   Effective Collateral: 60000.00000000 MOET
|   Utilization Rate: 155.83956000%
======================================================================


======================================================================
|== Stage 1: FLOW dumps to 0.7
======================================================================


======================================================================
| [PRICE UPDATE] Setting FLOW price
|    Token Identifier: A.0000000000000003.FlowToken.Vault
|    New Price: 0.70000000 MOET
|    Previous Price: (not tracked - consider adding if needed)
|    Price update successful
======================================================================

Health before rebalance: 0.29945327
Triggering rebalance...
Health after rebalance: 0.36398318

======================================================================
| POSITION STATE: After price = 0.70000000
======================================================================
| Position ID: 0
| Health Ratio: 0.36398318
======================================================================
| PRICES:
|   FLOW: 0.70000000 MOET
|   MOET: 1.00000000 (pegged)
======================================================================
| BALANCES:
|   MOET Debt: 76926.63098226 (BORROWED)
|   -> Value: 76926.63098226 MOET
|   FLOW Collateral: 50000.00000000
|   -> Value: 35000.00000000 MOET
======================================================================
| METRICS:
|   Effective Collateral: 28000.00000000 MOET
|   Utilization Rate: 274.73796700%
======================================================================


======================================================================
|== Stage 2: FLOW pumps to 1.8
======================================================================


======================================================================
| [PRICE UPDATE] Setting FLOW price
|    Token Identifier: A.0000000000000003.FlowToken.Vault
|    New Price: 1.80000000 MOET
|    Previous Price: (not tracked - consider adding if needed)
|    Price update successful
======================================================================

Health before rebalance: 0.93595675
Triggering rebalance...
Health after rebalance: 1.17231202

======================================================================
| POSITION STATE: After price = 1.80000000
======================================================================
| Position ID: 0
| Health Ratio: 1.17231202
======================================================================
| PRICES:
|   FLOW: 1.80000000 MOET
|   MOET: 1.00000000 (pegged)
======================================================================
| BALANCES:
|   MOET Debt: 61417.09607102 (BORROWED)
|   -> Value: 61417.09607102 MOET
|   FLOW Collateral: 50000.00000000
|   -> Value: 90000.00000000 MOET
======================================================================
| METRICS:
|   Effective Collateral: 72000.00000000 MOET
|   Utilization Rate: 85.30152200%
======================================================================


======================================================================
|== Stage 3: FLOW crashes to 0.4
======================================================================


======================================================================
| [PRICE UPDATE] Setting FLOW price
|    Token Identifier: A.0000000000000003.FlowToken.Vault
|    New Price: 0.40000000 MOET
|    Previous Price: (not tracked - consider adding if needed)
|    Price update successful
======================================================================

Health before rebalance: 0.26051378
Triggering rebalance...
Health after rebalance: 0.31022297

======================================================================
| POSITION STATE: After price = 0.40000000
======================================================================
| Position ID: 0
| Health Ratio: 0.31022297
======================================================================
| PRICES:
|   FLOW: 0.40000000 MOET
|   MOET: 1.00000000 (pegged)
======================================================================
| BALANCES:
|   MOET Debt: 51575.80641422 (BORROWED)
|   -> Value: 51575.80641422 MOET
|   FLOW Collateral: 50000.00000000
|   -> Value: 20000.00000000 MOET
======================================================================
| METRICS:
|   Effective Collateral: 16000.00000000 MOET
|   Utilization Rate: 322.34879000%
======================================================================


======================================================================
|== Stage 4: FLOW recovers to 1.2
======================================================================


======================================================================
| [PRICE UPDATE] Setting FLOW price
|    Token Identifier: A.0000000000000003.FlowToken.Vault
|    New Price: 1.20000000 MOET
|    Previous Price: (not tracked - consider adding if needed)
|    Price update successful
======================================================================

Health before rebalance: 0.93066891
Triggering rebalance...
Health after rebalance: 1.16828317

======================================================================
| POSITION STATE: After price = 1.20000000
======================================================================
| Position ID: 0
| Health Ratio: 1.16828317
======================================================================
| PRICES:
|   FLOW: 1.20000000 MOET
|   MOET: 1.00000000 (pegged)
======================================================================
| BALANCES:
|   MOET Debt: 41085.92930180 (BORROWED)
|   -> Value: 41085.92930180 MOET
|   FLOW Collateral: 50000.00000000
|   -> Value: 60000.00000000 MOET
======================================================================
| METRICS:
|   Effective Collateral: 48000.00000000 MOET
|   Utilization Rate: 85.59568600%
======================================================================


======================================================================
|== Stage 5: FLOW drops to 0.9
======================================================================


======================================================================
| [PRICE UPDATE] Setting FLOW price
|    Token Identifier: A.0000000000000003.FlowToken.Vault
|    New Price: 0.90000000 MOET
|    Previous Price: (not tracked - consider adding if needed)
|    Price update successful
======================================================================

Health before rebalance: 0.87621238
Triggering rebalance...
Health after rebalance: 1.12294708

======================================================================
| POSITION STATE: After price = 0.90000000
======================================================================
| Position ID: 0
| Health Ratio: 1.12294708
======================================================================
| PRICES:
|   FLOW: 0.90000000 MOET
|   MOET: 1.00000000 (pegged)
======================================================================
| BALANCES:
|   MOET Debt: 32058.50071009 (BORROWED)
|   -> Value: 32058.50071009 MOET
|   FLOW Collateral: 50000.00000000
|   -> Value: 45000.00000000 MOET
======================================================================
| METRICS:
|   Effective Collateral: 36000.00000000 MOET
|   Utilization Rate: 89.05139000%
======================================================================


======================================================================
|== Stage 6: FLOW moons to 2.5
======================================================================


======================================================================
| [PRICE UPDATE] Setting FLOW price
|    Token Identifier: A.0000000000000003.FlowToken.Vault
|    New Price: 2.50000000 MOET
|    Previous Price: (not tracked - consider adding if needed)
|    Price update successful
======================================================================

Health before rebalance: 3.11929746
Triggering rebalance...
Health after rebalance: 1.30000000

======================================================================
| POSITION STATE: After price = 2.50000000
======================================================================
| Position ID: 0
| Health Ratio: 1.30000000
======================================================================
| PRICES:
|   FLOW: 2.50000000 MOET
|   MOET: 1.00000000 (pegged)
======================================================================
| BALANCES:
|   MOET Debt: 76923.07692307 (BORROWED)
|   -> Value: 76923.07692307 MOET
|   FLOW Collateral: 50000.00000000
|   -> Value: 125000.00000000 MOET
======================================================================
| METRICS:
|   Effective Collateral: 100000.00000000 MOET
|   Utilization Rate: 76.92307600%
======================================================================


======================================================================
|== Stage 7: FLOW crashes to 0.3
======================================================================


======================================================================
| [PRICE UPDATE] Setting FLOW price
|    Token Identifier: A.0000000000000003.FlowToken.Vault
|    New Price: 0.30000000 MOET
|    Previous Price: (not tracked - consider adding if needed)
|    Price update successful
======================================================================

Health before rebalance: 0.15600000
Triggering rebalance...
Health after rebalance: 0.17441860

======================================================================
| POSITION STATE: After price = 0.30000000
======================================================================
| Position ID: 0
| Health Ratio: 0.17441860
======================================================================
| PRICES:
|   FLOW: 0.30000000 MOET
|   MOET: 1.00000000 (pegged)
======================================================================
| BALANCES:
|   MOET Debt: 68800.00000000 (BORROWED)
|   -> Value: 68800.00000000 MOET
|   FLOW Collateral: 50000.00000000
|   -> Value: 15000.00000000 MOET
======================================================================
| METRICS:
|   Effective Collateral: 12000.00000000 MOET
|   Utilization Rate: 573.33333300%
======================================================================


======================================================================
|== Stage 8: FLOW stabilizes at 1.0
======================================================================


======================================================================
| [PRICE UPDATE] Setting FLOW price
|    Token Identifier: A.0000000000000003.FlowToken.Vault
|    New Price: 1.00000000 MOET
|    Previous Price: (not tracked - consider adding if needed)
|    Price update successful
======================================================================

Health before rebalance: 0.58139534
Triggering rebalance...
Health after rebalance: 0.77232592

======================================================================
| POSITION STATE: After price = 1.00000000
======================================================================
| Position ID: 0
| Health Ratio: 0.77232592
======================================================================
| PRICES:
|   FLOW: 1.00000000 MOET
|   MOET: 1.00000000 (pegged)
======================================================================
| BALANCES:
|   MOET Debt: 51791.60568048 (BORROWED)
|   -> Value: 51791.60568048 MOET
|   FLOW Collateral: 50000.00000000
|   -> Value: 50000.00000000 MOET
======================================================================
| METRICS:
|   Effective Collateral: 40000.00000000 MOET
|   Utilization Rate: 129.47901400%
======================================================================

Test results: "./cadence/tests/price_scenario_test.cdc"
- PASS: testExtremePriceMovements
- PASS: testGradualPriceChanges
- PASS: testVolatilePriceSwings
Coverage: 74.9% of statements
Running test: testGradualPriceChanges

======================================================================
|== AUTO-BORROW SCENARIO: Extreme FLOW Price Volatility
======================================================================


======================================================================
| [PRICE UPDATE] Setting FLOW price
|    Token Identifier: A.0000000000000003.FlowToken.Vault
|    New Price: 1.00000000 MOET
|    Previous Price: (not tracked - consider adding if needed)
|    Price update successful
======================================================================


======================================================================
| [PRICE UPDATE] Setting MOET price
|    Token Identifier: A.0000000000000008.MOET.Vault
|    New Price: 1.00000000 MOET
|    Previous Price: (not tracked - consider adding if needed)
|    Price update successful
======================================================================

Creating position with 1000 FLOW...
Initial position health: 1.30000000

======================================================================
|== Stage 0: FLOW drops 50% to 0.5
======================================================================


======================================================================
| [PRICE UPDATE] Setting FLOW price
|    Token Identifier: A.0000000000000003.FlowToken.Vault
|    New Price: 0.50000000 MOET
|    Previous Price: (not tracked - consider adding if needed)
|    Price update successful
======================================================================

Health before rebalance: 0.65000000
Triggering rebalance...
Health after rebalance: 0.86666666

======================================================================
| POSITION STATE: After price = 0.50000000
======================================================================
| Position ID: 0
| Health Ratio: 0.86666666
======================================================================
| PRICES:
|   FLOW: 0.50000000 MOET
|   MOET: 1.00000000 (pegged)
======================================================================
| BALANCES:
|   MOET Debt: 23076.92307693 (BORROWED)
|   -> Value: 23076.92307693 MOET
|   FLOW Collateral: 50000.00000000
|   -> Value: 25000.00000000 MOET
======================================================================
| METRICS:
|   Effective Collateral: 20000.00000000 MOET
|   Utilization Rate: 115.38461500%
======================================================================


======================================================================
|== Stage 1: FLOW crashes 90% to 0.1
======================================================================


======================================================================
| [PRICE UPDATE] Setting FLOW price
|    Token Identifier: A.0000000000000003.FlowToken.Vault
|    New Price: 0.10000000 MOET
|    Previous Price: (not tracked - consider adding if needed)
|    Price update successful
======================================================================

Health before rebalance: 0.17333333
Triggering rebalance...
Health after rebalance: 0.19597989

======================================================================
| POSITION STATE: After price = 0.10000000
======================================================================
| Position ID: 0
| Health Ratio: 0.19597989
======================================================================
| PRICES:
|   FLOW: 0.10000000 MOET
|   MOET: 1.00000000 (pegged)
======================================================================
| BALANCES:
|   MOET Debt: 20410.25640238 (BORROWED)
|   -> Value: 20410.25640238 MOET
|   FLOW Collateral: 50000.00000000
|   -> Value: 5000.00000000 MOET
======================================================================
| METRICS:
|   Effective Collateral: 4000.00000000 MOET
|   Utilization Rate: 510.25641000%
======================================================================


======================================================================
|== Stage 2: FLOW recovers to 2.0 (2x original)
======================================================================


======================================================================
| [PRICE UPDATE] Setting FLOW price
|    Token Identifier: A.0000000000000003.FlowToken.Vault
|    New Price: 2.00000000 MOET
|    Previous Price: (not tracked - consider adding if needed)
|    Price update successful
======================================================================

Health before rebalance: 3.91959799
Triggering rebalance...
Health after rebalance: 1.30000000

======================================================================
| POSITION STATE: After price = 2.00000000
======================================================================
| Position ID: 0
| Health Ratio: 1.30000000
======================================================================
| PRICES:
|   FLOW: 2.00000000 MOET
|   MOET: 1.00000000 (pegged)
======================================================================
| BALANCES:
|   MOET Debt: 61538.46153846 (BORROWED)
|   -> Value: 61538.46153846 MOET
|   FLOW Collateral: 50000.00000000
|   -> Value: 100000.00000000 MOET
======================================================================
| METRICS:
|   Effective Collateral: 80000.00000000 MOET
|   Utilization Rate: 76.92307600%
======================================================================


======================================================================
|== Stage 3: FLOW moons to 5.0 (5x original)
======================================================================


======================================================================
| [PRICE UPDATE] Setting FLOW price
|    Token Identifier: A.0000000000000003.FlowToken.Vault
|    New Price: 5.00000000 MOET
|    Previous Price: (not tracked - consider adding if needed)
|    Price update successful
======================================================================

Health before rebalance: 3.25000000
Triggering rebalance...
Health after rebalance: 1.30000000

======================================================================
| POSITION STATE: After price = 5.00000000
======================================================================
| Position ID: 0
| Health Ratio: 1.30000000
======================================================================
| PRICES:
|   FLOW: 5.00000000 MOET
|   MOET: 1.00000000 (pegged)
======================================================================
| BALANCES:
|   MOET Debt: 153846.15384615 (BORROWED)
|   -> Value: 153846.15384615 MOET
|   FLOW Collateral: 50000.00000000
|   -> Value: 250000.00000000 MOET
======================================================================
| METRICS:
|   Effective Collateral: 200000.00000000 MOET
|   Utilization Rate: 76.92307600%
======================================================================


======================================================================
|== Stage 4: FLOW crashes back to 0.25
======================================================================


======================================================================
| [PRICE UPDATE] Setting FLOW price
|    Token Identifier: A.0000000000000003.FlowToken.Vault
|    New Price: 0.25000000 MOET
|    Previous Price: (not tracked - consider adding if needed)
|    Price update successful
======================================================================

Health before rebalance: 0.06500000
Triggering rebalance...
Health after rebalance: 0.06824146

======================================================================
| POSITION STATE: After price = 0.25000000
======================================================================
| Position ID: 0
| Health Ratio: 0.06824146
======================================================================
| PRICES:
|   FLOW: 0.25000000 MOET
|   MOET: 1.00000000 (pegged)
======================================================================
| BALANCES:
|   MOET Debt: 146538.46153846 (BORROWED)
|   -> Value: 146538.46153846 MOET
|   FLOW Collateral: 50000.00000000
|   -> Value: 12500.00000000 MOET
======================================================================
| METRICS:
|   Effective Collateral: 10000.00000000 MOET
|   Utilization Rate: 1465.38461500%
======================================================================


======================================================================
|== Stage 5: FLOW stabilizes at 1.0
======================================================================


======================================================================
| [PRICE UPDATE] Setting FLOW price
|    Token Identifier: A.0000000000000003.FlowToken.Vault
|    New Price: 1.00000000 MOET
|    Previous Price: (not tracked - consider adding if needed)
|    Price update successful
======================================================================

Health before rebalance: 0.27296587
Triggering rebalance...
Health after rebalance: 0.32725200

======================================================================
| POSITION STATE: After price = 1.00000000
======================================================================
| Position ID: 0
| Health Ratio: 0.32725200
======================================================================
| PRICES:
|   FLOW: 1.00000000 MOET
|   MOET: 1.00000000 (pegged)
======================================================================
| BALANCES:
|   MOET Debt: 122229.96142012 (BORROWED)
|   -> Value: 122229.96142012 MOET
|   FLOW Collateral: 50000.00000000
|   -> Value: 50000.00000000 MOET
======================================================================
| METRICS:
|   Effective Collateral: 40000.00000000 MOET
|   Utilization Rate: 305.57490300%
======================================================================


======================================================================
|== AUTO-BALANCER SCENARIO: Gradual YieldToken Price Changes
======================================================================

Creating Tide with TracerStrategy...
Initial AutoBalancer balance: 615.38461538 YieldToken

======================================================================
|== Stage 0: YieldToken +10% to 1.1
======================================================================


======================================================================
| [PRICE UPDATE] Setting YieldToken price
|    Token Identifier: A.0000000000000010.YieldToken.Vault
|    New Price: 1.10000000 MOET
|    Previous Price: (not tracked - consider adding if needed)
|    Price update successful
======================================================================


======================================================================
| AUTO-BALANCER STATE: Before Rebalance
======================================================================
| Tide ID: 0
| AutoBalancer ID: 0
======================================================================
| PRICES:
|   FLOW: 1.00000000 MOET
|   YieldToken: 1.10000000 MOET
|   MOET: 1.00000000 (pegged)
======================================================================
| HOLDINGS:
|   YieldToken Balance: 615.38461538
|   -> Value in MOET: 676.92307691
|   -> Value in USD: 676.92307691
======================================================================
| POSITION METRICS:
|   Initial FLOW Deposit: 1000.00000000
|   Initial Value: 1000.00000000 MOET
|   Expected MOET Borrowed: ~615.38461538
|   Expected YieldTokens: ~559.44055943
======================================================================
| PERFORMANCE:
|   Current/Expected Value: 109.99999900%
|   Status: ABOVE threshold (>105%) - should rebalance DOWN
======================================================================

Triggering rebalance...

======================================================================
| AUTO-BALANCER STATE: After Rebalance
======================================================================
| Tide ID: 0
| AutoBalancer ID: 0
======================================================================
| PRICES:
|   FLOW: 1.00000000 MOET
|   YieldToken: 1.10000000 MOET
|   MOET: 1.00000000 (pegged)
======================================================================
| HOLDINGS:
|   YieldToken Balance: 615.38461538
|   -> Value in MOET: 676.92307691
|   -> Value in USD: 676.92307691
======================================================================
| POSITION METRICS:
|   Initial FLOW Deposit: 1000.00000000
|   Initial Value: 1000.00000000 MOET
|   Expected MOET Borrowed: ~615.38461538
|   Expected YieldTokens: ~559.44055943
======================================================================
| PERFORMANCE:
|   Current/Expected Value: 109.99999900%
|   Status: ABOVE threshold (>105%) - should rebalance DOWN
======================================================================

Balance UNCHANGED

======================================================================
|== Stage 1: YieldToken +20% to 1.2
======================================================================


======================================================================
| [PRICE UPDATE] Setting YieldToken price
|    Token Identifier: A.0000000000000010.YieldToken.Vault
|    New Price: 1.20000000 MOET
|    Previous Price: (not tracked - consider adding if needed)
|    Price update successful
======================================================================


======================================================================
| AUTO-BALANCER STATE: Before Rebalance
======================================================================
| Tide ID: 0
| AutoBalancer ID: 0
======================================================================
| PRICES:
|   FLOW: 1.00000000 MOET
|   YieldToken: 1.20000000 MOET
|   MOET: 1.00000000 (pegged)
======================================================================
| HOLDINGS:
|   YieldToken Balance: 615.38461538
|   -> Value in MOET: 738.46153845
|   -> Value in USD: 738.46153845
======================================================================
| POSITION METRICS:
|   Initial FLOW Deposit: 1000.00000000
|   Initial Value: 1000.00000000 MOET
|   Expected MOET Borrowed: ~615.38461538
|   Expected YieldTokens: ~512.82051281
======================================================================
| PERFORMANCE:
|   Current/Expected Value: 119.99999900%
|   Status: ABOVE threshold (>105%) - should rebalance DOWN
======================================================================

Triggering rebalance...

======================================================================
| AUTO-BALANCER STATE: After Rebalance
======================================================================
| Tide ID: 0
| AutoBalancer ID: 0
======================================================================
| PRICES:
|   FLOW: 1.00000000 MOET
|   YieldToken: 1.20000000 MOET
|   MOET: 1.00000000 (pegged)
======================================================================
| HOLDINGS:
|   YieldToken Balance: 615.38461538
|   -> Value in MOET: 738.46153845
|   -> Value in USD: 738.46153845
======================================================================
| POSITION METRICS:
|   Initial FLOW Deposit: 1000.00000000
|   Initial Value: 1000.00000000 MOET
|   Expected MOET Borrowed: ~615.38461538
|   Expected YieldTokens: ~512.82051281
======================================================================
| PERFORMANCE:
|   Current/Expected Value: 119.99999900%
|   Status: ABOVE threshold (>105%) - should rebalance DOWN
======================================================================

Balance UNCHANGED

======================================================================
|== Stage 2: YieldToken +30% to 1.3
======================================================================


======================================================================
| [PRICE UPDATE] Setting YieldToken price
|    Token Identifier: A.0000000000000010.YieldToken.Vault
|    New Price: 1.30000000 MOET
|    Previous Price: (not tracked - consider adding if needed)
|    Price update successful
======================================================================


======================================================================
| AUTO-BALANCER STATE: Before Rebalance
======================================================================
| Tide ID: 0
| AutoBalancer ID: 0
======================================================================
| PRICES:
|   FLOW: 1.00000000 MOET
|   YieldToken: 1.30000000 MOET
|   MOET: 1.00000000 (pegged)
======================================================================
| HOLDINGS:
|   YieldToken Balance: 615.38461538
|   -> Value in MOET: 799.99999999
|   -> Value in USD: 799.99999999
======================================================================
| POSITION METRICS:
|   Initial FLOW Deposit: 1000.00000000
|   Initial Value: 1000.00000000 MOET
|   Expected MOET Borrowed: ~615.38461538
|   Expected YieldTokens: ~473.37278106
======================================================================
| PERFORMANCE:
|   Current/Expected Value: 129.99999900%
|   Status: ABOVE threshold (>105%) - should rebalance DOWN
======================================================================

Triggering rebalance...

======================================================================
| AUTO-BALANCER STATE: After Rebalance
======================================================================
| Tide ID: 0
| AutoBalancer ID: 0
======================================================================
| PRICES:
|   FLOW: 1.00000000 MOET
|   YieldToken: 1.30000000 MOET
|   MOET: 1.00000000 (pegged)
======================================================================
| HOLDINGS:
|   YieldToken Balance: 615.38461538
|   -> Value in MOET: 799.99999999
|   -> Value in USD: 799.99999999
======================================================================
| POSITION METRICS:
|   Initial FLOW Deposit: 1000.00000000
|   Initial Value: 1000.00000000 MOET
|   Expected MOET Borrowed: ~615.38461538
|   Expected YieldTokens: ~473.37278106
======================================================================
| PERFORMANCE:
|   Current/Expected Value: 129.99999900%
|   Status: ABOVE threshold (>105%) - should rebalance DOWN
======================================================================

Balance UNCHANGED

======================================================================
|== Stage 3: YieldToken +40% to 1.4
======================================================================


======================================================================
| [PRICE UPDATE] Setting YieldToken price
|    Token Identifier: A.0000000000000010.YieldToken.Vault
|    New Price: 1.40000000 MOET
|    Previous Price: (not tracked - consider adding if needed)
|    Price update successful
======================================================================


======================================================================
| AUTO-BALANCER STATE: Before Rebalance
======================================================================
| Tide ID: 0
| AutoBalancer ID: 0
======================================================================
| PRICES:
|   FLOW: 1.00000000 MOET
|   YieldToken: 1.40000000 MOET
|   MOET: 1.00000000 (pegged)
======================================================================
| HOLDINGS:
|   YieldToken Balance: 615.38461538
|   -> Value in MOET: 861.53846153
|   -> Value in USD: 861.53846153
======================================================================
| POSITION METRICS:
|   Initial FLOW Deposit: 1000.00000000
|   Initial Value: 1000.00000000 MOET
|   Expected MOET Borrowed: ~615.38461538
|   Expected YieldTokens: ~439.56043955
======================================================================
| PERFORMANCE:
|   Current/Expected Value: 139.99999900%
|   Status: ABOVE threshold (>105%) - should rebalance DOWN
======================================================================

Triggering rebalance...

======================================================================
| AUTO-BALANCER STATE: After Rebalance
======================================================================
| Tide ID: 0
| AutoBalancer ID: 0
======================================================================
| PRICES:
|   FLOW: 1.00000000 MOET
|   YieldToken: 1.40000000 MOET
|   MOET: 1.00000000 (pegged)
======================================================================
| HOLDINGS:
|   YieldToken Balance: 615.38461538
|   -> Value in MOET: 861.53846153
|   -> Value in USD: 861.53846153
======================================================================
| POSITION METRICS:
|   Initial FLOW Deposit: 1000.00000000
|   Initial Value: 1000.00000000 MOET
|   Expected MOET Borrowed: ~615.38461538
|   Expected YieldTokens: ~439.56043955
======================================================================
| PERFORMANCE:
|   Current/Expected Value: 139.99999900%
|   Status: ABOVE threshold (>105%) - should rebalance DOWN
======================================================================

Balance UNCHANGED

======================================================================
|== Stage 4: YieldToken +50% to 1.5
======================================================================


======================================================================
| [PRICE UPDATE] Setting YieldToken price
|    Token Identifier: A.0000000000000010.YieldToken.Vault
|    New Price: 1.50000000 MOET
|    Previous Price: (not tracked - consider adding if needed)
|    Price update successful
======================================================================


======================================================================
| AUTO-BALANCER STATE: Before Rebalance
======================================================================
| Tide ID: 0
| AutoBalancer ID: 0
======================================================================
| PRICES:
|   FLOW: 1.00000000 MOET
|   YieldToken: 1.50000000 MOET
|   MOET: 1.00000000 (pegged)
======================================================================
| HOLDINGS:
|   YieldToken Balance: 615.38461538
|   -> Value in MOET: 923.07692307
|   -> Value in USD: 923.07692307
======================================================================
| POSITION METRICS:
|   Initial FLOW Deposit: 1000.00000000
|   Initial Value: 1000.00000000 MOET
|   Expected MOET Borrowed: ~615.38461538
|   Expected YieldTokens: ~410.25641025
======================================================================
| PERFORMANCE:
|   Current/Expected Value: 150.00000000%
|   Status: ABOVE threshold (>105%) - should rebalance DOWN
======================================================================

Triggering rebalance...

======================================================================
| AUTO-BALANCER STATE: After Rebalance
======================================================================
| Tide ID: 0
| AutoBalancer ID: 0
======================================================================
| PRICES:
|   FLOW: 1.00000000 MOET
|   YieldToken: 1.50000000 MOET
|   MOET: 1.00000000 (pegged)
======================================================================
| HOLDINGS:
|   YieldToken Balance: 615.38461538
|   -> Value in MOET: 923.07692307
|   -> Value in USD: 923.07692307
======================================================================
| POSITION METRICS:
|   Initial FLOW Deposit: 1000.00000000
|   Initial Value: 1000.00000000 MOET
|   Expected MOET Borrowed: ~615.38461538
|   Expected YieldTokens: ~410.25641025
======================================================================
| PERFORMANCE:
|   Current/Expected Value: 150.00000000%
|   Status: ABOVE threshold (>105%) - should rebalance DOWN
======================================================================

Balance UNCHANGED

======================================================================
|== Stage 5: YieldToken drops to 1.3
======================================================================


======================================================================
| [PRICE UPDATE] Setting YieldToken price
|    Token Identifier: A.0000000000000010.YieldToken.Vault
|    New Price: 1.30000000 MOET
|    Previous Price: (not tracked - consider adding if needed)
|    Price update successful
======================================================================


======================================================================
| AUTO-BALANCER STATE: Before Rebalance
======================================================================
| Tide ID: 0
| AutoBalancer ID: 0
======================================================================
| PRICES:
|   FLOW: 1.00000000 MOET
|   YieldToken: 1.30000000 MOET
|   MOET: 1.00000000 (pegged)
======================================================================
| HOLDINGS:
|   YieldToken Balance: 615.38461538
|   -> Value in MOET: 799.99999999
|   -> Value in USD: 799.99999999
======================================================================
| POSITION METRICS:
|   Initial FLOW Deposit: 1000.00000000
|   Initial Value: 1000.00000000 MOET
|   Expected MOET Borrowed: ~615.38461538
|   Expected YieldTokens: ~473.37278106
======================================================================
| PERFORMANCE:
|   Current/Expected Value: 129.99999900%
|   Status: ABOVE threshold (>105%) - should rebalance DOWN
======================================================================

Triggering rebalance...

======================================================================
| AUTO-BALANCER STATE: After Rebalance
======================================================================
| Tide ID: 0
| AutoBalancer ID: 0
======================================================================
| PRICES:
|   FLOW: 1.00000000 MOET
|   YieldToken: 1.30000000 MOET
|   MOET: 1.00000000 (pegged)
======================================================================
| HOLDINGS:
|   YieldToken Balance: 615.38461538
|   -> Value in MOET: 799.99999999
|   -> Value in USD: 799.99999999
======================================================================
| POSITION METRICS:
|   Initial FLOW Deposit: 1000.00000000
|   Initial Value: 1000.00000000 MOET
|   Expected MOET Borrowed: ~615.38461538
|   Expected YieldTokens: ~473.37278106
======================================================================
| PERFORMANCE:
|   Current/Expected Value: 129.99999900%
|   Status: ABOVE threshold (>105%) - should rebalance DOWN
======================================================================

Balance UNCHANGED

======================================================================
|== Stage 6: YieldToken drops to 1.1
======================================================================


======================================================================
| [PRICE UPDATE] Setting YieldToken price
|    Token Identifier: A.0000000000000010.YieldToken.Vault
|    New Price: 1.10000000 MOET
|    Previous Price: (not tracked - consider adding if needed)
|    Price update successful
======================================================================


======================================================================
| AUTO-BALANCER STATE: Before Rebalance
======================================================================
| Tide ID: 0
| AutoBalancer ID: 0
======================================================================
| PRICES:
|   FLOW: 1.00000000 MOET
|   YieldToken: 1.10000000 MOET
|   MOET: 1.00000000 (pegged)
======================================================================
| HOLDINGS:
|   YieldToken Balance: 615.38461538
|   -> Value in MOET: 676.92307691
|   -> Value in USD: 676.92307691
======================================================================
| POSITION METRICS:
|   Initial FLOW Deposit: 1000.00000000
|   Initial Value: 1000.00000000 MOET
|   Expected MOET Borrowed: ~615.38461538
|   Expected YieldTokens: ~559.44055943
======================================================================
| PERFORMANCE:
|   Current/Expected Value: 109.99999900%
|   Status: ABOVE threshold (>105%) - should rebalance DOWN
======================================================================

Triggering rebalance...

======================================================================
| AUTO-BALANCER STATE: After Rebalance
======================================================================
| Tide ID: 0
| AutoBalancer ID: 0
======================================================================
| PRICES:
|   FLOW: 1.00000000 MOET
|   YieldToken: 1.10000000 MOET
|   MOET: 1.00000000 (pegged)
======================================================================
| HOLDINGS:
|   YieldToken Balance: 615.38461538
|   -> Value in MOET: 676.92307691
|   -> Value in USD: 676.92307691
======================================================================
| POSITION METRICS:
|   Initial FLOW Deposit: 1000.00000000
|   Initial Value: 1000.00000000 MOET
|   Expected MOET Borrowed: ~615.38461538
|   Expected YieldTokens: ~559.44055943
======================================================================
| PERFORMANCE:
|   Current/Expected Value: 109.99999900%
|   Status: ABOVE threshold (>105%) - should rebalance DOWN
======================================================================

Balance UNCHANGED

======================================================================
|== Stage 7: YieldToken drops to 0.9
======================================================================


======================================================================
| [PRICE UPDATE] Setting YieldToken price
|    Token Identifier: A.0000000000000010.YieldToken.Vault
|    New Price: 0.90000000 MOET
|    Previous Price: (not tracked - consider adding if needed)
|    Price update successful
======================================================================


======================================================================
| AUTO-BALANCER STATE: Before Rebalance
======================================================================
| Tide ID: 0
| AutoBalancer ID: 0
======================================================================
| PRICES:
|   FLOW: 1.00000000 MOET
|   YieldToken: 0.90000000 MOET
|   MOET: 1.00000000 (pegged)
======================================================================
| HOLDINGS:
|   YieldToken Balance: 615.38461538
|   -> Value in MOET: 553.84615384
|   -> Value in USD: 553.84615384
======================================================================
| POSITION METRICS:
|   Initial FLOW Deposit: 1000.00000000
|   Initial Value: 1000.00000000 MOET
|   Expected MOET Borrowed: ~615.38461538
|   Expected YieldTokens: ~683.76068375
======================================================================
| PERFORMANCE:
|   Current/Expected Value: 89.99999900%
|   Status: BELOW threshold (<95%) - should rebalance UP
======================================================================

Triggering rebalance...

======================================================================
| AUTO-BALANCER STATE: After Rebalance
======================================================================
| Tide ID: 0
| AutoBalancer ID: 0
======================================================================
| PRICES:
|   FLOW: 1.00000000 MOET
|   YieldToken: 0.90000000 MOET
|   MOET: 1.00000000 (pegged)
======================================================================
| HOLDINGS:
|   YieldToken Balance: 589.08612750
|   -> Value in MOET: 530.17751475
|   -> Value in USD: 530.17751475
======================================================================
| POSITION METRICS:
|   Initial FLOW Deposit: 1000.00000000
|   Initial Value: 1000.00000000 MOET
|   Expected MOET Borrowed: ~615.38461538
|   Expected YieldTokens: ~683.76068375
======================================================================
| PERFORMANCE:
|   Current/Expected Value: 86.15384600%
|   Status: BELOW threshold (<95%) - should rebalance UP
======================================================================

[WARNING] Potential underflow in balance change
|    Attempting: 589.08612750 - 615.38461538
|    Result would be negative, returning absolute difference
Balance DECREASED by: 26.29848788

======================================================================
|== Stage 8: YieldToken drops to 0.7
======================================================================


======================================================================
| [PRICE UPDATE] Setting YieldToken price
|    Token Identifier: A.0000000000000010.YieldToken.Vault
|    New Price: 0.70000000 MOET
|    Previous Price: (not tracked - consider adding if needed)
|    Price update successful
======================================================================


======================================================================
| AUTO-BALANCER STATE: Before Rebalance
======================================================================
| Tide ID: 0
| AutoBalancer ID: 0
======================================================================
| PRICES:
|   FLOW: 1.00000000 MOET
|   YieldToken: 0.70000000 MOET
|   MOET: 1.00000000 (pegged)
======================================================================
| HOLDINGS:
|   YieldToken Balance: 589.08612750
|   -> Value in MOET: 412.36028925
|   -> Value in USD: 412.36028925
======================================================================
| POSITION METRICS:
|   Initial FLOW Deposit: 1000.00000000
|   Initial Value: 1000.00000000 MOET
|   Expected MOET Borrowed: ~615.38461538
|   Expected YieldTokens: ~879.12087911
======================================================================
| PERFORMANCE:
|   Current/Expected Value: 67.00854700%
|   Status: BELOW threshold (<95%) - should rebalance UP
======================================================================

Triggering rebalance...

======================================================================
| AUTO-BALANCER STATE: After Rebalance
======================================================================
| Tide ID: 0
| AutoBalancer ID: 0
======================================================================
| PRICES:
|   FLOW: 1.00000000 MOET
|   YieldToken: 0.70000000 MOET
|   MOET: 1.00000000 (pegged)
======================================================================
| HOLDINGS:
|   YieldToken Balance: 456.72670393
|   -> Value in MOET: 319.70869275
|   -> Value in USD: 319.70869275
======================================================================
| POSITION METRICS:
|   Initial FLOW Deposit: 1000.00000000
|   Initial Value: 1000.00000000 MOET
|   Expected MOET Borrowed: ~615.38461538
|   Expected YieldTokens: ~879.12087911
======================================================================
| PERFORMANCE:
|   Current/Expected Value: 51.95266200%
|   Status: BELOW threshold (<95%) - should rebalance UP
======================================================================

[WARNING] Potential underflow in balance change
|    Attempting: 456.72670393 - 615.38461538
|    Result would be negative, returning absolute difference
Balance DECREASED by: 158.65791145

======================================================================
|== Stage 9: YieldToken drops to 0.5
======================================================================


======================================================================
| [PRICE UPDATE] Setting YieldToken price
|    Token Identifier: A.0000000000000010.YieldToken.Vault
|    New Price: 0.50000000 MOET
|    Previous Price: (not tracked - consider adding if needed)
|    Price update successful
======================================================================


======================================================================
| AUTO-BALANCER STATE: Before Rebalance
======================================================================
| Tide ID: 0
| AutoBalancer ID: 0
======================================================================
| PRICES:
|   FLOW: 1.00000000 MOET
|   YieldToken: 0.50000000 MOET
|   MOET: 1.00000000 (pegged)
======================================================================
| HOLDINGS:
|   YieldToken Balance: 456.72670393
|   -> Value in MOET: 228.36335196
|   -> Value in USD: 228.36335196
======================================================================
| POSITION METRICS:
|   Initial FLOW Deposit: 1000.00000000
|   Initial Value: 1000.00000000 MOET
|   Expected MOET Borrowed: ~615.38461538
|   Expected YieldTokens: ~1230.76923076
======================================================================
| PERFORMANCE:
|   Current/Expected Value: 37.10904400%
|   Status: BELOW threshold (<95%) - should rebalance UP
======================================================================

Triggering rebalance...

======================================================================
| AUTO-BALANCER STATE: After Rebalance
======================================================================
| Tide ID: 0
| AutoBalancer ID: 0
======================================================================
| PRICES:
|   FLOW: 1.00000000 MOET
|   YieldToken: 0.50000000 MOET
|   MOET: 1.00000000 (pegged)
======================================================================
| HOLDINGS:
|   YieldToken Balance: 281.06258702
|   -> Value in MOET: 140.53129351
|   -> Value in USD: 140.53129351
======================================================================
| POSITION METRICS:
|   Initial FLOW Deposit: 1000.00000000
|   Initial Value: 1000.00000000 MOET
|   Expected MOET Borrowed: ~615.38461538
|   Expected YieldTokens: ~1230.76923076
======================================================================
| PERFORMANCE:
|   Current/Expected Value: 22.83633500%
|   Status: BELOW threshold (<95%) - should rebalance UP
======================================================================

[WARNING] Potential underflow in balance change
|    Attempting: 281.06258702 - 615.38461538
|    Result would be negative, returning absolute difference
Balance DECREASED by: 334.32202836

======================================================================
|== AUTO-BORROW SCENARIO: Volatile Price Swings
======================================================================


======================================================================
| [PRICE UPDATE] Setting FLOW price
|    Token Identifier: A.0000000000000003.FlowToken.Vault
|    New Price: 1.00000000 MOET
|    Previous Price: (not tracked - consider adding if needed)
|    Price update successful
======================================================================


======================================================================
| [PRICE UPDATE] Setting MOET price
|    Token Identifier: A.0000000000000008.MOET.Vault
|    New Price: 1.00000000 MOET
|    Previous Price: (not tracked - consider adding if needed)
|    Price update successful
======================================================================

Creating position with 1000 FLOW...
Initial position health: 0.32725200

======================================================================
|== Stage 0: FLOW pumps to 1.5
======================================================================


======================================================================
| [PRICE UPDATE] Setting FLOW price
|    Token Identifier: A.0000000000000003.FlowToken.Vault
|    New Price: 1.50000000 MOET
|    Previous Price: (not tracked - consider adding if needed)
|    Price update successful
======================================================================

Health before rebalance: 0.49087800
Triggering rebalance...
Health after rebalance: 0.64168558

======================================================================
| POSITION STATE: After price = 1.50000000
======================================================================
| Position ID: 0
| Health Ratio: 0.64168558
======================================================================
| PRICES:
|   FLOW: 1.50000000 MOET
|   MOET: 1.00000000 (pegged)
======================================================================
| BALANCES:
|   MOET Debt: 93503.73656805 (BORROWED)
|   -> Value: 93503.73656805 MOET
|   FLOW Collateral: 50000.00000000
|   -> Value: 75000.00000000 MOET
======================================================================
| METRICS:
|   Effective Collateral: 60000.00000000 MOET
|   Utilization Rate: 155.83956000%
======================================================================


======================================================================
|== Stage 1: FLOW dumps to 0.7
======================================================================


======================================================================
| [PRICE UPDATE] Setting FLOW price
|    Token Identifier: A.0000000000000003.FlowToken.Vault
|    New Price: 0.70000000 MOET
|    Previous Price: (not tracked - consider adding if needed)
|    Price update successful
======================================================================

Health before rebalance: 0.29945327
Triggering rebalance...
Health after rebalance: 0.36398318

======================================================================
| POSITION STATE: After price = 0.70000000
======================================================================
| Position ID: 0
| Health Ratio: 0.36398318
======================================================================
| PRICES:
|   FLOW: 0.70000000 MOET
|   MOET: 1.00000000 (pegged)
======================================================================
| BALANCES:
|   MOET Debt: 76926.63098226 (BORROWED)
|   -> Value: 76926.63098226 MOET
|   FLOW Collateral: 50000.00000000
|   -> Value: 35000.00000000 MOET
======================================================================
| METRICS:
|   Effective Collateral: 28000.00000000 MOET
|   Utilization Rate: 274.73796700%
======================================================================


======================================================================
|== Stage 2: FLOW pumps to 1.8
======================================================================


======================================================================
| [PRICE UPDATE] Setting FLOW price
|    Token Identifier: A.0000000000000003.FlowToken.Vault
|    New Price: 1.80000000 MOET
|    Previous Price: (not tracked - consider adding if needed)
|    Price update successful
======================================================================

Health before rebalance: 0.93595675
Triggering rebalance...
Health after rebalance: 1.17231202

======================================================================
| POSITION STATE: After price = 1.80000000
======================================================================
| Position ID: 0
| Health Ratio: 1.17231202
======================================================================
| PRICES:
|   FLOW: 1.80000000 MOET
|   MOET: 1.00000000 (pegged)
======================================================================
| BALANCES:
|   MOET Debt: 61417.09607102 (BORROWED)
|   -> Value: 61417.09607102 MOET
|   FLOW Collateral: 50000.00000000
|   -> Value: 90000.00000000 MOET
======================================================================
| METRICS:
|   Effective Collateral: 72000.00000000 MOET
|   Utilization Rate: 85.30152200%
======================================================================


======================================================================
|== Stage 3: FLOW crashes to 0.4
======================================================================


======================================================================
| [PRICE UPDATE] Setting FLOW price
|    Token Identifier: A.0000000000000003.FlowToken.Vault
|    New Price: 0.40000000 MOET
|    Previous Price: (not tracked - consider adding if needed)
|    Price update successful
======================================================================

Health before rebalance: 0.26051378
Triggering rebalance...
Health after rebalance: 0.31022297

======================================================================
| POSITION STATE: After price = 0.40000000
======================================================================
| Position ID: 0
| Health Ratio: 0.31022297
======================================================================
| PRICES:
|   FLOW: 0.40000000 MOET
|   MOET: 1.00000000 (pegged)
======================================================================
| BALANCES:
|   MOET Debt: 51575.80641422 (BORROWED)
|   -> Value: 51575.80641422 MOET
|   FLOW Collateral: 50000.00000000
|   -> Value: 20000.00000000 MOET
======================================================================
| METRICS:
|   Effective Collateral: 16000.00000000 MOET
|   Utilization Rate: 322.34879000%
======================================================================


======================================================================
|== Stage 4: FLOW recovers to 1.2
======================================================================


======================================================================
| [PRICE UPDATE] Setting FLOW price
|    Token Identifier: A.0000000000000003.FlowToken.Vault
|    New Price: 1.20000000 MOET
|    Previous Price: (not tracked - consider adding if needed)
|    Price update successful
======================================================================

Health before rebalance: 0.93066891
Triggering rebalance...
Health after rebalance: 1.16828317

======================================================================
| POSITION STATE: After price = 1.20000000
======================================================================
| Position ID: 0
| Health Ratio: 1.16828317
======================================================================
| PRICES:
|   FLOW: 1.20000000 MOET
|   MOET: 1.00000000 (pegged)
======================================================================
| BALANCES:
|   MOET Debt: 41085.92930180 (BORROWED)
|   -> Value: 41085.92930180 MOET
|   FLOW Collateral: 50000.00000000
|   -> Value: 60000.00000000 MOET
======================================================================
| METRICS:
|   Effective Collateral: 48000.00000000 MOET
|   Utilization Rate: 85.59568600%
======================================================================


======================================================================
|== Stage 5: FLOW drops to 0.9
======================================================================


======================================================================
| [PRICE UPDATE] Setting FLOW price
|    Token Identifier: A.0000000000000003.FlowToken.Vault
|    New Price: 0.90000000 MOET
|    Previous Price: (not tracked - consider adding if needed)
|    Price update successful
======================================================================

Health before rebalance: 0.87621238
Triggering rebalance...
Health after rebalance: 1.12294708

======================================================================
| POSITION STATE: After price = 0.90000000
======================================================================
| Position ID: 0
| Health Ratio: 1.12294708
======================================================================
| PRICES:
|   FLOW: 0.90000000 MOET
|   MOET: 1.00000000 (pegged)
======================================================================
| BALANCES:
|   MOET Debt: 32058.50071009 (BORROWED)
|   -> Value: 32058.50071009 MOET
|   FLOW Collateral: 50000.00000000
|   -> Value: 45000.00000000 MOET
======================================================================
| METRICS:
|   Effective Collateral: 36000.00000000 MOET
|   Utilization Rate: 89.05139000%
======================================================================


======================================================================
|== Stage 6: FLOW moons to 2.5
======================================================================


======================================================================
| [PRICE UPDATE] Setting FLOW price
|    Token Identifier: A.0000000000000003.FlowToken.Vault
|    New Price: 2.50000000 MOET
|    Previous Price: (not tracked - consider adding if needed)
|    Price update successful
======================================================================

Health before rebalance: 3.11929746
Triggering rebalance...
Health after rebalance: 1.30000000

======================================================================
| POSITION STATE: After price = 2.50000000
======================================================================
| Position ID: 0
| Health Ratio: 1.30000000
======================================================================
| PRICES:
|   FLOW: 2.50000000 MOET
|   MOET: 1.00000000 (pegged)
======================================================================
| BALANCES:
|   MOET Debt: 76923.07692307 (BORROWED)
|   -> Value: 76923.07692307 MOET
|   FLOW Collateral: 50000.00000000
|   -> Value: 125000.00000000 MOET
======================================================================
| METRICS:
|   Effective Collateral: 100000.00000000 MOET
|   Utilization Rate: 76.92307600%
======================================================================


======================================================================
|== Stage 7: FLOW crashes to 0.3
======================================================================


======================================================================
| [PRICE UPDATE] Setting FLOW price
|    Token Identifier: A.0000000000000003.FlowToken.Vault
|    New Price: 0.30000000 MOET
|    Previous Price: (not tracked - consider adding if needed)
|    Price update successful
======================================================================

Health before rebalance: 0.15600000
Triggering rebalance...
Health after rebalance: 0.17441860

======================================================================
| POSITION STATE: After price = 0.30000000
======================================================================
| Position ID: 0
| Health Ratio: 0.17441860
======================================================================
| PRICES:
|   FLOW: 0.30000000 MOET
|   MOET: 1.00000000 (pegged)
======================================================================
| BALANCES:
|   MOET Debt: 68800.00000000 (BORROWED)
|   -> Value: 68800.00000000 MOET
|   FLOW Collateral: 50000.00000000
|   -> Value: 15000.00000000 MOET
======================================================================
| METRICS:
|   Effective Collateral: 12000.00000000 MOET
|   Utilization Rate: 573.33333300%
======================================================================


======================================================================
|== Stage 8: FLOW stabilizes at 1.0
======================================================================


======================================================================
| [PRICE UPDATE] Setting FLOW price
|    Token Identifier: A.0000000000000003.FlowToken.Vault
|    New Price: 1.00000000 MOET
|    Previous Price: (not tracked - consider adding if needed)
|    Price update successful
======================================================================

Health before rebalance: 0.58139534
Triggering rebalance...
Health after rebalance: 0.77232592

======================================================================
| POSITION STATE: After price = 1.00000000
======================================================================
| Position ID: 0
| Health Ratio: 0.77232592
======================================================================
| PRICES:
|   FLOW: 1.00000000 MOET
|   MOET: 1.00000000 (pegged)
======================================================================
| BALANCES:
|   MOET Debt: 51791.60568048 (BORROWED)
|   -> Value: 51791.60568048 MOET
|   FLOW Collateral: 50000.00000000
|   -> Value: 50000.00000000 MOET
======================================================================
| METRICS:
|   Effective Collateral: 40000.00000000 MOET
|   Utilization Rate: 129.47901400%
======================================================================

Test results: "./cadence/tests/price_scenario_test.cdc"
- PASS: testExtremePriceMovements
- PASS: testGradualPriceChanges
- PASS: testVolatilePriceSwings
Coverage: 74.9% of statements
Running test: testVolatilePriceSwings

======================================================================
|== AUTO-BORROW SCENARIO: Extreme FLOW Price Volatility
======================================================================


======================================================================
| [PRICE UPDATE] Setting FLOW price
|    Token Identifier: A.0000000000000003.FlowToken.Vault
|    New Price: 1.00000000 MOET
|    Previous Price: (not tracked - consider adding if needed)
|    Price update successful
======================================================================


======================================================================
| [PRICE UPDATE] Setting MOET price
|    Token Identifier: A.0000000000000008.MOET.Vault
|    New Price: 1.00000000 MOET
|    Previous Price: (not tracked - consider adding if needed)
|    Price update successful
======================================================================

Creating position with 1000 FLOW...
Initial position health: 1.30000000

======================================================================
|== Stage 0: FLOW drops 50% to 0.5
======================================================================


======================================================================
| [PRICE UPDATE] Setting FLOW price
|    Token Identifier: A.0000000000000003.FlowToken.Vault
|    New Price: 0.50000000 MOET
|    Previous Price: (not tracked - consider adding if needed)
|    Price update successful
======================================================================

Health before rebalance: 0.65000000
Triggering rebalance...
Health after rebalance: 0.86666666

======================================================================
| POSITION STATE: After price = 0.50000000
======================================================================
| Position ID: 0
| Health Ratio: 0.86666666
======================================================================
| PRICES:
|   FLOW: 0.50000000 MOET
|   MOET: 1.00000000 (pegged)
======================================================================
| BALANCES:
|   MOET Debt: 23076.92307693 (BORROWED)
|   -> Value: 23076.92307693 MOET
|   FLOW Collateral: 50000.00000000
|   -> Value: 25000.00000000 MOET
======================================================================
| METRICS:
|   Effective Collateral: 20000.00000000 MOET
|   Utilization Rate: 115.38461500%
======================================================================


======================================================================
|== Stage 1: FLOW crashes 90% to 0.1
======================================================================


======================================================================
| [PRICE UPDATE] Setting FLOW price
|    Token Identifier: A.0000000000000003.FlowToken.Vault
|    New Price: 0.10000000 MOET
|    Previous Price: (not tracked - consider adding if needed)
|    Price update successful
======================================================================

Health before rebalance: 0.17333333
Triggering rebalance...
Health after rebalance: 0.19597989

======================================================================
| POSITION STATE: After price = 0.10000000
======================================================================
| Position ID: 0
| Health Ratio: 0.19597989
======================================================================
| PRICES:
|   FLOW: 0.10000000 MOET
|   MOET: 1.00000000 (pegged)
======================================================================
| BALANCES:
|   MOET Debt: 20410.25640238 (BORROWED)
|   -> Value: 20410.25640238 MOET
|   FLOW Collateral: 50000.00000000
|   -> Value: 5000.00000000 MOET
======================================================================
| METRICS:
|   Effective Collateral: 4000.00000000 MOET
|   Utilization Rate: 510.25641000%
======================================================================


======================================================================
|== Stage 2: FLOW recovers to 2.0 (2x original)
======================================================================


======================================================================
| [PRICE UPDATE] Setting FLOW price
|    Token Identifier: A.0000000000000003.FlowToken.Vault
|    New Price: 2.00000000 MOET
|    Previous Price: (not tracked - consider adding if needed)
|    Price update successful
======================================================================

Health before rebalance: 3.91959799
Triggering rebalance...
Health after rebalance: 1.30000000

======================================================================
| POSITION STATE: After price = 2.00000000
======================================================================
| Position ID: 0
| Health Ratio: 1.30000000
======================================================================
| PRICES:
|   FLOW: 2.00000000 MOET
|   MOET: 1.00000000 (pegged)
======================================================================
| BALANCES:
|   MOET Debt: 61538.46153846 (BORROWED)
|   -> Value: 61538.46153846 MOET
|   FLOW Collateral: 50000.00000000
|   -> Value: 100000.00000000 MOET
======================================================================
| METRICS:
|   Effective Collateral: 80000.00000000 MOET
|   Utilization Rate: 76.92307600%
======================================================================


======================================================================
|== Stage 3: FLOW moons to 5.0 (5x original)
======================================================================


======================================================================
| [PRICE UPDATE] Setting FLOW price
|    Token Identifier: A.0000000000000003.FlowToken.Vault
|    New Price: 5.00000000 MOET
|    Previous Price: (not tracked - consider adding if needed)
|    Price update successful
======================================================================

Health before rebalance: 3.25000000
Triggering rebalance...
Health after rebalance: 1.30000000

======================================================================
| POSITION STATE: After price = 5.00000000
======================================================================
| Position ID: 0
| Health Ratio: 1.30000000
======================================================================
| PRICES:
|   FLOW: 5.00000000 MOET
|   MOET: 1.00000000 (pegged)
======================================================================
| BALANCES:
|   MOET Debt: 153846.15384615 (BORROWED)
|   -> Value: 153846.15384615 MOET
|   FLOW Collateral: 50000.00000000
|   -> Value: 250000.00000000 MOET
======================================================================
| METRICS:
|   Effective Collateral: 200000.00000000 MOET
|   Utilization Rate: 76.92307600%
======================================================================


======================================================================
|== Stage 4: FLOW crashes back to 0.25
======================================================================


======================================================================
| [PRICE UPDATE] Setting FLOW price
|    Token Identifier: A.0000000000000003.FlowToken.Vault
|    New Price: 0.25000000 MOET
|    Previous Price: (not tracked - consider adding if needed)
|    Price update successful
======================================================================

Health before rebalance: 0.06500000
Triggering rebalance...
Health after rebalance: 0.06824146

======================================================================
| POSITION STATE: After price = 0.25000000
======================================================================
| Position ID: 0
| Health Ratio: 0.06824146
======================================================================
| PRICES:
|   FLOW: 0.25000000 MOET
|   MOET: 1.00000000 (pegged)
======================================================================
| BALANCES:
|   MOET Debt: 146538.46153846 (BORROWED)
|   -> Value: 146538.46153846 MOET
|   FLOW Collateral: 50000.00000000
|   -> Value: 12500.00000000 MOET
======================================================================
| METRICS:
|   Effective Collateral: 10000.00000000 MOET
|   Utilization Rate: 1465.38461500%
======================================================================


======================================================================
|== Stage 5: FLOW stabilizes at 1.0
======================================================================


======================================================================
| [PRICE UPDATE] Setting FLOW price
|    Token Identifier: A.0000000000000003.FlowToken.Vault
|    New Price: 1.00000000 MOET
|    Previous Price: (not tracked - consider adding if needed)
|    Price update successful
======================================================================

Health before rebalance: 0.27296587
Triggering rebalance...
Health after rebalance: 0.32725200

======================================================================
| POSITION STATE: After price = 1.00000000
======================================================================
| Position ID: 0
| Health Ratio: 0.32725200
======================================================================
| PRICES:
|   FLOW: 1.00000000 MOET
|   MOET: 1.00000000 (pegged)
======================================================================
| BALANCES:
|   MOET Debt: 122229.96142012 (BORROWED)
|   -> Value: 122229.96142012 MOET
|   FLOW Collateral: 50000.00000000
|   -> Value: 50000.00000000 MOET
======================================================================
| METRICS:
|   Effective Collateral: 40000.00000000 MOET
|   Utilization Rate: 305.57490300%
======================================================================


======================================================================
|== AUTO-BALANCER SCENARIO: Gradual YieldToken Price Changes
======================================================================

Creating Tide with TracerStrategy...
Initial AutoBalancer balance: 615.38461538 YieldToken

======================================================================
|== Stage 0: YieldToken +10% to 1.1
======================================================================


======================================================================
| [PRICE UPDATE] Setting YieldToken price
|    Token Identifier: A.0000000000000010.YieldToken.Vault
|    New Price: 1.10000000 MOET
|    Previous Price: (not tracked - consider adding if needed)
|    Price update successful
======================================================================


======================================================================
| AUTO-BALANCER STATE: Before Rebalance
======================================================================
| Tide ID: 0
| AutoBalancer ID: 0
======================================================================
| PRICES:
|   FLOW: 1.00000000 MOET
|   YieldToken: 1.10000000 MOET
|   MOET: 1.00000000 (pegged)
======================================================================
| HOLDINGS:
|   YieldToken Balance: 615.38461538
|   -> Value in MOET: 676.92307691
|   -> Value in USD: 676.92307691
======================================================================
| POSITION METRICS:
|   Initial FLOW Deposit: 1000.00000000
|   Initial Value: 1000.00000000 MOET
|   Expected MOET Borrowed: ~615.38461538
|   Expected YieldTokens: ~559.44055943
======================================================================
| PERFORMANCE:
|   Current/Expected Value: 109.99999900%
|   Status: ABOVE threshold (>105%) - should rebalance DOWN
======================================================================

Triggering rebalance...

======================================================================
| AUTO-BALANCER STATE: After Rebalance
======================================================================
| Tide ID: 0
| AutoBalancer ID: 0
======================================================================
| PRICES:
|   FLOW: 1.00000000 MOET
|   YieldToken: 1.10000000 MOET
|   MOET: 1.00000000 (pegged)
======================================================================
| HOLDINGS:
|   YieldToken Balance: 615.38461538
|   -> Value in MOET: 676.92307691
|   -> Value in USD: 676.92307691
======================================================================
| POSITION METRICS:
|   Initial FLOW Deposit: 1000.00000000
|   Initial Value: 1000.00000000 MOET
|   Expected MOET Borrowed: ~615.38461538
|   Expected YieldTokens: ~559.44055943
======================================================================
| PERFORMANCE:
|   Current/Expected Value: 109.99999900%
|   Status: ABOVE threshold (>105%) - should rebalance DOWN
======================================================================

Balance UNCHANGED

======================================================================
|== Stage 1: YieldToken +20% to 1.2
======================================================================


======================================================================
| [PRICE UPDATE] Setting YieldToken price
|    Token Identifier: A.0000000000000010.YieldToken.Vault
|    New Price: 1.20000000 MOET
|    Previous Price: (not tracked - consider adding if needed)
|    Price update successful
======================================================================


======================================================================
| AUTO-BALANCER STATE: Before Rebalance
======================================================================
| Tide ID: 0
| AutoBalancer ID: 0
======================================================================
| PRICES:
|   FLOW: 1.00000000 MOET
|   YieldToken: 1.20000000 MOET
|   MOET: 1.00000000 (pegged)
======================================================================
| HOLDINGS:
|   YieldToken Balance: 615.38461538
|   -> Value in MOET: 738.46153845
|   -> Value in USD: 738.46153845
======================================================================
| POSITION METRICS:
|   Initial FLOW Deposit: 1000.00000000
|   Initial Value: 1000.00000000 MOET
|   Expected MOET Borrowed: ~615.38461538
|   Expected YieldTokens: ~512.82051281
======================================================================
| PERFORMANCE:
|   Current/Expected Value: 119.99999900%
|   Status: ABOVE threshold (>105%) - should rebalance DOWN
======================================================================

Triggering rebalance...

======================================================================
| AUTO-BALANCER STATE: After Rebalance
======================================================================
| Tide ID: 0
| AutoBalancer ID: 0
======================================================================
| PRICES:
|   FLOW: 1.00000000 MOET
|   YieldToken: 1.20000000 MOET
|   MOET: 1.00000000 (pegged)
======================================================================
| HOLDINGS:
|   YieldToken Balance: 615.38461538
|   -> Value in MOET: 738.46153845
|   -> Value in USD: 738.46153845
======================================================================
| POSITION METRICS:
|   Initial FLOW Deposit: 1000.00000000
|   Initial Value: 1000.00000000 MOET
|   Expected MOET Borrowed: ~615.38461538
|   Expected YieldTokens: ~512.82051281
======================================================================
| PERFORMANCE:
|   Current/Expected Value: 119.99999900%
|   Status: ABOVE threshold (>105%) - should rebalance DOWN
======================================================================

Balance UNCHANGED

======================================================================
|== Stage 2: YieldToken +30% to 1.3
======================================================================


======================================================================
| [PRICE UPDATE] Setting YieldToken price
|    Token Identifier: A.0000000000000010.YieldToken.Vault
|    New Price: 1.30000000 MOET
|    Previous Price: (not tracked - consider adding if needed)
|    Price update successful
======================================================================


======================================================================
| AUTO-BALANCER STATE: Before Rebalance
======================================================================
| Tide ID: 0
| AutoBalancer ID: 0
======================================================================
| PRICES:
|   FLOW: 1.00000000 MOET
|   YieldToken: 1.30000000 MOET
|   MOET: 1.00000000 (pegged)
======================================================================
| HOLDINGS:
|   YieldToken Balance: 615.38461538
|   -> Value in MOET: 799.99999999
|   -> Value in USD: 799.99999999
======================================================================
| POSITION METRICS:
|   Initial FLOW Deposit: 1000.00000000
|   Initial Value: 1000.00000000 MOET
|   Expected MOET Borrowed: ~615.38461538
|   Expected YieldTokens: ~473.37278106
======================================================================
| PERFORMANCE:
|   Current/Expected Value: 129.99999900%
|   Status: ABOVE threshold (>105%) - should rebalance DOWN
======================================================================

Triggering rebalance...

======================================================================
| AUTO-BALANCER STATE: After Rebalance
======================================================================
| Tide ID: 0
| AutoBalancer ID: 0
======================================================================
| PRICES:
|   FLOW: 1.00000000 MOET
|   YieldToken: 1.30000000 MOET
|   MOET: 1.00000000 (pegged)
======================================================================
| HOLDINGS:
|   YieldToken Balance: 615.38461538
|   -> Value in MOET: 799.99999999
|   -> Value in USD: 799.99999999
======================================================================
| POSITION METRICS:
|   Initial FLOW Deposit: 1000.00000000
|   Initial Value: 1000.00000000 MOET
|   Expected MOET Borrowed: ~615.38461538
|   Expected YieldTokens: ~473.37278106
======================================================================
| PERFORMANCE:
|   Current/Expected Value: 129.99999900%
|   Status: ABOVE threshold (>105%) - should rebalance DOWN
======================================================================

Balance UNCHANGED

======================================================================
|== Stage 3: YieldToken +40% to 1.4
======================================================================


======================================================================
| [PRICE UPDATE] Setting YieldToken price
|    Token Identifier: A.0000000000000010.YieldToken.Vault
|    New Price: 1.40000000 MOET
|    Previous Price: (not tracked - consider adding if needed)
|    Price update successful
======================================================================


======================================================================
| AUTO-BALANCER STATE: Before Rebalance
======================================================================
| Tide ID: 0
| AutoBalancer ID: 0
======================================================================
| PRICES:
|   FLOW: 1.00000000 MOET
|   YieldToken: 1.40000000 MOET
|   MOET: 1.00000000 (pegged)
======================================================================
| HOLDINGS:
|   YieldToken Balance: 615.38461538
|   -> Value in MOET: 861.53846153
|   -> Value in USD: 861.53846153
======================================================================
| POSITION METRICS:
|   Initial FLOW Deposit: 1000.00000000
|   Initial Value: 1000.00000000 MOET
|   Expected MOET Borrowed: ~615.38461538
|   Expected YieldTokens: ~439.56043955
======================================================================
| PERFORMANCE:
|   Current/Expected Value: 139.99999900%
|   Status: ABOVE threshold (>105%) - should rebalance DOWN
======================================================================

Triggering rebalance...

======================================================================
| AUTO-BALANCER STATE: After Rebalance
======================================================================
| Tide ID: 0
| AutoBalancer ID: 0
======================================================================
| PRICES:
|   FLOW: 1.00000000 MOET
|   YieldToken: 1.40000000 MOET
|   MOET: 1.00000000 (pegged)
======================================================================
| HOLDINGS:
|   YieldToken Balance: 615.38461538
|   -> Value in MOET: 861.53846153
|   -> Value in USD: 861.53846153
======================================================================
| POSITION METRICS:
|   Initial FLOW Deposit: 1000.00000000
|   Initial Value: 1000.00000000 MOET
|   Expected MOET Borrowed: ~615.38461538
|   Expected YieldTokens: ~439.56043955
======================================================================
| PERFORMANCE:
|   Current/Expected Value: 139.99999900%
|   Status: ABOVE threshold (>105%) - should rebalance DOWN
======================================================================

Balance UNCHANGED

======================================================================
|== Stage 4: YieldToken +50% to 1.5
======================================================================


======================================================================
| [PRICE UPDATE] Setting YieldToken price
|    Token Identifier: A.0000000000000010.YieldToken.Vault
|    New Price: 1.50000000 MOET
|    Previous Price: (not tracked - consider adding if needed)
|    Price update successful
======================================================================


======================================================================
| AUTO-BALANCER STATE: Before Rebalance
======================================================================
| Tide ID: 0
| AutoBalancer ID: 0
======================================================================
| PRICES:
|   FLOW: 1.00000000 MOET
|   YieldToken: 1.50000000 MOET
|   MOET: 1.00000000 (pegged)
======================================================================
| HOLDINGS:
|   YieldToken Balance: 615.38461538
|   -> Value in MOET: 923.07692307
|   -> Value in USD: 923.07692307
======================================================================
| POSITION METRICS:
|   Initial FLOW Deposit: 1000.00000000
|   Initial Value: 1000.00000000 MOET
|   Expected MOET Borrowed: ~615.38461538
|   Expected YieldTokens: ~410.25641025
======================================================================
| PERFORMANCE:
|   Current/Expected Value: 150.00000000%
|   Status: ABOVE threshold (>105%) - should rebalance DOWN
======================================================================

Triggering rebalance...

======================================================================
| AUTO-BALANCER STATE: After Rebalance
======================================================================
| Tide ID: 0
| AutoBalancer ID: 0
======================================================================
| PRICES:
|   FLOW: 1.00000000 MOET
|   YieldToken: 1.50000000 MOET
|   MOET: 1.00000000 (pegged)
======================================================================
| HOLDINGS:
|   YieldToken Balance: 615.38461538
|   -> Value in MOET: 923.07692307
|   -> Value in USD: 923.07692307
======================================================================
| POSITION METRICS:
|   Initial FLOW Deposit: 1000.00000000
|   Initial Value: 1000.00000000 MOET
|   Expected MOET Borrowed: ~615.38461538
|   Expected YieldTokens: ~410.25641025
======================================================================
| PERFORMANCE:
|   Current/Expected Value: 150.00000000%
|   Status: ABOVE threshold (>105%) - should rebalance DOWN
======================================================================

Balance UNCHANGED

======================================================================
|== Stage 5: YieldToken drops to 1.3
======================================================================


======================================================================
| [PRICE UPDATE] Setting YieldToken price
|    Token Identifier: A.0000000000000010.YieldToken.Vault
|    New Price: 1.30000000 MOET
|    Previous Price: (not tracked - consider adding if needed)
|    Price update successful
======================================================================


======================================================================
| AUTO-BALANCER STATE: Before Rebalance
======================================================================
| Tide ID: 0
| AutoBalancer ID: 0
======================================================================
| PRICES:
|   FLOW: 1.00000000 MOET
|   YieldToken: 1.30000000 MOET
|   MOET: 1.00000000 (pegged)
======================================================================
| HOLDINGS:
|   YieldToken Balance: 615.38461538
|   -> Value in MOET: 799.99999999
|   -> Value in USD: 799.99999999
======================================================================
| POSITION METRICS:
|   Initial FLOW Deposit: 1000.00000000
|   Initial Value: 1000.00000000 MOET
|   Expected MOET Borrowed: ~615.38461538
|   Expected YieldTokens: ~473.37278106
======================================================================
| PERFORMANCE:
|   Current/Expected Value: 129.99999900%
|   Status: ABOVE threshold (>105%) - should rebalance DOWN
======================================================================

Triggering rebalance...

======================================================================
| AUTO-BALANCER STATE: After Rebalance
======================================================================
| Tide ID: 0
| AutoBalancer ID: 0
======================================================================
| PRICES:
|   FLOW: 1.00000000 MOET
|   YieldToken: 1.30000000 MOET
|   MOET: 1.00000000 (pegged)
======================================================================
| HOLDINGS:
|   YieldToken Balance: 615.38461538
|   -> Value in MOET: 799.99999999
|   -> Value in USD: 799.99999999
======================================================================
| POSITION METRICS:
|   Initial FLOW Deposit: 1000.00000000
|   Initial Value: 1000.00000000 MOET
|   Expected MOET Borrowed: ~615.38461538
|   Expected YieldTokens: ~473.37278106
======================================================================
| PERFORMANCE:
|   Current/Expected Value: 129.99999900%
|   Status: ABOVE threshold (>105%) - should rebalance DOWN
======================================================================

Balance UNCHANGED

======================================================================
|== Stage 6: YieldToken drops to 1.1
======================================================================


======================================================================
| [PRICE UPDATE] Setting YieldToken price
|    Token Identifier: A.0000000000000010.YieldToken.Vault
|    New Price: 1.10000000 MOET
|    Previous Price: (not tracked - consider adding if needed)
|    Price update successful
======================================================================


======================================================================
| AUTO-BALANCER STATE: Before Rebalance
======================================================================
| Tide ID: 0
| AutoBalancer ID: 0
======================================================================
| PRICES:
|   FLOW: 1.00000000 MOET
|   YieldToken: 1.10000000 MOET
|   MOET: 1.00000000 (pegged)
======================================================================
| HOLDINGS:
|   YieldToken Balance: 615.38461538
|   -> Value in MOET: 676.92307691
|   -> Value in USD: 676.92307691
======================================================================
| POSITION METRICS:
|   Initial FLOW Deposit: 1000.00000000
|   Initial Value: 1000.00000000 MOET
|   Expected MOET Borrowed: ~615.38461538
|   Expected YieldTokens: ~559.44055943
======================================================================
| PERFORMANCE:
|   Current/Expected Value: 109.99999900%
|   Status: ABOVE threshold (>105%) - should rebalance DOWN
======================================================================

Triggering rebalance...

======================================================================
| AUTO-BALANCER STATE: After Rebalance
======================================================================
| Tide ID: 0
| AutoBalancer ID: 0
======================================================================
| PRICES:
|   FLOW: 1.00000000 MOET
|   YieldToken: 1.10000000 MOET
|   MOET: 1.00000000 (pegged)
======================================================================
| HOLDINGS:
|   YieldToken Balance: 615.38461538
|   -> Value in MOET: 676.92307691
|   -> Value in USD: 676.92307691
======================================================================
| POSITION METRICS:
|   Initial FLOW Deposit: 1000.00000000
|   Initial Value: 1000.00000000 MOET
|   Expected MOET Borrowed: ~615.38461538
|   Expected YieldTokens: ~559.44055943
======================================================================
| PERFORMANCE:
|   Current/Expected Value: 109.99999900%
|   Status: ABOVE threshold (>105%) - should rebalance DOWN
======================================================================

Balance UNCHANGED

======================================================================
|== Stage 7: YieldToken drops to 0.9
======================================================================


======================================================================
| [PRICE UPDATE] Setting YieldToken price
|    Token Identifier: A.0000000000000010.YieldToken.Vault
|    New Price: 0.90000000 MOET
|    Previous Price: (not tracked - consider adding if needed)
|    Price update successful
======================================================================


======================================================================
| AUTO-BALANCER STATE: Before Rebalance
======================================================================
| Tide ID: 0
| AutoBalancer ID: 0
======================================================================
| PRICES:
|   FLOW: 1.00000000 MOET
|   YieldToken: 0.90000000 MOET
|   MOET: 1.00000000 (pegged)
======================================================================
| HOLDINGS:
|   YieldToken Balance: 615.38461538
|   -> Value in MOET: 553.84615384
|   -> Value in USD: 553.84615384
======================================================================
| POSITION METRICS:
|   Initial FLOW Deposit: 1000.00000000
|   Initial Value: 1000.00000000 MOET
|   Expected MOET Borrowed: ~615.38461538
|   Expected YieldTokens: ~683.76068375
======================================================================
| PERFORMANCE:
|   Current/Expected Value: 89.99999900%
|   Status: BELOW threshold (<95%) - should rebalance UP
======================================================================

Triggering rebalance...

======================================================================
| AUTO-BALANCER STATE: After Rebalance
======================================================================
| Tide ID: 0
| AutoBalancer ID: 0
======================================================================
| PRICES:
|   FLOW: 1.00000000 MOET
|   YieldToken: 0.90000000 MOET
|   MOET: 1.00000000 (pegged)
======================================================================
| HOLDINGS:
|   YieldToken Balance: 589.08612750
|   -> Value in MOET: 530.17751475
|   -> Value in USD: 530.17751475
======================================================================
| POSITION METRICS:
|   Initial FLOW Deposit: 1000.00000000
|   Initial Value: 1000.00000000 MOET
|   Expected MOET Borrowed: ~615.38461538
|   Expected YieldTokens: ~683.76068375
======================================================================
| PERFORMANCE:
|   Current/Expected Value: 86.15384600%
|   Status: BELOW threshold (<95%) - should rebalance UP
======================================================================

[WARNING] Potential underflow in balance change
|    Attempting: 589.08612750 - 615.38461538
|    Result would be negative, returning absolute difference
Balance DECREASED by: 26.29848788

======================================================================
|== Stage 8: YieldToken drops to 0.7
======================================================================


======================================================================
| [PRICE UPDATE] Setting YieldToken price
|    Token Identifier: A.0000000000000010.YieldToken.Vault
|    New Price: 0.70000000 MOET
|    Previous Price: (not tracked - consider adding if needed)
|    Price update successful
======================================================================


======================================================================
| AUTO-BALANCER STATE: Before Rebalance
======================================================================
| Tide ID: 0
| AutoBalancer ID: 0
======================================================================
| PRICES:
|   FLOW: 1.00000000 MOET
|   YieldToken: 0.70000000 MOET
|   MOET: 1.00000000 (pegged)
======================================================================
| HOLDINGS:
|   YieldToken Balance: 589.08612750
|   -> Value in MOET: 412.36028925
|   -> Value in USD: 412.36028925
======================================================================
| POSITION METRICS:
|   Initial FLOW Deposit: 1000.00000000
|   Initial Value: 1000.00000000 MOET
|   Expected MOET Borrowed: ~615.38461538
|   Expected YieldTokens: ~879.12087911
======================================================================
| PERFORMANCE:
|   Current/Expected Value: 67.00854700%
|   Status: BELOW threshold (<95%) - should rebalance UP
======================================================================

Triggering rebalance...

======================================================================
| AUTO-BALANCER STATE: After Rebalance
======================================================================
| Tide ID: 0
| AutoBalancer ID: 0
======================================================================
| PRICES:
|   FLOW: 1.00000000 MOET
|   YieldToken: 0.70000000 MOET
|   MOET: 1.00000000 (pegged)
======================================================================
| HOLDINGS:
|   YieldToken Balance: 456.72670393
|   -> Value in MOET: 319.70869275
|   -> Value in USD: 319.70869275
======================================================================
| POSITION METRICS:
|   Initial FLOW Deposit: 1000.00000000
|   Initial Value: 1000.00000000 MOET
|   Expected MOET Borrowed: ~615.38461538
|   Expected YieldTokens: ~879.12087911
======================================================================
| PERFORMANCE:
|   Current/Expected Value: 51.95266200%
|   Status: BELOW threshold (<95%) - should rebalance UP
======================================================================

[WARNING] Potential underflow in balance change
|    Attempting: 456.72670393 - 615.38461538
|    Result would be negative, returning absolute difference
Balance DECREASED by: 158.65791145

======================================================================
|== Stage 9: YieldToken drops to 0.5
======================================================================


======================================================================
| [PRICE UPDATE] Setting YieldToken price
|    Token Identifier: A.0000000000000010.YieldToken.Vault
|    New Price: 0.50000000 MOET
|    Previous Price: (not tracked - consider adding if needed)
|    Price update successful
======================================================================


======================================================================
| AUTO-BALANCER STATE: Before Rebalance
======================================================================
| Tide ID: 0
| AutoBalancer ID: 0
======================================================================
| PRICES:
|   FLOW: 1.00000000 MOET
|   YieldToken: 0.50000000 MOET
|   MOET: 1.00000000 (pegged)
======================================================================
| HOLDINGS:
|   YieldToken Balance: 456.72670393
|   -> Value in MOET: 228.36335196
|   -> Value in USD: 228.36335196
======================================================================
| POSITION METRICS:
|   Initial FLOW Deposit: 1000.00000000
|   Initial Value: 1000.00000000 MOET
|   Expected MOET Borrowed: ~615.38461538
|   Expected YieldTokens: ~1230.76923076
======================================================================
| PERFORMANCE:
|   Current/Expected Value: 37.10904400%
|   Status: BELOW threshold (<95%) - should rebalance UP
======================================================================

Triggering rebalance...

======================================================================
| AUTO-BALANCER STATE: After Rebalance
======================================================================
| Tide ID: 0
| AutoBalancer ID: 0
======================================================================
| PRICES:
|   FLOW: 1.00000000 MOET
|   YieldToken: 0.50000000 MOET
|   MOET: 1.00000000 (pegged)
======================================================================
| HOLDINGS:
|   YieldToken Balance: 281.06258702
|   -> Value in MOET: 140.53129351
|   -> Value in USD: 140.53129351
======================================================================
| POSITION METRICS:
|   Initial FLOW Deposit: 1000.00000000
|   Initial Value: 1000.00000000 MOET
|   Expected MOET Borrowed: ~615.38461538
|   Expected YieldTokens: ~1230.76923076
======================================================================
| PERFORMANCE:
|   Current/Expected Value: 22.83633500%
|   Status: BELOW threshold (<95%) - should rebalance UP
======================================================================

[WARNING] Potential underflow in balance change
|    Attempting: 281.06258702 - 615.38461538
|    Result would be negative, returning absolute difference
Balance DECREASED by: 334.32202836

======================================================================
|== AUTO-BORROW SCENARIO: Volatile Price Swings
======================================================================


======================================================================
| [PRICE UPDATE] Setting FLOW price
|    Token Identifier: A.0000000000000003.FlowToken.Vault
|    New Price: 1.00000000 MOET
|    Previous Price: (not tracked - consider adding if needed)
|    Price update successful
======================================================================


======================================================================
| [PRICE UPDATE] Setting MOET price
|    Token Identifier: A.0000000000000008.MOET.Vault
|    New Price: 1.00000000 MOET
|    Previous Price: (not tracked - consider adding if needed)
|    Price update successful
======================================================================

Creating position with 1000 FLOW...
Initial position health: 0.32725200

======================================================================
|== Stage 0: FLOW pumps to 1.5
======================================================================


======================================================================
| [PRICE UPDATE] Setting FLOW price
|    Token Identifier: A.0000000000000003.FlowToken.Vault
|    New Price: 1.50000000 MOET
|    Previous Price: (not tracked - consider adding if needed)
|    Price update successful
======================================================================

Health before rebalance: 0.49087800
Triggering rebalance...
Health after rebalance: 0.64168558

======================================================================
| POSITION STATE: After price = 1.50000000
======================================================================
| Position ID: 0
| Health Ratio: 0.64168558
======================================================================
| PRICES:
|   FLOW: 1.50000000 MOET
|   MOET: 1.00000000 (pegged)
======================================================================
| BALANCES:
|   MOET Debt: 93503.73656805 (BORROWED)
|   -> Value: 93503.73656805 MOET
|   FLOW Collateral: 50000.00000000
|   -> Value: 75000.00000000 MOET
======================================================================
| METRICS:
|   Effective Collateral: 60000.00000000 MOET
|   Utilization Rate: 155.83956000%
======================================================================


======================================================================
|== Stage 1: FLOW dumps to 0.7
======================================================================


======================================================================
| [PRICE UPDATE] Setting FLOW price
|    Token Identifier: A.0000000000000003.FlowToken.Vault
|    New Price: 0.70000000 MOET
|    Previous Price: (not tracked - consider adding if needed)
|    Price update successful
======================================================================

Health before rebalance: 0.29945327
Triggering rebalance...
Health after rebalance: 0.36398318

======================================================================
| POSITION STATE: After price = 0.70000000
======================================================================
| Position ID: 0
| Health Ratio: 0.36398318
======================================================================
| PRICES:
|   FLOW: 0.70000000 MOET
|   MOET: 1.00000000 (pegged)
======================================================================
| BALANCES:
|   MOET Debt: 76926.63098226 (BORROWED)
|   -> Value: 76926.63098226 MOET
|   FLOW Collateral: 50000.00000000
|   -> Value: 35000.00000000 MOET
======================================================================
| METRICS:
|   Effective Collateral: 28000.00000000 MOET
|   Utilization Rate: 274.73796700%
======================================================================


======================================================================
|== Stage 2: FLOW pumps to 1.8
======================================================================


======================================================================
| [PRICE UPDATE] Setting FLOW price
|    Token Identifier: A.0000000000000003.FlowToken.Vault
|    New Price: 1.80000000 MOET
|    Previous Price: (not tracked - consider adding if needed)
|    Price update successful
======================================================================

Health before rebalance: 0.93595675
Triggering rebalance...
Health after rebalance: 1.17231202

======================================================================
| POSITION STATE: After price = 1.80000000
======================================================================
| Position ID: 0
| Health Ratio: 1.17231202
======================================================================
| PRICES:
|   FLOW: 1.80000000 MOET
|   MOET: 1.00000000 (pegged)
======================================================================
| BALANCES:
|   MOET Debt: 61417.09607102 (BORROWED)
|   -> Value: 61417.09607102 MOET
|   FLOW Collateral: 50000.00000000
|   -> Value: 90000.00000000 MOET
======================================================================
| METRICS:
|   Effective Collateral: 72000.00000000 MOET
|   Utilization Rate: 85.30152200%
======================================================================


======================================================================
|== Stage 3: FLOW crashes to 0.4
======================================================================


======================================================================
| [PRICE UPDATE] Setting FLOW price
|    Token Identifier: A.0000000000000003.FlowToken.Vault
|    New Price: 0.40000000 MOET
|    Previous Price: (not tracked - consider adding if needed)
|    Price update successful
======================================================================

Health before rebalance: 0.26051378
Triggering rebalance...
Health after rebalance: 0.31022297

======================================================================
| POSITION STATE: After price = 0.40000000
======================================================================
| Position ID: 0
| Health Ratio: 0.31022297
======================================================================
| PRICES:
|   FLOW: 0.40000000 MOET
|   MOET: 1.00000000 (pegged)
======================================================================
| BALANCES:
|   MOET Debt: 51575.80641422 (BORROWED)
|   -> Value: 51575.80641422 MOET
|   FLOW Collateral: 50000.00000000
|   -> Value: 20000.00000000 MOET
======================================================================
| METRICS:
|   Effective Collateral: 16000.00000000 MOET
|   Utilization Rate: 322.34879000%
======================================================================


======================================================================
|== Stage 4: FLOW recovers to 1.2
======================================================================


======================================================================
| [PRICE UPDATE] Setting FLOW price
|    Token Identifier: A.0000000000000003.FlowToken.Vault
|    New Price: 1.20000000 MOET
|    Previous Price: (not tracked - consider adding if needed)
|    Price update successful
======================================================================

Health before rebalance: 0.93066891
Triggering rebalance...
Health after rebalance: 1.16828317

======================================================================
| POSITION STATE: After price = 1.20000000
======================================================================
| Position ID: 0
| Health Ratio: 1.16828317
======================================================================
| PRICES:
|   FLOW: 1.20000000 MOET
|   MOET: 1.00000000 (pegged)
======================================================================
| BALANCES:
|   MOET Debt: 41085.92930180 (BORROWED)
|   -> Value: 41085.92930180 MOET
|   FLOW Collateral: 50000.00000000
|   -> Value: 60000.00000000 MOET
======================================================================
| METRICS:
|   Effective Collateral: 48000.00000000 MOET
|   Utilization Rate: 85.59568600%
======================================================================


======================================================================
|== Stage 5: FLOW drops to 0.9
======================================================================


======================================================================
| [PRICE UPDATE] Setting FLOW price
|    Token Identifier: A.0000000000000003.FlowToken.Vault
|    New Price: 0.90000000 MOET
|    Previous Price: (not tracked - consider adding if needed)
|    Price update successful
======================================================================

Health before rebalance: 0.87621238
Triggering rebalance...
Health after rebalance: 1.12294708

======================================================================
| POSITION STATE: After price = 0.90000000
======================================================================
| Position ID: 0
| Health Ratio: 1.12294708
======================================================================
| PRICES:
|   FLOW: 0.90000000 MOET
|   MOET: 1.00000000 (pegged)
======================================================================
| BALANCES:
|   MOET Debt: 32058.50071009 (BORROWED)
|   -> Value: 32058.50071009 MOET
|   FLOW Collateral: 50000.00000000
|   -> Value: 45000.00000000 MOET
======================================================================
| METRICS:
|   Effective Collateral: 36000.00000000 MOET
|   Utilization Rate: 89.05139000%
======================================================================


======================================================================
|== Stage 6: FLOW moons to 2.5
======================================================================


======================================================================
| [PRICE UPDATE] Setting FLOW price
|    Token Identifier: A.0000000000000003.FlowToken.Vault
|    New Price: 2.50000000 MOET
|    Previous Price: (not tracked - consider adding if needed)
|    Price update successful
======================================================================

Health before rebalance: 3.11929746
Triggering rebalance...
Health after rebalance: 1.30000000

======================================================================
| POSITION STATE: After price = 2.50000000
======================================================================
| Position ID: 0
| Health Ratio: 1.30000000
======================================================================
| PRICES:
|   FLOW: 2.50000000 MOET
|   MOET: 1.00000000 (pegged)
======================================================================
| BALANCES:
|   MOET Debt: 76923.07692307 (BORROWED)
|   -> Value: 76923.07692307 MOET
|   FLOW Collateral: 50000.00000000
|   -> Value: 125000.00000000 MOET
======================================================================
| METRICS:
|   Effective Collateral: 100000.00000000 MOET
|   Utilization Rate: 76.92307600%
======================================================================


======================================================================
|== Stage 7: FLOW crashes to 0.3
======================================================================


======================================================================
| [PRICE UPDATE] Setting FLOW price
|    Token Identifier: A.0000000000000003.FlowToken.Vault
|    New Price: 0.30000000 MOET
|    Previous Price: (not tracked - consider adding if needed)
|    Price update successful
======================================================================

Health before rebalance: 0.15600000
Triggering rebalance...
Health after rebalance: 0.17441860

======================================================================
| POSITION STATE: After price = 0.30000000
======================================================================
| Position ID: 0
| Health Ratio: 0.17441860
======================================================================
| PRICES:
|   FLOW: 0.30000000 MOET
|   MOET: 1.00000000 (pegged)
======================================================================
| BALANCES:
|   MOET Debt: 68800.00000000 (BORROWED)
|   -> Value: 68800.00000000 MOET
|   FLOW Collateral: 50000.00000000
|   -> Value: 15000.00000000 MOET
======================================================================
| METRICS:
|   Effective Collateral: 12000.00000000 MOET
|   Utilization Rate: 573.33333300%
======================================================================


======================================================================
|== Stage 8: FLOW stabilizes at 1.0
======================================================================


======================================================================
| [PRICE UPDATE] Setting FLOW price
|    Token Identifier: A.0000000000000003.FlowToken.Vault
|    New Price: 1.00000000 MOET
|    Previous Price: (not tracked - consider adding if needed)
|    Price update successful
======================================================================

Health before rebalance: 0.58139534
Triggering rebalance...
Health after rebalance: 0.77232592

======================================================================
| POSITION STATE: After price = 1.00000000
======================================================================
| Position ID: 0
| Health Ratio: 0.77232592
======================================================================
| PRICES:
|   FLOW: 1.00000000 MOET
|   MOET: 1.00000000 (pegged)
======================================================================
| BALANCES:
|   MOET Debt: 51791.60568048 (BORROWED)
|   -> Value: 51791.60568048 MOET
|   FLOW Collateral: 50000.00000000
|   -> Value: 50000.00000000 MOET
======================================================================
| METRICS:
|   Effective Collateral: 40000.00000000 MOET
|   Utilization Rate: 129.47901400%
======================================================================

Test results: "./cadence/tests/price_scenario_test.cdc"
- PASS: testExtremePriceMovements
- PASS: testGradualPriceChanges
- PASS: testVolatilePriceSwings
Coverage: 74.9% of statements

[2/10] Testing edge cases (zero, micro, extreme prices)...

======================================================================
|== AUTO-BORROW SCENARIO: Edge Prices - Auto-Borrow
======================================================================


======================================================================
| [PRICE UPDATE] Setting FLOW price
|    Token Identifier: A.0000000000000003.FlowToken.Vault
|    New Price: 1.00000000 MOET
|    Previous Price: (not tracked - consider adding if needed)
|    Price update successful
======================================================================


======================================================================
| [PRICE UPDATE] Setting MOET price
|    Token Identifier: A.0000000000000008.MOET.Vault
|    New Price: 1.00000000 MOET
|    Previous Price: (not tracked - consider adding if needed)
|    Price update successful
======================================================================

Creating position with 1000 FLOW...
Initial position health: 1.30000000

======================================================================
|== Stage 0: Zero
======================================================================


======================================================================
| [PRICE UPDATE] Setting FLOW price
|    Token Identifier: A.0000000000000003.FlowToken.Vault
|    New Price: 0.00000000 MOET
|    Previous Price: (not tracked - consider adding if needed)
|    Price update successful
======================================================================

Health before rebalance: 0.00000000
Triggering rebalance...
Health after rebalance: 1.00000000

======================================================================
| POSITION STATE: After price = 0.00000000
======================================================================
| Position ID: 0
| Health Ratio: 1.00000000
======================================================================
| PRICES:
|   FLOW: 0.00000000 MOET
|   MOET: 1.00000000 (pegged)
======================================================================
| BALANCES:
|   MOET Debt: 0.00000000 (DEPOSITED)
|   -> Value: 0.00000000 MOET
|   FLOW Collateral: 1000.00000000
|   -> Value: 0.00000000 MOET
======================================================================
| METRICS:
|   Effective Collateral: 0.00000000 MOET
|   Utilization Rate: 0.00000000%
======================================================================


======================================================================
|== Stage 1: Micro
======================================================================


======================================================================
| [PRICE UPDATE] Setting FLOW price
|    Token Identifier: A.0000000000000003.FlowToken.Vault
|    New Price: 0.00000001 MOET
|    Previous Price: (not tracked - consider adding if needed)
|    Price update successful
======================================================================

Health before rebalance: 1.00000000
Triggering rebalance...
Health after rebalance: 1.30081300

======================================================================
| POSITION STATE: After price = 0.00000001
======================================================================
| Position ID: 0
| Health Ratio: 1.30081300
======================================================================
| PRICES:
|   FLOW: 0.00000001 MOET
|   MOET: 1.00000000 (pegged)
======================================================================
| BALANCES:
|   MOET Debt: 0.00000615 (BORROWED)
|   -> Value: 0.00000615 MOET
|   FLOW Collateral: 1000.00000000
|   -> Value: 0.00001000 MOET
======================================================================
| METRICS:
|   Effective Collateral: 0.00000800 MOET
|   Utilization Rate: 76.87500000%
======================================================================


======================================================================
|== Stage 2: VeryHigh
======================================================================


======================================================================
| [PRICE UPDATE] Setting FLOW price
|    Token Identifier: A.0000000000000003.FlowToken.Vault
|    New Price: 1000.00000000 MOET
|    Previous Price: (not tracked - consider adding if needed)
|    Price update successful
======================================================================

Health before rebalance: 130081300813.00813008
Triggering rebalance...
Health after rebalance: 1.30000000

======================================================================
| POSITION STATE: After price = 1000.00000000
======================================================================
| Position ID: 0
| Health Ratio: 1.30000000
======================================================================
| PRICES:
|   FLOW: 1000.00000000 MOET
|   MOET: 1.00000000 (pegged)
======================================================================
| BALANCES:
|   MOET Debt: 615384.61538461 (BORROWED)
|   -> Value: 615384.61538461 MOET
|   FLOW Collateral: 1000.00000000
|   -> Value: 1000000.00000000 MOET
======================================================================
| METRICS:
|   Effective Collateral: 800000.00000000 MOET
|   Utilization Rate: 76.92307600%
======================================================================


Generated test file: ./cadence/tests/generated_price_test.cdc
Running auto-borrow test with 3 price points...
Scenario: Edge Prices
Prices: [0.0, 1e-08, 1000.0]


Test results: "./cadence/tests/generated_price_test.cdc"
- PASS: testCustomPriceScenario
Coverage: 58.4% of statements



[3/10] Testing price extremes (0.001 to 500x)...

======================================================================
|== AUTO-BORROW SCENARIO: Price Extremes - Auto-Borrow
======================================================================


======================================================================
| [PRICE UPDATE] Setting FLOW price
|    Token Identifier: A.0000000000000003.FlowToken.Vault
|    New Price: 1.00000000 MOET
|    Previous Price: (not tracked - consider adding if needed)
|    Price update successful
======================================================================


======================================================================
| [PRICE UPDATE] Setting MOET price
|    Token Identifier: A.0000000000000008.MOET.Vault
|    New Price: 1.00000000 MOET
|    Previous Price: (not tracked - consider adding if needed)
|    Price update successful
======================================================================

Creating position with 1000 FLOW...
Initial position health: 1.30000000

======================================================================
|== Stage 0: VeryLow
======================================================================


======================================================================
| [PRICE UPDATE] Setting FLOW price
|    Token Identifier: A.0000000000000003.FlowToken.Vault
|    New Price: 0.00100000 MOET
|    Previous Price: (not tracked - consider adding if needed)
|    Price update successful
======================================================================

Health before rebalance: 0.00130000
Triggering rebalance...
Health after rebalance: 0.00130129

======================================================================
| POSITION STATE: After price = 0.00100000
======================================================================
| Position ID: 0
| Health Ratio: 0.00130129
======================================================================
| PRICES:
|   FLOW: 0.00100000 MOET
|   MOET: 1.00000000 (pegged)
======================================================================
| BALANCES:
|   MOET Debt: 614.76984615 (BORROWED)
|   -> Value: 614.76984615 MOET
|   FLOW Collateral: 1000.00000000
|   -> Value: 1.00000000 MOET
======================================================================
| METRICS:
|   Effective Collateral: 0.80000000 MOET
|   Utilization Rate: 76846.23076800%
======================================================================


======================================================================
|== Stage 1: 10x
======================================================================


======================================================================
| [PRICE UPDATE] Setting FLOW price
|    Token Identifier: A.0000000000000003.FlowToken.Vault
|    New Price: 10.00000000 MOET
|    Previous Price: (not tracked - consider adding if needed)
|    Price update successful
======================================================================

Health before rebalance: 13.01299998
Triggering rebalance...
Health after rebalance: 1.30000000

======================================================================
| POSITION STATE: After price = 10.00000000
======================================================================
| Position ID: 0
| Health Ratio: 1.30000000
======================================================================
| PRICES:
|   FLOW: 10.00000000 MOET
|   MOET: 1.00000000 (pegged)
======================================================================
| BALANCES:
|   MOET Debt: 6153.84615384 (BORROWED)
|   -> Value: 6153.84615384 MOET
|   FLOW Collateral: 1000.00000000
|   -> Value: 10000.00000000 MOET
======================================================================
| METRICS:
|   Effective Collateral: 8000.00000000 MOET
|   Utilization Rate: 76.92307600%
======================================================================


======================================================================
|== Stage 2: 100x
======================================================================


======================================================================
| [PRICE UPDATE] Setting FLOW price
|    Token Identifier: A.0000000000000003.FlowToken.Vault
|    New Price: 100.00000000 MOET
|    Previous Price: (not tracked - consider adding if needed)
|    Price update successful
======================================================================

Health before rebalance: 13.00000000
Triggering rebalance...
Health after rebalance: 1.30000000

======================================================================
| POSITION STATE: After price = 100.00000000
======================================================================
| Position ID: 0
| Health Ratio: 1.30000000
======================================================================
| PRICES:
|   FLOW: 100.00000000 MOET
|   MOET: 1.00000000 (pegged)
======================================================================
| BALANCES:
|   MOET Debt: 61538.46153846 (BORROWED)
|   -> Value: 61538.46153846 MOET
|   FLOW Collateral: 1000.00000000
|   -> Value: 100000.00000000 MOET
======================================================================
| METRICS:
|   Effective Collateral: 80000.00000000 MOET
|   Utilization Rate: 76.92307600%
======================================================================


======================================================================
|== Stage 3: 500x
======================================================================


======================================================================
| [PRICE UPDATE] Setting FLOW price
|    Token Identifier: A.0000000000000003.FlowToken.Vault
|    New Price: 500.00000000 MOET
|    Previous Price: (not tracked - consider adding if needed)
|    Price update successful
======================================================================

Health before rebalance: 6.50000000
Triggering rebalance...
Health after rebalance: 1.30000000

======================================================================
| POSITION STATE: After price = 500.00000000
======================================================================
| Position ID: 0
| Health Ratio: 1.30000000
======================================================================
| PRICES:
|   FLOW: 500.00000000 MOET
|   MOET: 1.00000000 (pegged)
======================================================================
| BALANCES:
|   MOET Debt: 307692.30769230 (BORROWED)
|   -> Value: 307692.30769230 MOET
|   FLOW Collateral: 1000.00000000
|   -> Value: 500000.00000000 MOET
======================================================================
| METRICS:
|   Effective Collateral: 400000.00000000 MOET
|   Utilization Rate: 76.92307600%
======================================================================


Generated test file: ./cadence/tests/generated_price_test.cdc
Running auto-borrow test with 4 price points...
Scenario: Price Extremes
Prices: [0.001, 10.0, 100.0, 500.0]


Test results: "./cadence/tests/generated_price_test.cdc"
- PASS: testCustomPriceScenario
Coverage: 57.8% of statements



[4/10] Testing rapid oscillations...

======================================================================
|== AUTO-BORROW SCENARIO: Rapid Oscillations - Auto-Borrow
======================================================================


======================================================================
| [PRICE UPDATE] Setting FLOW price
|    Token Identifier: A.0000000000000003.FlowToken.Vault
|    New Price: 1.00000000 MOET
|    Previous Price: (not tracked - consider adding if needed)
|    Price update successful
======================================================================


======================================================================
| [PRICE UPDATE] Setting MOET price
|    Token Identifier: A.0000000000000008.MOET.Vault
|    New Price: 1.00000000 MOET
|    Previous Price: (not tracked - consider adding if needed)
|    Price update successful
======================================================================

Creating position with 1000 FLOW...
Initial position health: 1.30000000

======================================================================
|== Stage 0: Start
======================================================================


======================================================================
| [PRICE UPDATE] Setting FLOW price
|    Token Identifier: A.0000000000000003.FlowToken.Vault
|    New Price: 1.00000000 MOET
|    Previous Price: (not tracked - consider adding if needed)
|    Price update successful
======================================================================

Health before rebalance: 1.30000000
Triggering rebalance...
Health after rebalance: 1.30000000

======================================================================
| POSITION STATE: After price = 1.00000000
======================================================================
| Position ID: 0
| Health Ratio: 1.30000000
======================================================================
| PRICES:
|   FLOW: 1.00000000 MOET
|   MOET: 1.00000000 (pegged)
======================================================================
| BALANCES:
|   MOET Debt: 615.38461538 (BORROWED)
|   -> Value: 615.38461538 MOET
|   FLOW Collateral: 1000.00000000
|   -> Value: 1000.00000000 MOET
======================================================================
| METRICS:
|   Effective Collateral: 800.00000000 MOET
|   Utilization Rate: 76.92307600%
======================================================================


======================================================================
|== Stage 1: 2x
======================================================================


======================================================================
| [PRICE UPDATE] Setting FLOW price
|    Token Identifier: A.0000000000000003.FlowToken.Vault
|    New Price: 2.00000000 MOET
|    Previous Price: (not tracked - consider adding if needed)
|    Price update successful
======================================================================

Health before rebalance: 2.60000000
Triggering rebalance...
Health after rebalance: 1.30000000

======================================================================
| POSITION STATE: After price = 2.00000000
======================================================================
| Position ID: 0
| Health Ratio: 1.30000000
======================================================================
| PRICES:
|   FLOW: 2.00000000 MOET
|   MOET: 1.00000000 (pegged)
======================================================================
| BALANCES:
|   MOET Debt: 1230.76923076 (BORROWED)
|   -> Value: 1230.76923076 MOET
|   FLOW Collateral: 1000.00000000
|   -> Value: 2000.00000000 MOET
======================================================================
| METRICS:
|   Effective Collateral: 1600.00000000 MOET
|   Utilization Rate: 76.92307600%
======================================================================


======================================================================
|== Stage 2: Drop50%
======================================================================


======================================================================
| [PRICE UPDATE] Setting FLOW price
|    Token Identifier: A.0000000000000003.FlowToken.Vault
|    New Price: 0.50000000 MOET
|    Previous Price: (not tracked - consider adding if needed)
|    Price update successful
======================================================================

Health before rebalance: 0.32500000
Triggering rebalance...
Health after rebalance: 0.40000000

======================================================================
| POSITION STATE: After price = 0.50000000
======================================================================
| Position ID: 0
| Health Ratio: 0.40000000
======================================================================
| PRICES:
|   FLOW: 0.50000000 MOET
|   MOET: 1.00000000 (pegged)
======================================================================
| BALANCES:
|   MOET Debt: 1000.00000000 (BORROWED)
|   -> Value: 1000.00000000 MOET
|   FLOW Collateral: 1000.00000000
|   -> Value: 500.00000000 MOET
======================================================================
| METRICS:
|   Effective Collateral: 400.00000000 MOET
|   Utilization Rate: 250.00000000%
======================================================================


======================================================================
|== Stage 3: 3x
======================================================================


======================================================================
| [PRICE UPDATE] Setting FLOW price
|    Token Identifier: A.0000000000000003.FlowToken.Vault
|    New Price: 3.00000000 MOET
|    Previous Price: (not tracked - consider adding if needed)
|    Price update successful
======================================================================

Health before rebalance: 2.40000000
Triggering rebalance...
Health after rebalance: 1.30000000

======================================================================
| POSITION STATE: After price = 3.00000000
======================================================================
| Position ID: 0
| Health Ratio: 1.30000000
======================================================================
| PRICES:
|   FLOW: 3.00000000 MOET
|   MOET: 1.00000000 (pegged)
======================================================================
| BALANCES:
|   MOET Debt: 1846.15384615 (BORROWED)
|   -> Value: 1846.15384615 MOET
|   FLOW Collateral: 1000.00000000
|   -> Value: 3000.00000000 MOET
======================================================================
| METRICS:
|   Effective Collateral: 2400.00000000 MOET
|   Utilization Rate: 76.92307600%
======================================================================


======================================================================
|== Stage 4: Crash70%
======================================================================


======================================================================
| [PRICE UPDATE] Setting FLOW price
|    Token Identifier: A.0000000000000003.FlowToken.Vault
|    New Price: 0.30000000 MOET
|    Previous Price: (not tracked - consider adding if needed)
|    Price update successful
======================================================================

Health before rebalance: 0.13000000
Triggering rebalance...
Health after rebalance: 0.14285714

======================================================================
| POSITION STATE: After price = 0.30000000
======================================================================
| Position ID: 0
| Health Ratio: 0.14285714
======================================================================
| PRICES:
|   FLOW: 0.30000000 MOET
|   MOET: 1.00000000 (pegged)
======================================================================
| BALANCES:
|   MOET Debt: 1680.00000000 (BORROWED)
|   -> Value: 1680.00000000 MOET
|   FLOW Collateral: 1000.00000000
|   -> Value: 300.00000000 MOET
======================================================================
| METRICS:
|   Effective Collateral: 240.00000000 MOET
|   Utilization Rate: 700.00000000%
======================================================================


======================================================================
|== Stage 5: Recover1.5x
======================================================================


======================================================================
| [PRICE UPDATE] Setting FLOW price
|    Token Identifier: A.0000000000000003.FlowToken.Vault
|    New Price: 1.50000000 MOET
|    Previous Price: (not tracked - consider adding if needed)
|    Price update successful
======================================================================

Health before rebalance: 0.71428571
Triggering rebalance...
Health after rebalance: 0.94928583

======================================================================
| POSITION STATE: After price = 1.50000000
======================================================================
| Position ID: 0
| Health Ratio: 0.94928583
======================================================================
| PRICES:
|   FLOW: 1.50000000 MOET
|   MOET: 1.00000000 (pegged)
======================================================================
| BALANCES:
|   MOET Debt: 1264.10819645 (BORROWED)
|   -> Value: 1264.10819645 MOET
|   FLOW Collateral: 1000.00000000
|   -> Value: 1500.00000000 MOET
======================================================================
| METRICS:
|   Effective Collateral: 1200.00000000 MOET
|   Utilization Rate: 105.34234900%
======================================================================


======================================================================
|== Stage 6: Drop20%
======================================================================


======================================================================
| [PRICE UPDATE] Setting FLOW price
|    Token Identifier: A.0000000000000003.FlowToken.Vault
|    New Price: 0.80000000 MOET
|    Previous Price: (not tracked - consider adding if needed)
|    Price update successful
======================================================================

Health before rebalance: 0.50628577
Triggering rebalance...
Health after rebalance: 0.66422424

======================================================================
| POSITION STATE: After price = 0.80000000
======================================================================
| Position ID: 0
| Health Ratio: 0.66422424
======================================================================
| PRICES:
|   FLOW: 0.80000000 MOET
|   MOET: 1.00000000 (pegged)
======================================================================
| BALANCES:
|   MOET Debt: 963.53002651 (BORROWED)
|   -> Value: 963.53002651 MOET
|   FLOW Collateral: 1000.00000000
|   -> Value: 800.00000000 MOET
======================================================================
| METRICS:
|   Effective Collateral: 640.00000000 MOET
|   Utilization Rate: 150.55156600%
======================================================================


======================================================================
|== Stage 7: 2.5x
======================================================================


======================================================================
| [PRICE UPDATE] Setting FLOW price
|    Token Identifier: A.0000000000000003.FlowToken.Vault
|    New Price: 2.50000000 MOET
|    Previous Price: (not tracked - consider adding if needed)
|    Price update successful
======================================================================

Health before rebalance: 2.07570075
Triggering rebalance...
Health after rebalance: 1.30000000

======================================================================
| POSITION STATE: After price = 2.50000000
======================================================================
| Position ID: 0
| Health Ratio: 1.30000000
======================================================================
| PRICES:
|   FLOW: 2.50000000 MOET
|   MOET: 1.00000000 (pegged)
======================================================================
| BALANCES:
|   MOET Debt: 1538.46153846 (BORROWED)
|   -> Value: 1538.46153846 MOET
|   FLOW Collateral: 1000.00000000
|   -> Value: 2500.00000000 MOET
======================================================================
| METRICS:
|   Effective Collateral: 2000.00000000 MOET
|   Utilization Rate: 76.92307600%
======================================================================


======================================================================
|== Stage 8: Stabilize
======================================================================


======================================================================
| [PRICE UPDATE] Setting FLOW price
|    Token Identifier: A.0000000000000003.FlowToken.Vault
|    New Price: 1.00000000 MOET
|    Previous Price: (not tracked - consider adding if needed)
|    Price update successful
======================================================================

Health before rebalance: 0.52000000
Triggering rebalance...
Health after rebalance: 0.68421052

======================================================================
| POSITION STATE: After price = 1.00000000
======================================================================
| Position ID: 0
| Health Ratio: 0.68421052
======================================================================
| PRICES:
|   FLOW: 1.00000000 MOET
|   MOET: 1.00000000 (pegged)
======================================================================
| BALANCES:
|   MOET Debt: 1169.23076923 (BORROWED)
|   -> Value: 1169.23076923 MOET
|   FLOW Collateral: 1000.00000000
|   -> Value: 1000.00000000 MOET
======================================================================
| METRICS:
|   Effective Collateral: 800.00000000 MOET
|   Utilization Rate: 146.15384600%
======================================================================


Generated test file: ./cadence/tests/generated_price_test.cdc
Running auto-borrow test with 9 price points...
Scenario: Rapid Oscillations
Prices: [1.0, 2.0, 0.5, 3.0, 0.3, 1.5, 0.8, 2.5, 1.0]


Test results: "./cadence/tests/generated_price_test.cdc"
- PASS: testCustomPriceScenario
Coverage: 59.2% of statements



[5/10] Testing black swan event (99% crash)...

======================================================================
|== AUTO-BORROW SCENARIO: Black Swan Event - Auto-Borrow
======================================================================


======================================================================
| [PRICE UPDATE] Setting FLOW price
|    Token Identifier: A.0000000000000003.FlowToken.Vault
|    New Price: 1.00000000 MOET
|    Previous Price: (not tracked - consider adding if needed)
|    Price update successful
======================================================================


======================================================================
| [PRICE UPDATE] Setting MOET price
|    Token Identifier: A.0000000000000008.MOET.Vault
|    New Price: 1.00000000 MOET
|    Previous Price: (not tracked - consider adding if needed)
|    Price update successful
======================================================================

Creating position with 1000 FLOW...
Initial position health: 1.30000000

======================================================================
|== Stage 0: Normal
======================================================================


======================================================================
| [PRICE UPDATE] Setting FLOW price
|    Token Identifier: A.0000000000000003.FlowToken.Vault
|    New Price: 1.00000000 MOET
|    Previous Price: (not tracked - consider adding if needed)
|    Price update successful
======================================================================

Health before rebalance: 1.30000000
Triggering rebalance...
Health after rebalance: 1.30000000

======================================================================
| POSITION STATE: After price = 1.00000000
======================================================================
| Position ID: 0
| Health Ratio: 1.30000000
======================================================================
| PRICES:
|   FLOW: 1.00000000 MOET
|   MOET: 1.00000000 (pegged)
======================================================================
| BALANCES:
|   MOET Debt: 615.38461538 (BORROWED)
|   -> Value: 615.38461538 MOET
|   FLOW Collateral: 1000.00000000
|   -> Value: 1000.00000000 MOET
======================================================================
| METRICS:
|   Effective Collateral: 800.00000000 MOET
|   Utilization Rate: 76.92307600%
======================================================================


======================================================================
|== Stage 1: Crash95%
======================================================================


======================================================================
| [PRICE UPDATE] Setting FLOW price
|    Token Identifier: A.0000000000000003.FlowToken.Vault
|    New Price: 0.05000000 MOET
|    Previous Price: (not tracked - consider adding if needed)
|    Price update successful
======================================================================

Health before rebalance: 0.06500000
Triggering rebalance...
Health after rebalance: 0.06824146

======================================================================
| POSITION STATE: After price = 0.05000000
======================================================================
| Position ID: 0
| Health Ratio: 0.06824146
======================================================================
| PRICES:
|   FLOW: 0.05000000 MOET
|   MOET: 1.00000000 (pegged)
======================================================================
| BALANCES:
|   MOET Debt: 586.15384615 (BORROWED)
|   -> Value: 586.15384615 MOET
|   FLOW Collateral: 1000.00000000
|   -> Value: 50.00000000 MOET
======================================================================
| METRICS:
|   Effective Collateral: 40.00000000 MOET
|   Utilization Rate: 1465.38461500%
======================================================================


======================================================================
|== Stage 2: Crash99%
======================================================================


======================================================================
| [PRICE UPDATE] Setting FLOW price
|    Token Identifier: A.0000000000000003.FlowToken.Vault
|    New Price: 0.01000000 MOET
|    Previous Price: (not tracked - consider adding if needed)
|    Price update successful
======================================================================

Health before rebalance: 0.01364829
Triggering rebalance...
Health after rebalance: 0.01379156

======================================================================
| POSITION STATE: After price = 0.01000000
======================================================================
| Position ID: 0
| Health Ratio: 0.01379156
======================================================================
| PRICES:
|   FLOW: 0.01000000 MOET
|   MOET: 1.00000000 (pegged)
======================================================================
| BALANCES:
|   MOET Debt: 580.06460729 (BORROWED)
|   -> Value: 580.06460729 MOET
|   FLOW Collateral: 1000.00000000
|   -> Value: 10.00000000 MOET
======================================================================
| METRICS:
|   Effective Collateral: 8.00000000 MOET
|   Utilization Rate: 7250.80759100%
======================================================================


======================================================================
|== Stage 3: Recovery50%
======================================================================


======================================================================
| [PRICE UPDATE] Setting FLOW price
|    Token Identifier: A.0000000000000003.FlowToken.Vault
|    New Price: 0.50000000 MOET
|    Previous Price: (not tracked - consider adding if needed)
|    Price update successful
======================================================================

Health before rebalance: 0.68957835
Triggering rebalance...
Health after rebalance: 0.91830292

======================================================================
| POSITION STATE: After price = 0.50000000
======================================================================
| Position ID: 0
| Health Ratio: 0.91830292
======================================================================
| PRICES:
|   FLOW: 0.50000000 MOET
|   MOET: 1.00000000 (pegged)
======================================================================
| BALANCES:
|   MOET Debt: 435.58611025 (BORROWED)
|   -> Value: 435.58611025 MOET
|   FLOW Collateral: 1000.00000000
|   -> Value: 500.00000000 MOET
======================================================================
| METRICS:
|   Effective Collateral: 400.00000000 MOET
|   Utilization Rate: 108.89652700%
======================================================================


======================================================================
|== Stage 4: FullRecovery
======================================================================


======================================================================
| [PRICE UPDATE] Setting FLOW price
|    Token Identifier: A.0000000000000003.FlowToken.Vault
|    New Price: 1.00000000 MOET
|    Previous Price: (not tracked - consider adding if needed)
|    Price update successful
======================================================================

Health before rebalance: 1.83660585
Triggering rebalance...
Health after rebalance: 1.30000000

======================================================================
| POSITION STATE: After price = 1.00000000
======================================================================
| Position ID: 0
| Health Ratio: 1.30000000
======================================================================
| PRICES:
|   FLOW: 1.00000000 MOET
|   MOET: 1.00000000 (pegged)
======================================================================
| BALANCES:
|   MOET Debt: 615.38461538 (BORROWED)
|   -> Value: 615.38461538 MOET
|   FLOW Collateral: 1000.00000000
|   -> Value: 1000.00000000 MOET
======================================================================
| METRICS:
|   Effective Collateral: 800.00000000 MOET
|   Utilization Rate: 76.92307600%
======================================================================


======================================================================
|== Stage 5: Overshoot
======================================================================


======================================================================
| [PRICE UPDATE] Setting FLOW price
|    Token Identifier: A.0000000000000003.FlowToken.Vault
|    New Price: 1.50000000 MOET
|    Previous Price: (not tracked - consider adding if needed)
|    Price update successful
======================================================================

Health before rebalance: 1.95000000
Triggering rebalance...
Health after rebalance: 1.30000000

======================================================================
| POSITION STATE: After price = 1.50000000
======================================================================
| Position ID: 0
| Health Ratio: 1.30000000
======================================================================
| PRICES:
|   FLOW: 1.50000000 MOET
|   MOET: 1.00000000 (pegged)
======================================================================
| BALANCES:
|   MOET Debt: 923.07692307 (BORROWED)
|   -> Value: 923.07692307 MOET
|   FLOW Collateral: 1000.00000000
|   -> Value: 1500.00000000 MOET
======================================================================
| METRICS:
|   Effective Collateral: 1200.00000000 MOET
|   Utilization Rate: 76.92307600%
======================================================================


Generated test file: ./cadence/tests/generated_price_test.cdc
Running auto-borrow test with 6 price points...
Scenario: Black Swan Event
Prices: [1.0, 0.05, 0.01, 0.5, 1.0, 1.5]


Test results: "./cadence/tests/generated_price_test.cdc"
- PASS: testCustomPriceScenario
Coverage: 58.4% of statements



[6/10] Testing MOET depeg scenario...

======================================================================
|== MOET DEPEG SCENARIO TEST
======================================================================


======================================================================
| [PRICE UPDATE] Setting FLOW price
|    Token Identifier: A.0000000000000003.FlowToken.Vault
|    New Price: 1.00000000 MOET
|    Previous Price: (not tracked - consider adding if needed)
|    Price update successful
======================================================================


======================================================================
| [PRICE UPDATE] Setting MOET price
|    Token Identifier: A.0000000000000008.MOET.Vault
|    New Price: 1.00000000 MOET
|    Previous Price: (not tracked - consider adding if needed)
|    Price update successful
======================================================================

Creating position with 1000 FLOW...

======================================================================
|== Stage 1: MOET loses peg - drops to 0.5
======================================================================


======================================================================
| [PRICE UPDATE] Setting MOET price
|    Token Identifier: A.0000000000000008.MOET.Vault
|    New Price: 0.50000000 MOET
|    Previous Price: (not tracked - consider adding if needed)
|    Price update successful
======================================================================

Health before rebalance: 1.30000000
Health after rebalance: 1.30000000
OBSERVATION: When MOET depegs, the position health should improve because debt is denominated in MOET

======================================================================
|== Stage 2: FLOW also drops to 0.5
======================================================================


======================================================================
| [PRICE UPDATE] Setting FLOW price
|    Token Identifier: A.0000000000000003.FlowToken.Vault
|    New Price: 0.50000000 MOET
|    Previous Price: (not tracked - consider adding if needed)
|    Price update successful
======================================================================

Health before rebalance: 0.65000000
Health after rebalance: 0.86666666
OBSERVATION: With both tokens at 0.5, position should be similar to original state

======================================================================
|== Stage 3: MOET crashes to 0.1 while FLOW stays at 0.5
======================================================================


======================================================================
| [PRICE UPDATE] Setting MOET price
|    Token Identifier: A.0000000000000008.MOET.Vault
|    New Price: 0.10000000 MOET
|    Previous Price: (not tracked - consider adding if needed)
|    Price update successful
======================================================================

Health before rebalance: 0.86666666
OBSERVATION: Extreme MOET crash should make debt very cheap, improving health dramatically
Health after rebalance: 1.11428571

======================================================================
| POSITION STATE: After extreme MOET depeg
======================================================================
| Position ID: 0
| Health Ratio: 1.11428571
======================================================================
| PRICES:
|   FLOW: 0.50000000 MOET
|   MOET: 0.10000000 (DEPEGGED)
======================================================================
| BALANCES:
|   MOET Debt: 358.97435740 (BORROWED)
|   -> Value: 358.97435740 MOET
|   FLOW Collateral: 1000.00000000
|   -> Value: 50.00000000 MOET
======================================================================
| METRICS:
|   Effective Collateral: 40.00000000 MOET
|   Utilization Rate: 897.43589300%
======================================================================

Test results: "cadence/tests/moet_depeg_test.cdc"
- PASS: testMOETDepegScenario

[7/10] Testing concurrent rebalancing...

======================================================================
|== CONCURRENT REBALANCING TEST
======================================================================


======================================================================
| [PRICE UPDATE] Setting FLOW price
|    Token Identifier: A.0000000000000003.FlowToken.Vault
|    New Price: 1.00000000 MOET
|    Previous Price: (not tracked - consider adding if needed)
|    Price update successful
======================================================================


======================================================================
| [PRICE UPDATE] Setting MOET price
|    Token Identifier: A.0000000000000008.MOET.Vault
|    New Price: 1.00000000 MOET
|    Previous Price: (not tracked - consider adding if needed)
|    Price update successful
======================================================================

Creating position with 1000 FLOW...
Initial health: 1.30000000

======================================================================
|== Rapid price changes and rebalancing
======================================================================


Quick change #0: FLOW = 0.80000000

======================================================================
| [PRICE UPDATE] Setting FLOW price
|    Token Identifier: A.0000000000000003.FlowToken.Vault
|    New Price: 0.80000000 MOET
|    Previous Price: (not tracked - consider adding if needed)
|    Price update successful
======================================================================

Health: 1.04000000
Double rebalance attempt...
Health after 1st rebalance: 1.23809523
Health after 2nd rebalance: 1.29691212

Quick change #1: FLOW = 1.20000000

======================================================================
| [PRICE UPDATE] Setting FLOW price
|    Token Identifier: A.0000000000000003.FlowToken.Vault
|    New Price: 1.20000000 MOET
|    Previous Price: (not tracked - consider adding if needed)
|    Price update successful
======================================================================

Health: 1.94536818
Health after rebalance: 1.30000000

Quick change #2: FLOW = 0.90000000

======================================================================
| [PRICE UPDATE] Setting FLOW price
|    Token Identifier: A.0000000000000003.FlowToken.Vault
|    New Price: 0.90000000 MOET
|    Previous Price: (not tracked - consider adding if needed)
|    Price update successful
======================================================================

Health: 0.97500000
Double rebalance attempt...
Health after 1st rebalance: 1.20000000
Health after 2nd rebalance: 1.29171974

Quick change #3: FLOW = 1.10000000

======================================================================
| [PRICE UPDATE] Setting FLOW price
|    Token Identifier: A.0000000000000003.FlowToken.Vault
|    New Price: 1.10000000 MOET
|    Previous Price: (not tracked - consider adding if needed)
|    Price update successful
======================================================================

Health: 1.57876857
Health after rebalance: 1.30000000

Quick change #4: FLOW = 0.70000000

======================================================================
| [PRICE UPDATE] Setting FLOW price
|    Token Identifier: A.0000000000000003.FlowToken.Vault
|    New Price: 0.70000000 MOET
|    Previous Price: (not tracked - consider adding if needed)
|    Price update successful
======================================================================

Health: 0.82727272
Double rebalance attempt...
Health after 1st rebalance: 1.07634409
Health after 2nd rebalance: 1.25513010

Quick change #5: FLOW = 1.30000000

======================================================================
| [PRICE UPDATE] Setting FLOW price
|    Token Identifier: A.0000000000000003.FlowToken.Vault
|    New Price: 1.30000000 MOET
|    Previous Price: (not tracked - consider adding if needed)
|    Price update successful
======================================================================

Health: 2.33095591
Health after rebalance: 1.30000000

======================================================================
|== Final State
======================================================================


======================================================================
| POSITION STATE: After rapid changes
======================================================================
| Position ID: 0
| Health Ratio: 1.30000000
======================================================================
| PRICES:
|   FLOW: 0.50000000 MOET
|   MOET: 1.00000000 (pegged)
======================================================================
| BALANCES:
|   MOET Debt: 800.00000000 (BORROWED)
|   -> Value: 800.00000000 MOET
|   FLOW Collateral: 1000.00000000
|   -> Value: 500.00000000 MOET
======================================================================
| METRICS:
|   Effective Collateral: 400.00000000 MOET
|   Utilization Rate: 200.00000000%
======================================================================

Checking final position state...
Final health: 1.30000000
Test results: "cadence/tests/concurrent_rebalance_test.cdc"
- PASS: testConcurrentRebalancing

[8/10] Testing mixed scenario (auto-borrow + auto-balancer simultaneous)...

======================================================================
|== MIXED SCENARIO: Auto-Borrow + Auto-Balancer Simultaneous
======================================================================

Creating auto-borrow position with 1000 FLOW...
Creating auto-balancer Tide with 1000 FLOW...

======================================================================
|== Stage 0: Baseline
======================================================================


======================================================================
| [PRICE UPDATE] Setting FLOW price
|    Token Identifier: A.0000000000000003.FlowToken.Vault
|    New Price: 1.00000000 MOET
|    Previous Price: (not tracked - consider adding if needed)
|    Price update successful
======================================================================


======================================================================
| [PRICE UPDATE] Setting YieldToken price
|    Token Identifier: A.0000000000000010.YieldToken.Vault
|    New Price: 1.00000000 MOET
|    Previous Price: (not tracked - consider adding if needed)
|    Price update successful
======================================================================


==================== BEFORE REBALANCING ====================

======================================================================
| POSITION STATE: Before Rebalance
======================================================================
| Position ID: 0
| Health Ratio: 1.30000000
======================================================================
| PRICES:
|   FLOW: 1.00000000 MOET
|   MOET: 1.00000000 (pegged)
======================================================================
| BALANCES:
|   MOET Debt: 615.38461538 (BORROWED)
|   -> Value: 615.38461538 MOET
|   FLOW Collateral: 1000.00000000
|   -> Value: 1000.00000000 MOET
======================================================================
| METRICS:
|   Effective Collateral: 800.00000000 MOET
|   Utilization Rate: 76.92307600%
======================================================================

Auto-Borrow Health: 1.30000000

======================================================================
| AUTO-BALANCER STATE: Before Rebalance
======================================================================
| Tide ID: 0
| AutoBalancer ID: 0
======================================================================
| PRICES:
|   FLOW: 1.00000000 MOET
|   YieldToken: 1.00000000 MOET
|   MOET: 1.00000000 (pegged)
======================================================================
| HOLDINGS:
|   YieldToken Balance: 615.38461538
|   -> Value in MOET: 615.38461538
|   -> Value in USD: 615.38461538
======================================================================
| POSITION METRICS:
|   Initial FLOW Deposit: 1000.00000000
|   Initial Value: 1000.00000000 MOET
|   Expected MOET Borrowed: ~615.38461538
|   Expected YieldTokens: ~615.38461538
======================================================================
| PERFORMANCE:
|   Current/Expected Value: 100.00000000%
|   Status: WITHIN threshold (95-105%) - no rebalance needed
======================================================================

Auto-Balancer Balance: 615.38461538 YieldToken

Triggering simultaneous rebalances...

==================== AFTER REBALANCING ====================

======================================================================
| POSITION STATE: After Rebalance
======================================================================
| Position ID: 0
| Health Ratio: 1.30000000
======================================================================
| PRICES:
|   FLOW: 1.00000000 MOET
|   MOET: 1.00000000 (pegged)
======================================================================
| BALANCES:
|   MOET Debt: 615.38461538 (BORROWED)
|   -> Value: 615.38461538 MOET
|   FLOW Collateral: 1000.00000000
|   -> Value: 1000.00000000 MOET
======================================================================
| METRICS:
|   Effective Collateral: 800.00000000 MOET
|   Utilization Rate: 76.92307600%
======================================================================

Auto-Borrow Health: 1.30000000

======================================================================
| AUTO-BALANCER STATE: After Rebalance
======================================================================
| Tide ID: 0
| AutoBalancer ID: 0
======================================================================
| PRICES:
|   FLOW: 1.00000000 MOET
|   YieldToken: 1.00000000 MOET
|   MOET: 1.00000000 (pegged)
======================================================================
| HOLDINGS:
|   YieldToken Balance: 615.38461538
|   -> Value in MOET: 615.38461538
|   -> Value in USD: 615.38461538
======================================================================
| POSITION METRICS:
|   Initial FLOW Deposit: 1000.00000000
|   Initial Value: 1000.00000000 MOET
|   Expected MOET Borrowed: ~615.38461538
|   Expected YieldTokens: ~615.38461538
======================================================================
| PERFORMANCE:
|   Current/Expected Value: 100.00000000%
|   Status: WITHIN threshold (95-105%) - no rebalance needed
======================================================================

Auto-Balancer Balance: 615.38461538 YieldToken

----------------------------------------------------------------------
| STATE CHANGES AFTER: Rebalancing
----------------------------------------------------------------------
----------------------------------------------------------------------


======================================================================
|== Stage 1: FLOW crash, YieldToken rise
======================================================================


======================================================================
| [PRICE UPDATE] Setting FLOW price
|    Token Identifier: A.0000000000000003.FlowToken.Vault
|    New Price: 0.50000000 MOET
|    Previous Price: (not tracked - consider adding if needed)
|    Price update successful
======================================================================


======================================================================
| [PRICE UPDATE] Setting YieldToken price
|    Token Identifier: A.0000000000000010.YieldToken.Vault
|    New Price: 1.20000000 MOET
|    Previous Price: (not tracked - consider adding if needed)
|    Price update successful
======================================================================


==================== BEFORE REBALANCING ====================

======================================================================
| POSITION STATE: Before Rebalance
======================================================================
| Position ID: 0
| Health Ratio: 0.65000000
======================================================================
| PRICES:
|   FLOW: 0.50000000 MOET
|   MOET: 1.00000000 (pegged)
======================================================================
| BALANCES:
|   MOET Debt: 615.38461538 (BORROWED)
|   -> Value: 615.38461538 MOET
|   FLOW Collateral: 1000.00000000
|   -> Value: 500.00000000 MOET
======================================================================
| METRICS:
|   Effective Collateral: 400.00000000 MOET
|   Utilization Rate: 153.84615300%
======================================================================

Auto-Borrow Health: 0.65000000

======================================================================
| AUTO-BALANCER STATE: Before Rebalance
======================================================================
| Tide ID: 0
| AutoBalancer ID: 0
======================================================================
| PRICES:
|   FLOW: 0.50000000 MOET
|   YieldToken: 1.20000000 MOET
|   MOET: 1.00000000 (pegged)
======================================================================
| HOLDINGS:
|   YieldToken Balance: 615.38461538
|   -> Value in MOET: 738.46153845
|   -> Value in USD: 738.46153845
======================================================================
| POSITION METRICS:
|   Initial FLOW Deposit: 1000.00000000
|   Initial Value: 500.00000000 MOET
|   Expected MOET Borrowed: ~307.69230769
|   Expected YieldTokens: ~256.41025640
======================================================================
| PERFORMANCE:
|   Current/Expected Value: 239.99999900%
|   Status: ABOVE threshold (>105%) - should rebalance DOWN
======================================================================

Auto-Balancer Balance: 615.38461538 YieldToken

Triggering simultaneous rebalances...

==================== AFTER REBALANCING ====================

======================================================================
| POSITION STATE: After Rebalance
======================================================================
| Position ID: 0
| Health Ratio: 0.86666666
======================================================================
| PRICES:
|   FLOW: 0.50000000 MOET
|   MOET: 1.00000000 (pegged)
======================================================================
| BALANCES:
|   MOET Debt: 461.53846154 (BORROWED)
|   -> Value: 461.53846154 MOET
|   FLOW Collateral: 1000.00000000
|   -> Value: 500.00000000 MOET
======================================================================
| METRICS:
|   Effective Collateral: 400.00000000 MOET
|   Utilization Rate: 115.38461500%
======================================================================

Auto-Borrow Health: 0.86666666

======================================================================
| AUTO-BALANCER STATE: After Rebalance
======================================================================
| Tide ID: 0
| AutoBalancer ID: 0
======================================================================
| PRICES:
|   FLOW: 0.50000000 MOET
|   YieldToken: 1.20000000 MOET
|   MOET: 1.00000000 (pegged)
======================================================================
| HOLDINGS:
|   YieldToken Balance: 615.38461538
|   -> Value in MOET: 738.46153845
|   -> Value in USD: 738.46153845
======================================================================
| POSITION METRICS:
|   Initial FLOW Deposit: 1000.00000000
|   Initial Value: 500.00000000 MOET
|   Expected MOET Borrowed: ~307.69230769
|   Expected YieldTokens: ~256.41025640
======================================================================
| PERFORMANCE:
|   Current/Expected Value: 239.99999900%
|   Status: ABOVE threshold (>105%) - should rebalance DOWN
======================================================================

Auto-Balancer Balance: 615.38461538 YieldToken

----------------------------------------------------------------------
| STATE CHANGES AFTER: Rebalancing
----------------------------------------------------------------------
| Health: 0.65000000 -> 0.86666666 (+0.21666666)
| MOET Debt: 615.38461538 -> 461.53846154 (-153.84615384)
----------------------------------------------------------------------


======================================================================
|== Stage 2: FLOW rise, YieldToken drop
======================================================================


======================================================================
| [PRICE UPDATE] Setting FLOW price
|    Token Identifier: A.0000000000000003.FlowToken.Vault
|    New Price: 1.50000000 MOET
|    Previous Price: (not tracked - consider adding if needed)
|    Price update successful
======================================================================


======================================================================
| [PRICE UPDATE] Setting YieldToken price
|    Token Identifier: A.0000000000000010.YieldToken.Vault
|    New Price: 0.80000000 MOET
|    Previous Price: (not tracked - consider adding if needed)
|    Price update successful
======================================================================


==================== BEFORE REBALANCING ====================

======================================================================
| POSITION STATE: Before Rebalance
======================================================================
| Position ID: 0
| Health Ratio: 2.59999999
======================================================================
| PRICES:
|   FLOW: 1.50000000 MOET
|   MOET: 1.00000000 (pegged)
======================================================================
| BALANCES:
|   MOET Debt: 461.53846154 (BORROWED)
|   -> Value: 461.53846154 MOET
|   FLOW Collateral: 1000.00000000
|   -> Value: 1500.00000000 MOET
======================================================================
| METRICS:
|   Effective Collateral: 1200.00000000 MOET
|   Utilization Rate: 38.46153800%
======================================================================

Auto-Borrow Health: 2.59999999

======================================================================
| AUTO-BALANCER STATE: Before Rebalance
======================================================================
| Tide ID: 0
| AutoBalancer ID: 0
======================================================================
| PRICES:
|   FLOW: 1.50000000 MOET
|   YieldToken: 0.80000000 MOET
|   MOET: 1.00000000 (pegged)
======================================================================
| HOLDINGS:
|   YieldToken Balance: 615.38461538
|   -> Value in MOET: 492.30769230
|   -> Value in USD: 492.30769230
======================================================================
| POSITION METRICS:
|   Initial FLOW Deposit: 1000.00000000
|   Initial Value: 1500.00000000 MOET
|   Expected MOET Borrowed: ~923.07692307
|   Expected YieldTokens: ~1153.84615383
======================================================================
| PERFORMANCE:
|   Current/Expected Value: 53.33333300%
|   Status: BELOW threshold (<95%) - should rebalance UP
======================================================================

Auto-Balancer Balance: 615.38461538 YieldToken

Triggering simultaneous rebalances...

==================== AFTER REBALANCING ====================

======================================================================
| POSITION STATE: After Rebalance
======================================================================
| Position ID: 0
| Health Ratio: 1.30000000
======================================================================
| PRICES:
|   FLOW: 1.50000000 MOET
|   MOET: 1.00000000 (pegged)
======================================================================
| BALANCES:
|   MOET Debt: 923.07692307 (BORROWED)
|   -> Value: 923.07692307 MOET
|   FLOW Collateral: 1000.00000000
|   -> Value: 1500.00000000 MOET
======================================================================
| METRICS:
|   Effective Collateral: 1200.00000000 MOET
|   Utilization Rate: 76.92307600%
======================================================================

Auto-Borrow Health: 1.30000000

======================================================================
| AUTO-BALANCER STATE: After Rebalance
======================================================================
| Tide ID: 0
| AutoBalancer ID: 0
======================================================================
| PRICES:
|   FLOW: 1.50000000 MOET
|   YieldToken: 0.80000000 MOET
|   MOET: 1.00000000 (pegged)
======================================================================
| HOLDINGS:
|   YieldToken Balance: 940.82840175
|   -> Value in MOET: 752.66272140
|   -> Value in USD: 752.66272140
======================================================================
| POSITION METRICS:
|   Initial FLOW Deposit: 1000.00000000
|   Initial Value: 1500.00000000 MOET
|   Expected MOET Borrowed: ~923.07692307
|   Expected YieldTokens: ~1153.84615383
======================================================================
| PERFORMANCE:
|   Current/Expected Value: 81.53846100%
|   Status: BELOW threshold (<95%) - should rebalance UP
======================================================================

Auto-Balancer Balance: 940.82840175 YieldToken

----------------------------------------------------------------------
| STATE CHANGES AFTER: Rebalancing
----------------------------------------------------------------------
| Health: 2.59999999 -> 1.30000000 (-1.29999999)
| MOET Debt: 461.53846154 -> 923.07692307 (+461.53846153)
| YieldToken: 615.38461538 -> 940.82840175 (+325.44378637)
----------------------------------------------------------------------


======================================================================
|== Stage 3: Both crash (MOET slightly depegged)
======================================================================


======================================================================
| [PRICE UPDATE] Setting FLOW price
|    Token Identifier: A.0000000000000003.FlowToken.Vault
|    New Price: 0.30000000 MOET
|    Previous Price: (not tracked - consider adding if needed)
|    Price update successful
======================================================================


======================================================================
| [PRICE UPDATE] Setting YieldToken price
|    Token Identifier: A.0000000000000010.YieldToken.Vault
|    New Price: 0.50000000 MOET
|    Previous Price: (not tracked - consider adding if needed)
|    Price update successful
======================================================================


======================================================================
| [PRICE UPDATE] Setting MOET price
|    Token Identifier: A.0000000000000008.MOET.Vault
|    New Price: 0.95000000 MOET
|    Previous Price: (not tracked - consider adding if needed)
|    Price update successful
======================================================================


==================== BEFORE REBALANCING ====================

======================================================================
| POSITION STATE: Before Rebalance
======================================================================
| Position ID: 0
| Health Ratio: 0.26000000
======================================================================
| PRICES:
|   FLOW: 0.30000000 MOET
|   MOET: 0.95000000 (DEPEGGED)
======================================================================
| BALANCES:
|   MOET Debt: 923.07692307 (BORROWED)
|   -> Value: 923.07692307 MOET
|   FLOW Collateral: 1000.00000000
|   -> Value: 285.00000000 MOET
======================================================================
| METRICS:
|   Effective Collateral: 228.00000000 MOET
|   Utilization Rate: 404.85829900%
======================================================================

Auto-Borrow Health: 0.26000000

======================================================================
| AUTO-BALANCER STATE: Before Rebalance
======================================================================
| Tide ID: 0
| AutoBalancer ID: 0
======================================================================
| PRICES:
|   FLOW: 0.30000000 MOET
|   YieldToken: 0.50000000 MOET
|   MOET: 0.95000000 (DEPEGGED)
======================================================================
| HOLDINGS:
|   YieldToken Balance: 940.82840175
|   -> Value in MOET: 470.41420087
|   -> Value in USD: 446.89349082
======================================================================
| POSITION METRICS:
|   Initial FLOW Deposit: 1000.00000000
|   Initial Value: 300.00000000 MOET
|   Expected MOET Borrowed: ~184.61538461
|   Expected YieldTokens: ~369.23076922
======================================================================
| PERFORMANCE:
|   Current/Expected Value: 254.80769200%
|   Status: ABOVE threshold (>105%) - should rebalance DOWN
======================================================================

Auto-Balancer Balance: 940.82840175 YieldToken

Triggering simultaneous rebalances...

==================== AFTER REBALANCING ====================

======================================================================
| POSITION STATE: After Rebalance
======================================================================
| Position ID: 0
| Health Ratio: 0.30952380
======================================================================
| PRICES:
|   FLOW: 0.30000000 MOET
|   MOET: 0.95000000 (DEPEGGED)
======================================================================
| BALANCES:
|   MOET Debt: 775.38461538 (BORROWED)
|   -> Value: 775.38461538 MOET
|   FLOW Collateral: 1000.00000000
|   -> Value: 285.00000000 MOET
======================================================================
| METRICS:
|   Effective Collateral: 228.00000000 MOET
|   Utilization Rate: 340.08097100%
======================================================================

Auto-Borrow Health: 0.30952380

======================================================================
| AUTO-BALANCER STATE: After Rebalance
======================================================================
| Tide ID: 0
| AutoBalancer ID: 0
======================================================================
| PRICES:
|   FLOW: 0.30000000 MOET
|   YieldToken: 0.50000000 MOET
|   MOET: 0.95000000 (DEPEGGED)
======================================================================
| HOLDINGS:
|   YieldToken Balance: 0.00000000
|   -> Value in MOET: 0.00000000
|   -> Value in USD: 0.00000000
======================================================================
| POSITION METRICS:
|   Initial FLOW Deposit: 1000.00000000
|   Initial Value: 300.00000000 MOET
|   Expected MOET Borrowed: ~184.61538461
|   Expected YieldTokens: ~369.23076922
======================================================================
| PERFORMANCE:
|   Current/Expected Value: 0.00000000%
|   Status: BELOW threshold (<95%) - should rebalance UP
======================================================================

Auto-Balancer Balance: 0.00000000 YieldToken

----------------------------------------------------------------------
| STATE CHANGES AFTER: Rebalancing
----------------------------------------------------------------------
| Health: 0.26000000 -> 0.30952380 (+0.04952380)
| MOET Debt: 923.07692307 -> 775.38461538 (-147.69230769)
| YieldToken: 940.82840175 -> 0.00000000 (-940.82840175)
----------------------------------------------------------------------


[INTERACTION] Low borrow health may have affected available liquidity for balancer

[INTERACTION] MOET depeg affects both systems - all values impacted

======================================================================
|== Stage 4: Both moon
======================================================================


======================================================================
| [PRICE UPDATE] Setting FLOW price
|    Token Identifier: A.0000000000000003.FlowToken.Vault
|    New Price: 2.00000000 MOET
|    Previous Price: (not tracked - consider adding if needed)
|    Price update successful
======================================================================


======================================================================
| [PRICE UPDATE] Setting YieldToken price
|    Token Identifier: A.0000000000000010.YieldToken.Vault
|    New Price: 2.00000000 MOET
|    Previous Price: (not tracked - consider adding if needed)
|    Price update successful
======================================================================


==================== BEFORE REBALANCING ====================

======================================================================
| POSITION STATE: Before Rebalance
======================================================================
| Position ID: 0
| Health Ratio: 2.06349206
======================================================================
| PRICES:
|   FLOW: 2.00000000 MOET
|   MOET: 1.00000000 (pegged)
======================================================================
| BALANCES:
|   MOET Debt: 775.38461538 (BORROWED)
|   -> Value: 775.38461538 MOET
|   FLOW Collateral: 1000.00000000
|   -> Value: 2000.00000000 MOET
======================================================================
| METRICS:
|   Effective Collateral: 1600.00000000 MOET
|   Utilization Rate: 48.46153800%
======================================================================

Auto-Borrow Health: 2.06349206

======================================================================
| AUTO-BALANCER STATE: Before Rebalance
======================================================================
| Tide ID: 0
| AutoBalancer ID: 0
======================================================================
| PRICES:
|   FLOW: 2.00000000 MOET
|   YieldToken: 2.00000000 MOET
|   MOET: 1.00000000 (pegged)
======================================================================
| HOLDINGS:
|   YieldToken Balance: 0.00000000
|   -> Value in MOET: 0.00000000
|   -> Value in USD: 0.00000000
======================================================================
| POSITION METRICS:
|   Initial FLOW Deposit: 1000.00000000
|   Initial Value: 2000.00000000 MOET
|   Expected MOET Borrowed: ~1230.76923076
|   Expected YieldTokens: ~615.38461538
======================================================================
| PERFORMANCE:
|   Current/Expected Value: 0.00000000%
|   Status: BELOW threshold (<95%) - should rebalance UP
======================================================================

Auto-Balancer Balance: 0.00000000 YieldToken

Triggering simultaneous rebalances...

==================== AFTER REBALANCING ====================

======================================================================
| POSITION STATE: After Rebalance
======================================================================
| Position ID: 0
| Health Ratio: 1.30000000
======================================================================
| PRICES:
|   FLOW: 2.00000000 MOET
|   MOET: 1.00000000 (pegged)
======================================================================
| BALANCES:
|   MOET Debt: 1230.76923076 (BORROWED)
|   -> Value: 1230.76923076 MOET
|   FLOW Collateral: 1000.00000000
|   -> Value: 2000.00000000 MOET
======================================================================
| METRICS:
|   Effective Collateral: 1600.00000000 MOET
|   Utilization Rate: 76.92307600%
======================================================================

Auto-Borrow Health: 1.30000000

======================================================================
| AUTO-BALANCER STATE: After Rebalance
======================================================================
| Tide ID: 0
| AutoBalancer ID: 0
======================================================================
| PRICES:
|   FLOW: 2.00000000 MOET
|   YieldToken: 2.00000000 MOET
|   MOET: 1.00000000 (pegged)
======================================================================
| HOLDINGS:
|   YieldToken Balance: 0.00000000
|   -> Value in MOET: 0.00000000
|   -> Value in USD: 0.00000000
======================================================================
| POSITION METRICS:
|   Initial FLOW Deposit: 1000.00000000
|   Initial Value: 2000.00000000 MOET
|   Expected MOET Borrowed: ~1230.76923076
|   Expected YieldTokens: ~615.38461538
======================================================================
| PERFORMANCE:
|   Current/Expected Value: 0.00000000%
|   Status: BELOW threshold (<95%) - should rebalance UP
======================================================================

Auto-Balancer Balance: 0.00000000 YieldToken

----------------------------------------------------------------------
| STATE CHANGES AFTER: Rebalancing
----------------------------------------------------------------------
| Health: 2.06349206 -> 1.30000000 (-0.76349206)
| MOET Debt: 775.38461538 -> 1230.76923076 (+455.38461538)
----------------------------------------------------------------------


======================================================================
|== Stage 5: FLOW stable, YieldToken crash
======================================================================


======================================================================
| [PRICE UPDATE] Setting FLOW price
|    Token Identifier: A.0000000000000003.FlowToken.Vault
|    New Price: 1.00000000 MOET
|    Previous Price: (not tracked - consider adding if needed)
|    Price update successful
======================================================================


======================================================================
| [PRICE UPDATE] Setting YieldToken price
|    Token Identifier: A.0000000000000010.YieldToken.Vault
|    New Price: 0.10000000 MOET
|    Previous Price: (not tracked - consider adding if needed)
|    Price update successful
======================================================================


==================== BEFORE REBALANCING ====================

======================================================================
| POSITION STATE: Before Rebalance
======================================================================
| Position ID: 0
| Health Ratio: 0.65000000
======================================================================
| PRICES:
|   FLOW: 1.00000000 MOET
|   MOET: 1.00000000 (pegged)
======================================================================
| BALANCES:
|   MOET Debt: 1230.76923076 (BORROWED)
|   -> Value: 1230.76923076 MOET
|   FLOW Collateral: 1000.00000000
|   -> Value: 1000.00000000 MOET
======================================================================
| METRICS:
|   Effective Collateral: 800.00000000 MOET
|   Utilization Rate: 153.84615300%
======================================================================

Auto-Borrow Health: 0.65000000

======================================================================
| AUTO-BALANCER STATE: Before Rebalance
======================================================================
| Tide ID: 0
| AutoBalancer ID: 0
======================================================================
| PRICES:
|   FLOW: 1.00000000 MOET
|   YieldToken: 0.10000000 MOET
|   MOET: 1.00000000 (pegged)
======================================================================
| HOLDINGS:
|   YieldToken Balance: 0.00000000
|   -> Value in MOET: 0.00000000
|   -> Value in USD: 0.00000000
======================================================================
| POSITION METRICS:
|   Initial FLOW Deposit: 1000.00000000
|   Initial Value: 1000.00000000 MOET
|   Expected MOET Borrowed: ~615.38461538
|   Expected YieldTokens: ~6153.84615380
======================================================================
| PERFORMANCE:
|   Current/Expected Value: 0.00000000%
|   Status: BELOW threshold (<95%) - should rebalance UP
======================================================================

Auto-Balancer Balance: 0.00000000 YieldToken

Triggering simultaneous rebalances...

==================== AFTER REBALANCING ====================

======================================================================
| POSITION STATE: After Rebalance
======================================================================
| Position ID: 0
| Health Ratio: 0.86666666
======================================================================
| PRICES:
|   FLOW: 1.00000000 MOET
|   MOET: 1.00000000 (pegged)
======================================================================
| BALANCES:
|   MOET Debt: 923.07692307 (BORROWED)
|   -> Value: 923.07692307 MOET
|   FLOW Collateral: 1000.00000000
|   -> Value: 1000.00000000 MOET
======================================================================
| METRICS:
|   Effective Collateral: 800.00000000 MOET
|   Utilization Rate: 115.38461500%
======================================================================

Auto-Borrow Health: 0.86666666

======================================================================
| AUTO-BALANCER STATE: After Rebalance
======================================================================
| Tide ID: 0
| AutoBalancer ID: 0
======================================================================
| PRICES:
|   FLOW: 1.00000000 MOET
|   YieldToken: 0.10000000 MOET
|   MOET: 1.00000000 (pegged)
======================================================================
| HOLDINGS:
|   YieldToken Balance: 0.00000000
|   -> Value in MOET: 0.00000000
|   -> Value in USD: 0.00000000
======================================================================
| POSITION METRICS:
|   Initial FLOW Deposit: 1000.00000000
|   Initial Value: 1000.00000000 MOET
|   Expected MOET Borrowed: ~615.38461538
|   Expected YieldTokens: ~6153.84615380
======================================================================
| PERFORMANCE:
|   Current/Expected Value: 0.00000000%
|   Status: BELOW threshold (<95%) - should rebalance UP
======================================================================

Auto-Balancer Balance: 0.00000000 YieldToken

----------------------------------------------------------------------
| STATE CHANGES AFTER: Rebalancing
----------------------------------------------------------------------
| Health: 0.65000000 -> 0.86666666 (+0.21666666)
| MOET Debt: 1230.76923076 -> 923.07692307 (-307.69230769)
----------------------------------------------------------------------


======================================================================
|== Stage 6: FLOW crash, YieldToken stable (MOET depegged)
======================================================================


======================================================================
| [PRICE UPDATE] Setting FLOW price
|    Token Identifier: A.0000000000000003.FlowToken.Vault
|    New Price: 0.10000000 MOET
|    Previous Price: (not tracked - consider adding if needed)
|    Price update successful
======================================================================


======================================================================
| [PRICE UPDATE] Setting YieldToken price
|    Token Identifier: A.0000000000000010.YieldToken.Vault
|    New Price: 1.00000000 MOET
|    Previous Price: (not tracked - consider adding if needed)
|    Price update successful
======================================================================


======================================================================
| [PRICE UPDATE] Setting MOET price
|    Token Identifier: A.0000000000000008.MOET.Vault
|    New Price: 0.90000000 MOET
|    Previous Price: (not tracked - consider adding if needed)
|    Price update successful
======================================================================


==================== BEFORE REBALANCING ====================

======================================================================
| POSITION STATE: Before Rebalance
======================================================================
| Position ID: 0
| Health Ratio: 0.08666666
======================================================================
| PRICES:
|   FLOW: 0.10000000 MOET
|   MOET: 0.90000000 (DEPEGGED)
======================================================================
| BALANCES:
|   MOET Debt: 923.07692307 (BORROWED)
|   -> Value: 923.07692307 MOET
|   FLOW Collateral: 1000.00000000
|   -> Value: 90.00000000 MOET
======================================================================
| METRICS:
|   Effective Collateral: 72.00000000 MOET
|   Utilization Rate: 1282.05128200%
======================================================================

Auto-Borrow Health: 0.08666666

======================================================================
| AUTO-BALANCER STATE: Before Rebalance
======================================================================
| Tide ID: 0
| AutoBalancer ID: 0
======================================================================
| PRICES:
|   FLOW: 0.10000000 MOET
|   YieldToken: 1.00000000 MOET
|   MOET: 0.90000000 (DEPEGGED)
======================================================================
| HOLDINGS:
|   YieldToken Balance: 0.00000000
|   -> Value in MOET: 0.00000000
|   -> Value in USD: 0.00000000
======================================================================
| POSITION METRICS:
|   Initial FLOW Deposit: 1000.00000000
|   Initial Value: 100.00000000 MOET
|   Expected MOET Borrowed: ~61.53846153
|   Expected YieldTokens: ~61.53846153
======================================================================
| PERFORMANCE:
|   Current/Expected Value: 0.00000000%
|   Status: BELOW threshold (<95%) - should rebalance UP
======================================================================

Auto-Balancer Balance: 0.00000000 YieldToken

Triggering simultaneous rebalances...

==================== AFTER REBALANCING ====================

======================================================================
| POSITION STATE: After Rebalance
======================================================================
| Position ID: 0
| Health Ratio: 0.09241706
======================================================================
| PRICES:
|   FLOW: 0.10000000 MOET
|   MOET: 0.90000000 (DEPEGGED)
======================================================================
| BALANCES:
|   MOET Debt: 865.64102532 (BORROWED)
|   -> Value: 865.64102532 MOET
|   FLOW Collateral: 1000.00000000
|   -> Value: 90.00000000 MOET
======================================================================
| METRICS:
|   Effective Collateral: 72.00000000 MOET
|   Utilization Rate: 1202.27920100%
======================================================================

Auto-Borrow Health: 0.09241706

======================================================================
| AUTO-BALANCER STATE: After Rebalance
======================================================================
| Tide ID: 0
| AutoBalancer ID: 0
======================================================================
| PRICES:
|   FLOW: 0.10000000 MOET
|   YieldToken: 1.00000000 MOET
|   MOET: 0.90000000 (DEPEGGED)
======================================================================
| HOLDINGS:
|   YieldToken Balance: 0.00000000
|   -> Value in MOET: 0.00000000
|   -> Value in USD: 0.00000000
======================================================================
| POSITION METRICS:
|   Initial FLOW Deposit: 1000.00000000
|   Initial Value: 100.00000000 MOET
|   Expected MOET Borrowed: ~61.53846153
|   Expected YieldTokens: ~61.53846153
======================================================================
| PERFORMANCE:
|   Current/Expected Value: 0.00000000%
|   Status: BELOW threshold (<95%) - should rebalance UP
======================================================================

Auto-Balancer Balance: 0.00000000 YieldToken

----------------------------------------------------------------------
| STATE CHANGES AFTER: Rebalancing
----------------------------------------------------------------------
| Health: 0.08666666 -> 0.09241706 (+0.00575040)
| MOET Debt: 923.07692307 -> 865.64102532 (-57.43589775)
----------------------------------------------------------------------


[INTERACTION] YieldToken crash improved borrow position (cheaper debt repayment)

[INTERACTION] MOET depeg affects both systems - all values impacted

======================================================================
|== Stage 7: Return to baseline
======================================================================


======================================================================
| [PRICE UPDATE] Setting FLOW price
|    Token Identifier: A.0000000000000003.FlowToken.Vault
|    New Price: 1.00000000 MOET
|    Previous Price: (not tracked - consider adding if needed)
|    Price update successful
======================================================================


======================================================================
| [PRICE UPDATE] Setting YieldToken price
|    Token Identifier: A.0000000000000010.YieldToken.Vault
|    New Price: 1.00000000 MOET
|    Previous Price: (not tracked - consider adding if needed)
|    Price update successful
======================================================================


==================== BEFORE REBALANCING ====================

======================================================================
| POSITION STATE: Before Rebalance
======================================================================
| Position ID: 0
| Health Ratio: 0.92417061
======================================================================
| PRICES:
|   FLOW: 1.00000000 MOET
|   MOET: 1.00000000 (pegged)
======================================================================
| BALANCES:
|   MOET Debt: 865.64102532 (BORROWED)
|   -> Value: 865.64102532 MOET
|   FLOW Collateral: 1000.00000000
|   -> Value: 1000.00000000 MOET
======================================================================
| METRICS:
|   Effective Collateral: 800.00000000 MOET
|   Utilization Rate: 108.20512800%
======================================================================

Auto-Borrow Health: 0.92417061

======================================================================
| AUTO-BALANCER STATE: Before Rebalance
======================================================================
| Tide ID: 0
| AutoBalancer ID: 0
======================================================================
| PRICES:
|   FLOW: 1.00000000 MOET
|   YieldToken: 1.00000000 MOET
|   MOET: 1.00000000 (pegged)
======================================================================
| HOLDINGS:
|   YieldToken Balance: 0.00000000
|   -> Value in MOET: 0.00000000
|   -> Value in USD: 0.00000000
======================================================================
| POSITION METRICS:
|   Initial FLOW Deposit: 1000.00000000
|   Initial Value: 1000.00000000 MOET
|   Expected MOET Borrowed: ~615.38461538
|   Expected YieldTokens: ~615.38461538
======================================================================
| PERFORMANCE:
|   Current/Expected Value: 0.00000000%
|   Status: BELOW threshold (<95%) - should rebalance UP
======================================================================

Auto-Balancer Balance: 0.00000000 YieldToken

Triggering simultaneous rebalances...

==================== AFTER REBALANCING ====================

======================================================================
| POSITION STATE: After Rebalance
======================================================================
| Position ID: 0
| Health Ratio: 1.16324107
======================================================================
| PRICES:
|   FLOW: 1.00000000 MOET
|   MOET: 1.00000000 (pegged)
======================================================================
| BALANCES:
|   MOET Debt: 687.73362177 (BORROWED)
|   -> Value: 687.73362177 MOET
|   FLOW Collateral: 1000.00000000
|   -> Value: 1000.00000000 MOET
======================================================================
| METRICS:
|   Effective Collateral: 800.00000000 MOET
|   Utilization Rate: 85.96670200%
======================================================================

Auto-Borrow Health: 1.16324107

======================================================================
| AUTO-BALANCER STATE: After Rebalance
======================================================================
| Tide ID: 0
| AutoBalancer ID: 0
======================================================================
| PRICES:
|   FLOW: 1.00000000 MOET
|   YieldToken: 1.00000000 MOET
|   MOET: 1.00000000 (pegged)
======================================================================
| HOLDINGS:
|   YieldToken Balance: 0.00000000
|   -> Value in MOET: 0.00000000
|   -> Value in USD: 0.00000000
======================================================================
| POSITION METRICS:
|   Initial FLOW Deposit: 1000.00000000
|   Initial Value: 1000.00000000 MOET
|   Expected MOET Borrowed: ~615.38461538
|   Expected YieldTokens: ~615.38461538
======================================================================
| PERFORMANCE:
|   Current/Expected Value: 0.00000000%
|   Status: BELOW threshold (<95%) - should rebalance UP
======================================================================

Auto-Balancer Balance: 0.00000000 YieldToken

----------------------------------------------------------------------
| STATE CHANGES AFTER: Rebalancing
----------------------------------------------------------------------
| Health: 0.92417061 -> 1.16324107 (+0.23907046)
| MOET Debt: 865.64102532 -> 687.73362177 (-177.90740355)
----------------------------------------------------------------------


======================================================================
|== Final State Summary
======================================================================

AUTO-BORROW POSITION:
  Final Health: 1.16324107
  Final Collateral: 1000.00000000 FLOW
  Final Debt: 687.73362177 MOET

AUTO-BALANCER:
  Final YieldToken Balance: 0.00000000
  Final Value: 0.00000000 MOET (at current price)

CHANGES FROM START:
  Health: 1.3 -> 1.16324107
  Collateral: 1000 -> 1000.00000000
  Debt: ~615.38 -> 687.73362177
  YieldToken: ~615.38 -> 0.00000000
Test results: "cadence/tests/mixed_scenario_test.cdc"
- PASS: testMixedScenario

[9/10] Testing inverse correlation scenario (NEW)...

======================================================================
|== MIXED SCENARIO: Inverse Correlation Scenario
======================================================================

Creating auto-borrow position with 1000 FLOW...
Creating auto-balancer Tide with 1000 FLOW...

======================================================================
|== Initial State
======================================================================


**********************************************************************
* MIXED SCENARIO STATE: Initial State
**********************************************************************
* CURRENT PRICES:
*   FLOW: 1.00000000 MOET
*   YieldToken: 1.00000000 MOET
*   MOET: 1.00000000 (pegged)
**********************************************************************

======================================================================
| POSITION STATE: Auto-Borrow
======================================================================
| Position ID: 0
| Health Ratio: 1.30000000
======================================================================
| PRICES:
|   FLOW: 1.00000000 MOET
|   MOET: 1.00000000 (pegged)
======================================================================
| BALANCES:
|   MOET Debt: 615.38461538 (BORROWED)
|   -> Value: 615.38461538 MOET
|   FLOW Collateral: 1000.00000000
|   -> Value: 1000.00000000 MOET
======================================================================
| METRICS:
|   Effective Collateral: 800.00000000 MOET
|   Utilization Rate: 76.92307600%
======================================================================


======================================================================
| AUTO-BALANCER STATE: Auto-Balancer
======================================================================
| Tide ID: 0
| AutoBalancer ID: 0
======================================================================
| PRICES:
|   FLOW: 1.00000000 MOET
|   YieldToken: 1.00000000 MOET
|   MOET: 1.00000000 (pegged)
======================================================================
| HOLDINGS:
|   YieldToken Balance: 615.38461538
|   -> Value in MOET: 615.38461538
|   -> Value in USD: 615.38461538
======================================================================
| POSITION METRICS:
|   Initial FLOW Deposit: 1000.00000000
|   Initial Value: 1000.00000000 MOET
|   Expected MOET Borrowed: ~615.38461538
|   Expected YieldTokens: ~615.38461538
======================================================================
| PERFORMANCE:
|   Current/Expected Value: 100.00000000%
|   Status: WITHIN threshold (95-105%) - no rebalance needed
======================================================================


======================================================================
|== Stage 0: Baseline
======================================================================


======================================================================
| [PRICE UPDATE] Setting FLOW price
|    Token Identifier: A.0000000000000003.FlowToken.Vault
|    New Price: 1.00000000 MOET
|    Previous Price: (not tracked - consider adding if needed)
|    Price update successful
======================================================================


======================================================================
| [PRICE UPDATE] Setting YieldToken price
|    Token Identifier: A.0000000000000010.YieldToken.Vault
|    New Price: 1.00000000 MOET
|    Previous Price: (not tracked - consider adding if needed)
|    Price update successful
======================================================================


**********************************************************************
* MIXED SCENARIO STATE: Before Rebalancing
**********************************************************************
* CURRENT PRICES:
*   FLOW: 1.00000000 MOET
*   YieldToken: 1.00000000 MOET
*   MOET: 1.00000000 (pegged)
**********************************************************************

======================================================================
| POSITION STATE: Auto-Borrow
======================================================================
| Position ID: 0
| Health Ratio: 1.30000000
======================================================================
| PRICES:
|   FLOW: 1.00000000 MOET
|   MOET: 1.00000000 (pegged)
======================================================================
| BALANCES:
|   MOET Debt: 615.38461538 (BORROWED)
|   -> Value: 615.38461538 MOET
|   FLOW Collateral: 1000.00000000
|   -> Value: 1000.00000000 MOET
======================================================================
| METRICS:
|   Effective Collateral: 800.00000000 MOET
|   Utilization Rate: 76.92307600%
======================================================================


======================================================================
| AUTO-BALANCER STATE: Auto-Balancer
======================================================================
| Tide ID: 0
| AutoBalancer ID: 0
======================================================================
| PRICES:
|   FLOW: 1.00000000 MOET
|   YieldToken: 1.00000000 MOET
|   MOET: 1.00000000 (pegged)
======================================================================
| HOLDINGS:
|   YieldToken Balance: 615.38461538
|   -> Value in MOET: 615.38461538
|   -> Value in USD: 615.38461538
======================================================================
| POSITION METRICS:
|   Initial FLOW Deposit: 1000.00000000
|   Initial Value: 1000.00000000 MOET
|   Expected MOET Borrowed: ~615.38461538
|   Expected YieldTokens: ~615.38461538
======================================================================
| PERFORMANCE:
|   Current/Expected Value: 100.00000000%
|   Status: WITHIN threshold (95-105%) - no rebalance needed
======================================================================


Triggering simultaneous rebalances...

**********************************************************************
* MIXED SCENARIO STATE: After Rebalancing
**********************************************************************
* CURRENT PRICES:
*   FLOW: 1.00000000 MOET
*   YieldToken: 1.00000000 MOET
*   MOET: 1.00000000 (pegged)
**********************************************************************

======================================================================
| POSITION STATE: Auto-Borrow
======================================================================
| Position ID: 0
| Health Ratio: 1.30000000
======================================================================
| PRICES:
|   FLOW: 1.00000000 MOET
|   MOET: 1.00000000 (pegged)
======================================================================
| BALANCES:
|   MOET Debt: 615.38461538 (BORROWED)
|   -> Value: 615.38461538 MOET
|   FLOW Collateral: 1000.00000000
|   -> Value: 1000.00000000 MOET
======================================================================
| METRICS:
|   Effective Collateral: 800.00000000 MOET
|   Utilization Rate: 76.92307600%
======================================================================


======================================================================
| AUTO-BALANCER STATE: Auto-Balancer
======================================================================
| Tide ID: 0
| AutoBalancer ID: 0
======================================================================
| PRICES:
|   FLOW: 1.00000000 MOET
|   YieldToken: 1.00000000 MOET
|   MOET: 1.00000000 (pegged)
======================================================================
| HOLDINGS:
|   YieldToken Balance: 615.38461538
|   -> Value in MOET: 615.38461538
|   -> Value in USD: 615.38461538
======================================================================
| POSITION METRICS:
|   Initial FLOW Deposit: 1000.00000000
|   Initial Value: 1000.00000000 MOET
|   Expected MOET Borrowed: ~615.38461538
|   Expected YieldTokens: ~615.38461538
======================================================================
| PERFORMANCE:
|   Current/Expected Value: 100.00000000%
|   Status: WITHIN threshold (95-105%) - no rebalance needed
======================================================================


CHANGES:
  Health UNCHANGED
  Balance UNCHANGED

======================================================================
|== Stage 1: Inverse correlation begins
======================================================================


======================================================================
| [PRICE UPDATE] Setting FLOW price
|    Token Identifier: A.0000000000000003.FlowToken.Vault
|    New Price: 0.50000000 MOET
|    Previous Price: (not tracked - consider adding if needed)
|    Price update successful
======================================================================


======================================================================
| [PRICE UPDATE] Setting YieldToken price
|    Token Identifier: A.0000000000000010.YieldToken.Vault
|    New Price: 2.00000000 MOET
|    Previous Price: (not tracked - consider adding if needed)
|    Price update successful
======================================================================


**********************************************************************
* MIXED SCENARIO STATE: Before Rebalancing
**********************************************************************
* CURRENT PRICES:
*   FLOW: 0.50000000 MOET
*   YieldToken: 2.00000000 MOET
*   MOET: 1.00000000 (pegged)
**********************************************************************

======================================================================
| POSITION STATE: Auto-Borrow
======================================================================
| Position ID: 0
| Health Ratio: 0.65000000
======================================================================
| PRICES:
|   FLOW: 0.50000000 MOET
|   MOET: 1.00000000 (pegged)
======================================================================
| BALANCES:
|   MOET Debt: 615.38461538 (BORROWED)
|   -> Value: 615.38461538 MOET
|   FLOW Collateral: 1000.00000000
|   -> Value: 500.00000000 MOET
======================================================================
| METRICS:
|   Effective Collateral: 400.00000000 MOET
|   Utilization Rate: 153.84615300%
======================================================================


======================================================================
| AUTO-BALANCER STATE: Auto-Balancer
======================================================================
| Tide ID: 0
| AutoBalancer ID: 0
======================================================================
| PRICES:
|   FLOW: 0.50000000 MOET
|   YieldToken: 2.00000000 MOET
|   MOET: 1.00000000 (pegged)
======================================================================
| HOLDINGS:
|   YieldToken Balance: 615.38461538
|   -> Value in MOET: 1230.76923076
|   -> Value in USD: 1230.76923076
======================================================================
| POSITION METRICS:
|   Initial FLOW Deposit: 1000.00000000
|   Initial Value: 500.00000000 MOET
|   Expected MOET Borrowed: ~307.69230769
|   Expected YieldTokens: ~153.84615384
======================================================================
| PERFORMANCE:
|   Current/Expected Value: 400.00000000%
|   Status: ABOVE threshold (>105%) - should rebalance DOWN
======================================================================


Triggering simultaneous rebalances...

**********************************************************************
* MIXED SCENARIO STATE: After Rebalancing
**********************************************************************
* CURRENT PRICES:
*   FLOW: 0.50000000 MOET
*   YieldToken: 2.00000000 MOET
*   MOET: 1.00000000 (pegged)
**********************************************************************

======================================================================
| POSITION STATE: Auto-Borrow
======================================================================
| Position ID: 0
| Health Ratio: 0.86666666
======================================================================
| PRICES:
|   FLOW: 0.50000000 MOET
|   MOET: 1.00000000 (pegged)
======================================================================
| BALANCES:
|   MOET Debt: 461.53846154 (BORROWED)
|   -> Value: 461.53846154 MOET
|   FLOW Collateral: 1000.00000000
|   -> Value: 500.00000000 MOET
======================================================================
| METRICS:
|   Effective Collateral: 400.00000000 MOET
|   Utilization Rate: 115.38461500%
======================================================================


======================================================================
| AUTO-BALANCER STATE: Auto-Balancer
======================================================================
| Tide ID: 0
| AutoBalancer ID: 0
======================================================================
| PRICES:
|   FLOW: 0.50000000 MOET
|   YieldToken: 2.00000000 MOET
|   MOET: 1.00000000 (pegged)
======================================================================
| HOLDINGS:
|   YieldToken Balance: 615.38461538
|   -> Value in MOET: 1230.76923076
|   -> Value in USD: 1230.76923076
======================================================================
| POSITION METRICS:
|   Initial FLOW Deposit: 1000.00000000
|   Initial Value: 500.00000000 MOET
|   Expected MOET Borrowed: ~307.69230769
|   Expected YieldTokens: ~153.84615384
======================================================================
| PERFORMANCE:
|   Current/Expected Value: 400.00000000%
|   Status: ABOVE threshold (>105%) - should rebalance DOWN
======================================================================


CHANGES:
  Health IMPROVED by: 0.21666666
  Balance UNCHANGED

======================================================================
|== Stage 2: Inverse continues
======================================================================


======================================================================
| [PRICE UPDATE] Setting FLOW price
|    Token Identifier: A.0000000000000003.FlowToken.Vault
|    New Price: 2.00000000 MOET
|    Previous Price: (not tracked - consider adding if needed)
|    Price update successful
======================================================================


======================================================================
| [PRICE UPDATE] Setting YieldToken price
|    Token Identifier: A.0000000000000010.YieldToken.Vault
|    New Price: 0.50000000 MOET
|    Previous Price: (not tracked - consider adding if needed)
|    Price update successful
======================================================================


**********************************************************************
* MIXED SCENARIO STATE: Before Rebalancing
**********************************************************************
* CURRENT PRICES:
*   FLOW: 2.00000000 MOET
*   YieldToken: 0.50000000 MOET
*   MOET: 1.00000000 (pegged)
**********************************************************************

======================================================================
| POSITION STATE: Auto-Borrow
======================================================================
| Position ID: 0
| Health Ratio: 3.46666666
======================================================================
| PRICES:
|   FLOW: 2.00000000 MOET
|   MOET: 1.00000000 (pegged)
======================================================================
| BALANCES:
|   MOET Debt: 461.53846154 (BORROWED)
|   -> Value: 461.53846154 MOET
|   FLOW Collateral: 1000.00000000
|   -> Value: 2000.00000000 MOET
======================================================================
| METRICS:
|   Effective Collateral: 1600.00000000 MOET
|   Utilization Rate: 28.84615300%
======================================================================


======================================================================
| AUTO-BALANCER STATE: Auto-Balancer
======================================================================
| Tide ID: 0
| AutoBalancer ID: 0
======================================================================
| PRICES:
|   FLOW: 2.00000000 MOET
|   YieldToken: 0.50000000 MOET
|   MOET: 1.00000000 (pegged)
======================================================================
| HOLDINGS:
|   YieldToken Balance: 615.38461538
|   -> Value in MOET: 307.69230769
|   -> Value in USD: 307.69230769
======================================================================
| POSITION METRICS:
|   Initial FLOW Deposit: 1000.00000000
|   Initial Value: 2000.00000000 MOET
|   Expected MOET Borrowed: ~1230.76923076
|   Expected YieldTokens: ~2461.53846152
======================================================================
| PERFORMANCE:
|   Current/Expected Value: 25.00000000%
|   Status: BELOW threshold (<95%) - should rebalance UP
======================================================================


Triggering simultaneous rebalances...

**********************************************************************
* MIXED SCENARIO STATE: After Rebalancing
**********************************************************************
* CURRENT PRICES:
*   FLOW: 2.00000000 MOET
*   YieldToken: 0.50000000 MOET
*   MOET: 1.00000000 (pegged)
**********************************************************************

======================================================================
| POSITION STATE: Auto-Borrow
======================================================================
| Position ID: 0
| Health Ratio: 1.30000000
======================================================================
| PRICES:
|   FLOW: 2.00000000 MOET
|   MOET: 1.00000000 (pegged)
======================================================================
| BALANCES:
|   MOET Debt: 1230.76923076 (BORROWED)
|   -> Value: 1230.76923076 MOET
|   FLOW Collateral: 1000.00000000
|   -> Value: 2000.00000000 MOET
======================================================================
| METRICS:
|   Effective Collateral: 1600.00000000 MOET
|   Utilization Rate: 76.92307600%
======================================================================


======================================================================
| AUTO-BALANCER STATE: Auto-Balancer
======================================================================
| Tide ID: 0
| AutoBalancer ID: 0
======================================================================
| PRICES:
|   FLOW: 2.00000000 MOET
|   YieldToken: 0.50000000 MOET
|   MOET: 1.00000000 (pegged)
======================================================================
| HOLDINGS:
|   YieldToken Balance: 1609.46745560
|   -> Value in MOET: 804.73372780
|   -> Value in USD: 804.73372780
======================================================================
| POSITION METRICS:
|   Initial FLOW Deposit: 1000.00000000
|   Initial Value: 2000.00000000 MOET
|   Expected MOET Borrowed: ~1230.76923076
|   Expected YieldTokens: ~2461.53846152
======================================================================
| PERFORMANCE:
|   Current/Expected Value: 65.38461500%
|   Status: BELOW threshold (<95%) - should rebalance UP
======================================================================


CHANGES:
  Health DETERIORATED by: 2.16666666
  Balance INCREASED by: 994.08284022

======================================================================
|== Stage 3: FLOW crashes, Yield moons
======================================================================


======================================================================
| [PRICE UPDATE] Setting FLOW price
|    Token Identifier: A.0000000000000003.FlowToken.Vault
|    New Price: 0.30000000 MOET
|    Previous Price: (not tracked - consider adding if needed)
|    Price update successful
======================================================================


======================================================================
| [PRICE UPDATE] Setting YieldToken price
|    Token Identifier: A.0000000000000010.YieldToken.Vault
|    New Price: 3.00000000 MOET
|    Previous Price: (not tracked - consider adding if needed)
|    Price update successful
======================================================================


**********************************************************************
* MIXED SCENARIO STATE: Before Rebalancing
**********************************************************************
* CURRENT PRICES:
*   FLOW: 0.30000000 MOET
*   YieldToken: 3.00000000 MOET
*   MOET: 1.00000000 (pegged)
**********************************************************************

======================================================================
| POSITION STATE: Auto-Borrow
======================================================================
| Position ID: 0
| Health Ratio: 0.19500000
======================================================================
| PRICES:
|   FLOW: 0.30000000 MOET
|   MOET: 1.00000000 (pegged)
======================================================================
| BALANCES:
|   MOET Debt: 1230.76923076 (BORROWED)
|   -> Value: 1230.76923076 MOET
|   FLOW Collateral: 1000.00000000
|   -> Value: 300.00000000 MOET
======================================================================
| METRICS:
|   Effective Collateral: 240.00000000 MOET
|   Utilization Rate: 512.82051200%
======================================================================


======================================================================
| AUTO-BALANCER STATE: Auto-Balancer
======================================================================
| Tide ID: 0
| AutoBalancer ID: 0
======================================================================
| PRICES:
|   FLOW: 0.30000000 MOET
|   YieldToken: 3.00000000 MOET
|   MOET: 1.00000000 (pegged)
======================================================================
| HOLDINGS:
|   YieldToken Balance: 1609.46745560
|   -> Value in MOET: 4828.40236680
|   -> Value in USD: 4828.40236680
======================================================================
| POSITION METRICS:
|   Initial FLOW Deposit: 1000.00000000
|   Initial Value: 300.00000000 MOET
|   Expected MOET Borrowed: ~184.61538461
|   Expected YieldTokens: ~61.53846153
======================================================================
| PERFORMANCE:
|   Current/Expected Value: 2615.38461500%
|   Status: ABOVE threshold (>105%) - should rebalance DOWN
======================================================================


Triggering simultaneous rebalances...

**********************************************************************
* MIXED SCENARIO STATE: After Rebalancing
**********************************************************************
* CURRENT PRICES:
*   FLOW: 0.30000000 MOET
*   YieldToken: 3.00000000 MOET
*   MOET: 1.00000000 (pegged)
**********************************************************************

======================================================================
| POSITION STATE: Auto-Borrow
======================================================================
| Position ID: 0
| Health Ratio: 0.22349570
======================================================================
| PRICES:
|   FLOW: 0.30000000 MOET
|   MOET: 1.00000000 (pegged)
======================================================================
| BALANCES:
|   MOET Debt: 1073.84615384 (BORROWED)
|   -> Value: 1073.84615384 MOET
|   FLOW Collateral: 1000.00000000
|   -> Value: 300.00000000 MOET
======================================================================
| METRICS:
|   Effective Collateral: 240.00000000 MOET
|   Utilization Rate: 447.43589700%
======================================================================


======================================================================
| AUTO-BALANCER STATE: Auto-Balancer
======================================================================
| Tide ID: 0
| AutoBalancer ID: 0
======================================================================
| PRICES:
|   FLOW: 0.30000000 MOET
|   YieldToken: 3.00000000 MOET
|   MOET: 1.00000000 (pegged)
======================================================================
| HOLDINGS:
|   YieldToken Balance: 1609.46745560
|   -> Value in MOET: 4828.40236680
|   -> Value in USD: 4828.40236680
======================================================================
| POSITION METRICS:
|   Initial FLOW Deposit: 1000.00000000
|   Initial Value: 300.00000000 MOET
|   Expected MOET Borrowed: ~184.61538461
|   Expected YieldTokens: ~61.53846153
======================================================================
| PERFORMANCE:
|   Current/Expected Value: 2615.38461500%
|   Status: ABOVE threshold (>105%) - should rebalance DOWN
======================================================================


CHANGES:
  Health IMPROVED by: 0.02849570
  Balance UNCHANGED

======================================================================
|== Stage 4: Partial recovery
======================================================================


======================================================================
| [PRICE UPDATE] Setting FLOW price
|    Token Identifier: A.0000000000000003.FlowToken.Vault
|    New Price: 1.50000000 MOET
|    Previous Price: (not tracked - consider adding if needed)
|    Price update successful
======================================================================


======================================================================
| [PRICE UPDATE] Setting YieldToken price
|    Token Identifier: A.0000000000000010.YieldToken.Vault
|    New Price: 0.70000000 MOET
|    Previous Price: (not tracked - consider adding if needed)
|    Price update successful
======================================================================


**********************************************************************
* MIXED SCENARIO STATE: Before Rebalancing
**********************************************************************
* CURRENT PRICES:
*   FLOW: 1.50000000 MOET
*   YieldToken: 0.70000000 MOET
*   MOET: 1.00000000 (pegged)
**********************************************************************

======================================================================
| POSITION STATE: Auto-Borrow
======================================================================
| Position ID: 0
| Health Ratio: 1.11747851
======================================================================
| PRICES:
|   FLOW: 1.50000000 MOET
|   MOET: 1.00000000 (pegged)
======================================================================
| BALANCES:
|   MOET Debt: 1073.84615384 (BORROWED)
|   -> Value: 1073.84615384 MOET
|   FLOW Collateral: 1000.00000000
|   -> Value: 1500.00000000 MOET
======================================================================
| METRICS:
|   Effective Collateral: 1200.00000000 MOET
|   Utilization Rate: 89.48717900%
======================================================================


======================================================================
| AUTO-BALANCER STATE: Auto-Balancer
======================================================================
| Tide ID: 0
| AutoBalancer ID: 0
======================================================================
| PRICES:
|   FLOW: 1.50000000 MOET
|   YieldToken: 0.70000000 MOET
|   MOET: 1.00000000 (pegged)
======================================================================
| HOLDINGS:
|   YieldToken Balance: 1609.46745560
|   -> Value in MOET: 1126.62721892
|   -> Value in USD: 1126.62721892
======================================================================
| POSITION METRICS:
|   Initial FLOW Deposit: 1000.00000000
|   Initial Value: 1500.00000000 MOET
|   Expected MOET Borrowed: ~923.07692307
|   Expected YieldTokens: ~1318.68131867
======================================================================
| PERFORMANCE:
|   Current/Expected Value: 122.05128200%
|   Status: ABOVE threshold (>105%) - should rebalance DOWN
======================================================================


Triggering simultaneous rebalances...

**********************************************************************
* MIXED SCENARIO STATE: After Rebalancing
**********************************************************************
* CURRENT PRICES:
*   FLOW: 1.50000000 MOET
*   YieldToken: 0.70000000 MOET
*   MOET: 1.00000000 (pegged)
**********************************************************************

======================================================================
| POSITION STATE: Auto-Borrow
======================================================================
| Position ID: 0
| Health Ratio: 1.27085648
======================================================================
| PRICES:
|   FLOW: 1.50000000 MOET
|   MOET: 1.00000000 (pegged)
======================================================================
| BALANCES:
|   MOET Debt: 944.24509586 (BORROWED)
|   -> Value: 944.24509586 MOET
|   FLOW Collateral: 1000.00000000
|   -> Value: 1500.00000000 MOET
======================================================================
| METRICS:
|   Effective Collateral: 1200.00000000 MOET
|   Utilization Rate: 78.68709100%
======================================================================


======================================================================
| AUTO-BALANCER STATE: Auto-Balancer
======================================================================
| Tide ID: 0
| AutoBalancer ID: 0
======================================================================
| PRICES:
|   FLOW: 1.50000000 MOET
|   YieldToken: 0.70000000 MOET
|   MOET: 1.00000000 (pegged)
======================================================================
| HOLDINGS:
|   YieldToken Balance: 971.62677300
|   -> Value in MOET: 680.13874110
|   -> Value in USD: 680.13874110
======================================================================
| POSITION METRICS:
|   Initial FLOW Deposit: 1000.00000000
|   Initial Value: 1500.00000000 MOET
|   Expected MOET Borrowed: ~923.07692307
|   Expected YieldTokens: ~1318.68131867
======================================================================
| PERFORMANCE:
|   Current/Expected Value: 73.68169600%
|   Status: BELOW threshold (<95%) - should rebalance UP
======================================================================


CHANGES:
  Health IMPROVED by: 0.15337797
  Balance DECREASED by: 637.84068260

======================================================================
|== Stage 5: Stabilization
======================================================================


======================================================================
| [PRICE UPDATE] Setting FLOW price
|    Token Identifier: A.0000000000000003.FlowToken.Vault
|    New Price: 0.80000000 MOET
|    Previous Price: (not tracked - consider adding if needed)
|    Price update successful
======================================================================


======================================================================
| [PRICE UPDATE] Setting YieldToken price
|    Token Identifier: A.0000000000000010.YieldToken.Vault
|    New Price: 1.20000000 MOET
|    Previous Price: (not tracked - consider adding if needed)
|    Price update successful
======================================================================


**********************************************************************
* MIXED SCENARIO STATE: Before Rebalancing
**********************************************************************
* CURRENT PRICES:
*   FLOW: 0.80000000 MOET
*   YieldToken: 1.20000000 MOET
*   MOET: 1.00000000 (pegged)
**********************************************************************

======================================================================
| POSITION STATE: Auto-Borrow
======================================================================
| Position ID: 0
| Health Ratio: 0.67779012
======================================================================
| PRICES:
|   FLOW: 0.80000000 MOET
|   MOET: 1.00000000 (pegged)
======================================================================
| BALANCES:
|   MOET Debt: 944.24509586 (BORROWED)
|   -> Value: 944.24509586 MOET
|   FLOW Collateral: 1000.00000000
|   -> Value: 800.00000000 MOET
======================================================================
| METRICS:
|   Effective Collateral: 640.00000000 MOET
|   Utilization Rate: 147.53829600%
======================================================================


======================================================================
| AUTO-BALANCER STATE: Auto-Balancer
======================================================================
| Tide ID: 0
| AutoBalancer ID: 0
======================================================================
| PRICES:
|   FLOW: 0.80000000 MOET
|   YieldToken: 1.20000000 MOET
|   MOET: 1.00000000 (pegged)
======================================================================
| HOLDINGS:
|   YieldToken Balance: 971.62677300
|   -> Value in MOET: 1165.95212760
|   -> Value in USD: 1165.95212760
======================================================================
| POSITION METRICS:
|   Initial FLOW Deposit: 1000.00000000
|   Initial Value: 800.00000000 MOET
|   Expected MOET Borrowed: ~492.30769230
|   Expected YieldTokens: ~410.25641025
======================================================================
| PERFORMANCE:
|   Current/Expected Value: 236.83402500%
|   Status: ABOVE threshold (>105%) - should rebalance DOWN
======================================================================


Triggering simultaneous rebalances...

**********************************************************************
* MIXED SCENARIO STATE: After Rebalancing
**********************************************************************
* CURRENT PRICES:
*   FLOW: 0.80000000 MOET
*   YieldToken: 1.20000000 MOET
*   MOET: 1.00000000 (pegged)
**********************************************************************

======================================================================
| POSITION STATE: Auto-Borrow
======================================================================
| Position ID: 0
| Health Ratio: 0.90316986
======================================================================
| PRICES:
|   FLOW: 0.80000000 MOET
|   MOET: 1.00000000 (pegged)
======================================================================
| BALANCES:
|   MOET Debt: 708.61531882 (BORROWED)
|   -> Value: 708.61531882 MOET
|   FLOW Collateral: 1000.00000000
|   -> Value: 800.00000000 MOET
======================================================================
| METRICS:
|   Effective Collateral: 640.00000000 MOET
|   Utilization Rate: 110.72114300%
======================================================================


======================================================================
| AUTO-BALANCER STATE: Auto-Balancer
======================================================================
| Tide ID: 0
| AutoBalancer ID: 0
======================================================================
| PRICES:
|   FLOW: 0.80000000 MOET
|   YieldToken: 1.20000000 MOET
|   MOET: 1.00000000 (pegged)
======================================================================
| HOLDINGS:
|   YieldToken Balance: 971.62677300
|   -> Value in MOET: 1165.95212760
|   -> Value in USD: 1165.95212760
======================================================================
| POSITION METRICS:
|   Initial FLOW Deposit: 1000.00000000
|   Initial Value: 800.00000000 MOET
|   Expected MOET Borrowed: ~492.30769230
|   Expected YieldTokens: ~410.25641025
======================================================================
| PERFORMANCE:
|   Current/Expected Value: 236.83402500%
|   Status: ABOVE threshold (>105%) - should rebalance DOWN
======================================================================


CHANGES:
  Health IMPROVED by: 0.22537974
  Balance UNCHANGED

======================================================================
|== Final State Summary
======================================================================


**********************************************************************
* MIXED SCENARIO STATE: Final State
**********************************************************************
* CURRENT PRICES:
*   FLOW: 0.80000000 MOET
*   YieldToken: 1.20000000 MOET
*   MOET: 1.00000000 (pegged)
**********************************************************************

======================================================================
| POSITION STATE: Auto-Borrow
======================================================================
| Position ID: 0
| Health Ratio: 0.90316986
======================================================================
| PRICES:
|   FLOW: 0.80000000 MOET
|   MOET: 1.00000000 (pegged)
======================================================================
| BALANCES:
|   MOET Debt: 708.61531882 (BORROWED)
|   -> Value: 708.61531882 MOET
|   FLOW Collateral: 1000.00000000
|   -> Value: 800.00000000 MOET
======================================================================
| METRICS:
|   Effective Collateral: 640.00000000 MOET
|   Utilization Rate: 110.72114300%
======================================================================


======================================================================
| AUTO-BALANCER STATE: Auto-Balancer
======================================================================
| Tide ID: 0
| AutoBalancer ID: 0
======================================================================
| PRICES:
|   FLOW: 0.80000000 MOET
|   YieldToken: 1.20000000 MOET
|   MOET: 1.00000000 (pegged)
======================================================================
| HOLDINGS:
|   YieldToken Balance: 971.62677300
|   -> Value in MOET: 1165.95212760
|   -> Value in USD: 1165.95212760
======================================================================
| POSITION METRICS:
|   Initial FLOW Deposit: 1000.00000000
|   Initial Value: 800.00000000 MOET
|   Expected MOET Borrowed: ~492.30769230
|   Expected YieldTokens: ~410.25641025
======================================================================
| PERFORMANCE:
|   Current/Expected Value: 236.83402500%
|   Status: ABOVE threshold (>105%) - should rebalance DOWN
======================================================================


OVERALL CHANGES:
  Borrow Health: 1.30000000 -> 0.90316986
  Balancer Balance: 615.38461538 -> 971.62677300 YieldToken

Generated test file: ./cadence/tests/generated_mixed_test.cdc
Running mixed scenario test with 6 price points...
Scenario: Inverse Correlation Scenario
FLOW Prices: [1.0, 0.5, 2.0, 0.3, 1.5, 0.8]
Yield Prices: [1.0, 2.0, 0.5, 3.0, 0.7, 1.2]


Test results: "./cadence/tests/generated_mixed_test.cdc"
- PASS: testMixedPriceScenario
Coverage: 73.7% of statements



[10/10] Testing decorrelated price movements (NEW)...

======================================================================
|== MIXED SCENARIO: Decorrelated Price Movements
======================================================================

Creating auto-borrow position with 1000 FLOW...
Creating auto-balancer Tide with 1000 FLOW...

======================================================================
|== Initial State
======================================================================


**********************************************************************
* MIXED SCENARIO STATE: Initial State
**********************************************************************
* CURRENT PRICES:
*   FLOW: 1.00000000 MOET
*   YieldToken: 1.00000000 MOET
*   MOET: 1.00000000 (pegged)
**********************************************************************

======================================================================
| POSITION STATE: Auto-Borrow
======================================================================
| Position ID: 0
| Health Ratio: 1.30000000
======================================================================
| PRICES:
|   FLOW: 1.00000000 MOET
|   MOET: 1.00000000 (pegged)
======================================================================
| BALANCES:
|   MOET Debt: 615.38461538 (BORROWED)
|   -> Value: 615.38461538 MOET
|   FLOW Collateral: 1000.00000000
|   -> Value: 1000.00000000 MOET
======================================================================
| METRICS:
|   Effective Collateral: 800.00000000 MOET
|   Utilization Rate: 76.92307600%
======================================================================


======================================================================
| AUTO-BALANCER STATE: Auto-Balancer
======================================================================
| Tide ID: 0
| AutoBalancer ID: 0
======================================================================
| PRICES:
|   FLOW: 1.00000000 MOET
|   YieldToken: 1.00000000 MOET
|   MOET: 1.00000000 (pegged)
======================================================================
| HOLDINGS:
|   YieldToken Balance: 615.38461538
|   -> Value in MOET: 615.38461538
|   -> Value in USD: 615.38461538
======================================================================
| POSITION METRICS:
|   Initial FLOW Deposit: 1000.00000000
|   Initial Value: 1000.00000000 MOET
|   Expected MOET Borrowed: ~615.38461538
|   Expected YieldTokens: ~615.38461538
======================================================================
| PERFORMANCE:
|   Current/Expected Value: 100.00000000%
|   Status: WITHIN threshold (95-105%) - no rebalance needed
======================================================================


======================================================================
|== Stage 0: Baseline
======================================================================


======================================================================
| [PRICE UPDATE] Setting FLOW price
|    Token Identifier: A.0000000000000003.FlowToken.Vault
|    New Price: 1.00000000 MOET
|    Previous Price: (not tracked - consider adding if needed)
|    Price update successful
======================================================================


======================================================================
| [PRICE UPDATE] Setting YieldToken price
|    Token Identifier: A.0000000000000010.YieldToken.Vault
|    New Price: 1.00000000 MOET
|    Previous Price: (not tracked - consider adding if needed)
|    Price update successful
======================================================================


**********************************************************************
* MIXED SCENARIO STATE: Before Rebalancing
**********************************************************************
* CURRENT PRICES:
*   FLOW: 1.00000000 MOET
*   YieldToken: 1.00000000 MOET
*   MOET: 1.00000000 (pegged)
**********************************************************************

======================================================================
| POSITION STATE: Auto-Borrow
======================================================================
| Position ID: 0
| Health Ratio: 1.30000000
======================================================================
| PRICES:
|   FLOW: 1.00000000 MOET
|   MOET: 1.00000000 (pegged)
======================================================================
| BALANCES:
|   MOET Debt: 615.38461538 (BORROWED)
|   -> Value: 615.38461538 MOET
|   FLOW Collateral: 1000.00000000
|   -> Value: 1000.00000000 MOET
======================================================================
| METRICS:
|   Effective Collateral: 800.00000000 MOET
|   Utilization Rate: 76.92307600%
======================================================================


======================================================================
| AUTO-BALANCER STATE: Auto-Balancer
======================================================================
| Tide ID: 0
| AutoBalancer ID: 0
======================================================================
| PRICES:
|   FLOW: 1.00000000 MOET
|   YieldToken: 1.00000000 MOET
|   MOET: 1.00000000 (pegged)
======================================================================
| HOLDINGS:
|   YieldToken Balance: 615.38461538
|   -> Value in MOET: 615.38461538
|   -> Value in USD: 615.38461538
======================================================================
| POSITION METRICS:
|   Initial FLOW Deposit: 1000.00000000
|   Initial Value: 1000.00000000 MOET
|   Expected MOET Borrowed: ~615.38461538
|   Expected YieldTokens: ~615.38461538
======================================================================
| PERFORMANCE:
|   Current/Expected Value: 100.00000000%
|   Status: WITHIN threshold (95-105%) - no rebalance needed
======================================================================


Triggering simultaneous rebalances...

**********************************************************************
* MIXED SCENARIO STATE: After Rebalancing
**********************************************************************
* CURRENT PRICES:
*   FLOW: 1.00000000 MOET
*   YieldToken: 1.00000000 MOET
*   MOET: 1.00000000 (pegged)
**********************************************************************

======================================================================
| POSITION STATE: Auto-Borrow
======================================================================
| Position ID: 0
| Health Ratio: 1.30000000
======================================================================
| PRICES:
|   FLOW: 1.00000000 MOET
|   MOET: 1.00000000 (pegged)
======================================================================
| BALANCES:
|   MOET Debt: 615.38461538 (BORROWED)
|   -> Value: 615.38461538 MOET
|   FLOW Collateral: 1000.00000000
|   -> Value: 1000.00000000 MOET
======================================================================
| METRICS:
|   Effective Collateral: 800.00000000 MOET
|   Utilization Rate: 76.92307600%
======================================================================


======================================================================
| AUTO-BALANCER STATE: Auto-Balancer
======================================================================
| Tide ID: 0
| AutoBalancer ID: 0
======================================================================
| PRICES:
|   FLOW: 1.00000000 MOET
|   YieldToken: 1.00000000 MOET
|   MOET: 1.00000000 (pegged)
======================================================================
| HOLDINGS:
|   YieldToken Balance: 615.38461538
|   -> Value in MOET: 615.38461538
|   -> Value in USD: 615.38461538
======================================================================
| POSITION METRICS:
|   Initial FLOW Deposit: 1000.00000000
|   Initial Value: 1000.00000000 MOET
|   Expected MOET Borrowed: ~615.38461538
|   Expected YieldTokens: ~615.38461538
======================================================================
| PERFORMANCE:
|   Current/Expected Value: 100.00000000%
|   Status: WITHIN threshold (95-105%) - no rebalance needed
======================================================================


CHANGES:
  Health UNCHANGED
  Balance UNCHANGED

======================================================================
|== Stage 1: FLOW stable, Yield stable
======================================================================


======================================================================
| [PRICE UPDATE] Setting FLOW price
|    Token Identifier: A.0000000000000003.FlowToken.Vault
|    New Price: 1.10000000 MOET
|    Previous Price: (not tracked - consider adding if needed)
|    Price update successful
======================================================================


======================================================================
| [PRICE UPDATE] Setting YieldToken price
|    Token Identifier: A.0000000000000010.YieldToken.Vault
|    New Price: 1.00000000 MOET
|    Previous Price: (not tracked - consider adding if needed)
|    Price update successful
======================================================================


**********************************************************************
* MIXED SCENARIO STATE: Before Rebalancing
**********************************************************************
* CURRENT PRICES:
*   FLOW: 1.10000000 MOET
*   YieldToken: 1.00000000 MOET
*   MOET: 1.00000000 (pegged)
**********************************************************************

======================================================================
| POSITION STATE: Auto-Borrow
======================================================================
| Position ID: 0
| Health Ratio: 1.43000000
======================================================================
| PRICES:
|   FLOW: 1.10000000 MOET
|   MOET: 1.00000000 (pegged)
======================================================================
| BALANCES:
|   MOET Debt: 615.38461538 (BORROWED)
|   -> Value: 615.38461538 MOET
|   FLOW Collateral: 1000.00000000
|   -> Value: 1100.00000000 MOET
======================================================================
| METRICS:
|   Effective Collateral: 880.00000000 MOET
|   Utilization Rate: 69.93006900%
======================================================================


======================================================================
| AUTO-BALANCER STATE: Auto-Balancer
======================================================================
| Tide ID: 0
| AutoBalancer ID: 0
======================================================================
| PRICES:
|   FLOW: 1.10000000 MOET
|   YieldToken: 1.00000000 MOET
|   MOET: 1.00000000 (pegged)
======================================================================
| HOLDINGS:
|   YieldToken Balance: 615.38461538
|   -> Value in MOET: 615.38461538
|   -> Value in USD: 615.38461538
======================================================================
| POSITION METRICS:
|   Initial FLOW Deposit: 1000.00000000
|   Initial Value: 1100.00000000 MOET
|   Expected MOET Borrowed: ~676.92307692
|   Expected YieldTokens: ~676.92307692
======================================================================
| PERFORMANCE:
|   Current/Expected Value: 90.90909000%
|   Status: BELOW threshold (<95%) - should rebalance UP
======================================================================


Triggering simultaneous rebalances...

**********************************************************************
* MIXED SCENARIO STATE: After Rebalancing
**********************************************************************
* CURRENT PRICES:
*   FLOW: 1.10000000 MOET
*   YieldToken: 1.00000000 MOET
*   MOET: 1.00000000 (pegged)
**********************************************************************

======================================================================
| POSITION STATE: Auto-Borrow
======================================================================
| Position ID: 0
| Health Ratio: 1.30000000
======================================================================
| PRICES:
|   FLOW: 1.10000000 MOET
|   MOET: 1.00000000 (pegged)
======================================================================
| BALANCES:
|   MOET Debt: 676.92307692 (BORROWED)
|   -> Value: 676.92307692 MOET
|   FLOW Collateral: 1000.00000000
|   -> Value: 1100.00000000 MOET
======================================================================
| METRICS:
|   Effective Collateral: 880.00000000 MOET
|   Utilization Rate: 76.92307600%
======================================================================


======================================================================
| AUTO-BALANCER STATE: Auto-Balancer
======================================================================
| Tide ID: 0
| AutoBalancer ID: 0
======================================================================
| PRICES:
|   FLOW: 1.10000000 MOET
|   YieldToken: 1.00000000 MOET
|   MOET: 1.00000000 (pegged)
======================================================================
| HOLDINGS:
|   YieldToken Balance: 615.38461538
|   -> Value in MOET: 615.38461538
|   -> Value in USD: 615.38461538
======================================================================
| POSITION METRICS:
|   Initial FLOW Deposit: 1000.00000000
|   Initial Value: 1100.00000000 MOET
|   Expected MOET Borrowed: ~676.92307692
|   Expected YieldTokens: ~676.92307692
======================================================================
| PERFORMANCE:
|   Current/Expected Value: 90.90909000%
|   Status: BELOW threshold (<95%) - should rebalance UP
======================================================================


CHANGES:
  Health DETERIORATED by: 0.13000000
  Balance UNCHANGED

======================================================================
|== Stage 2: FLOW stable, Yield pumps
======================================================================


======================================================================
| [PRICE UPDATE] Setting FLOW price
|    Token Identifier: A.0000000000000003.FlowToken.Vault
|    New Price: 0.90000000 MOET
|    Previous Price: (not tracked - consider adding if needed)
|    Price update successful
======================================================================


======================================================================
| [PRICE UPDATE] Setting YieldToken price
|    Token Identifier: A.0000000000000010.YieldToken.Vault
|    New Price: 1.50000000 MOET
|    Previous Price: (not tracked - consider adding if needed)
|    Price update successful
======================================================================


**********************************************************************
* MIXED SCENARIO STATE: Before Rebalancing
**********************************************************************
* CURRENT PRICES:
*   FLOW: 0.90000000 MOET
*   YieldToken: 1.50000000 MOET
*   MOET: 1.00000000 (pegged)
**********************************************************************

======================================================================
| POSITION STATE: Auto-Borrow
======================================================================
| Position ID: 0
| Health Ratio: 1.06363636
======================================================================
| PRICES:
|   FLOW: 0.90000000 MOET
|   MOET: 1.00000000 (pegged)
======================================================================
| BALANCES:
|   MOET Debt: 676.92307692 (BORROWED)
|   -> Value: 676.92307692 MOET
|   FLOW Collateral: 1000.00000000
|   -> Value: 900.00000000 MOET
======================================================================
| METRICS:
|   Effective Collateral: 720.00000000 MOET
|   Utilization Rate: 94.01709400%
======================================================================


======================================================================
| AUTO-BALANCER STATE: Auto-Balancer
======================================================================
| Tide ID: 0
| AutoBalancer ID: 0
======================================================================
| PRICES:
|   FLOW: 0.90000000 MOET
|   YieldToken: 1.50000000 MOET
|   MOET: 1.00000000 (pegged)
======================================================================
| HOLDINGS:
|   YieldToken Balance: 615.38461538
|   -> Value in MOET: 923.07692307
|   -> Value in USD: 923.07692307
======================================================================
| POSITION METRICS:
|   Initial FLOW Deposit: 1000.00000000
|   Initial Value: 900.00000000 MOET
|   Expected MOET Borrowed: ~553.84615384
|   Expected YieldTokens: ~369.23076922
======================================================================
| PERFORMANCE:
|   Current/Expected Value: 166.66666600%
|   Status: ABOVE threshold (>105%) - should rebalance DOWN
======================================================================


Triggering simultaneous rebalances...

**********************************************************************
* MIXED SCENARIO STATE: After Rebalancing
**********************************************************************
* CURRENT PRICES:
*   FLOW: 0.90000000 MOET
*   YieldToken: 1.50000000 MOET
*   MOET: 1.00000000 (pegged)
**********************************************************************

======================================================================
| POSITION STATE: Auto-Borrow
======================================================================
| Position ID: 0
| Health Ratio: 1.24951456
======================================================================
| PRICES:
|   FLOW: 0.90000000 MOET
|   MOET: 1.00000000 (pegged)
======================================================================
| BALANCES:
|   MOET Debt: 576.22377468 (BORROWED)
|   -> Value: 576.22377468 MOET
|   FLOW Collateral: 1000.00000000
|   -> Value: 900.00000000 MOET
======================================================================
| METRICS:
|   Effective Collateral: 720.00000000 MOET
|   Utilization Rate: 80.03107900%
======================================================================


======================================================================
| AUTO-BALANCER STATE: Auto-Balancer
======================================================================
| Tide ID: 0
| AutoBalancer ID: 0
======================================================================
| PRICES:
|   FLOW: 0.90000000 MOET
|   YieldToken: 1.50000000 MOET
|   MOET: 1.00000000 (pegged)
======================================================================
| HOLDINGS:
|   YieldToken Balance: 615.38461538
|   -> Value in MOET: 923.07692307
|   -> Value in USD: 923.07692307
======================================================================
| POSITION METRICS:
|   Initial FLOW Deposit: 1000.00000000
|   Initial Value: 900.00000000 MOET
|   Expected MOET Borrowed: ~553.84615384
|   Expected YieldTokens: ~369.23076922
======================================================================
| PERFORMANCE:
|   Current/Expected Value: 166.66666600%
|   Status: ABOVE threshold (>105%) - should rebalance DOWN
======================================================================


CHANGES:
  Health IMPROVED by: 0.18587820
  Balance UNCHANGED

======================================================================
|== Stage 3: FLOW rises, Yield crashes
======================================================================


======================================================================
| [PRICE UPDATE] Setting FLOW price
|    Token Identifier: A.0000000000000003.FlowToken.Vault
|    New Price: 1.20000000 MOET
|    Previous Price: (not tracked - consider adding if needed)
|    Price update successful
======================================================================


======================================================================
| [PRICE UPDATE] Setting YieldToken price
|    Token Identifier: A.0000000000000010.YieldToken.Vault
|    New Price: 0.70000000 MOET
|    Previous Price: (not tracked - consider adding if needed)
|    Price update successful
======================================================================


**********************************************************************
* MIXED SCENARIO STATE: Before Rebalancing
**********************************************************************
* CURRENT PRICES:
*   FLOW: 1.20000000 MOET
*   YieldToken: 0.70000000 MOET
*   MOET: 1.00000000 (pegged)
**********************************************************************

======================================================================
| POSITION STATE: Auto-Borrow
======================================================================
| Position ID: 0
| Health Ratio: 1.66601942
======================================================================
| PRICES:
|   FLOW: 1.20000000 MOET
|   MOET: 1.00000000 (pegged)
======================================================================
| BALANCES:
|   MOET Debt: 576.22377468 (BORROWED)
|   -> Value: 576.22377468 MOET
|   FLOW Collateral: 1000.00000000
|   -> Value: 1200.00000000 MOET
======================================================================
| METRICS:
|   Effective Collateral: 960.00000000 MOET
|   Utilization Rate: 60.02330900%
======================================================================


======================================================================
| AUTO-BALANCER STATE: Auto-Balancer
======================================================================
| Tide ID: 0
| AutoBalancer ID: 0
======================================================================
| PRICES:
|   FLOW: 1.20000000 MOET
|   YieldToken: 0.70000000 MOET
|   MOET: 1.00000000 (pegged)
======================================================================
| HOLDINGS:
|   YieldToken Balance: 615.38461538
|   -> Value in MOET: 430.76923076
|   -> Value in USD: 430.76923076
======================================================================
| POSITION METRICS:
|   Initial FLOW Deposit: 1000.00000000
|   Initial Value: 1200.00000000 MOET
|   Expected MOET Borrowed: ~738.46153846
|   Expected YieldTokens: ~1054.94505494
======================================================================
| PERFORMANCE:
|   Current/Expected Value: 58.33333300%
|   Status: BELOW threshold (<95%) - should rebalance UP
======================================================================


Triggering simultaneous rebalances...

**********************************************************************
* MIXED SCENARIO STATE: After Rebalancing
**********************************************************************
* CURRENT PRICES:
*   FLOW: 1.20000000 MOET
*   YieldToken: 0.70000000 MOET
*   MOET: 1.00000000 (pegged)
**********************************************************************

======================================================================
| POSITION STATE: Auto-Borrow
======================================================================
| Position ID: 0
| Health Ratio: 1.30000000
======================================================================
| PRICES:
|   FLOW: 1.20000000 MOET
|   MOET: 1.00000000 (pegged)
======================================================================
| BALANCES:
|   MOET Debt: 738.46153846 (BORROWED)
|   -> Value: 738.46153846 MOET
|   FLOW Collateral: 1000.00000000
|   -> Value: 1200.00000000 MOET
======================================================================
| METRICS:
|   Effective Collateral: 960.00000000 MOET
|   Utilization Rate: 76.92307600%
======================================================================


======================================================================
| AUTO-BALANCER STATE: Auto-Balancer
======================================================================
| Tide ID: 0
| AutoBalancer ID: 0
======================================================================
| PRICES:
|   FLOW: 1.20000000 MOET
|   YieldToken: 0.70000000 MOET
|   MOET: 1.00000000 (pegged)
======================================================================
| HOLDINGS:
|   YieldToken Balance: 689.77176372
|   -> Value in MOET: 482.84023460
|   -> Value in USD: 482.84023460
======================================================================
| POSITION METRICS:
|   Initial FLOW Deposit: 1000.00000000
|   Initial Value: 1200.00000000 MOET
|   Expected MOET Borrowed: ~738.46153846
|   Expected YieldTokens: ~1054.94505494
======================================================================
| PERFORMANCE:
|   Current/Expected Value: 65.38461500%
|   Status: BELOW threshold (<95%) - should rebalance UP
======================================================================


CHANGES:
  Health DETERIORATED by: 0.36601942
  Balance INCREASED by: 74.38714834

======================================================================
|== Stage 4: FLOW drops, Yield moons
======================================================================


======================================================================
| [PRICE UPDATE] Setting FLOW price
|    Token Identifier: A.0000000000000003.FlowToken.Vault
|    New Price: 0.80000000 MOET
|    Previous Price: (not tracked - consider adding if needed)
|    Price update successful
======================================================================


======================================================================
| [PRICE UPDATE] Setting YieldToken price
|    Token Identifier: A.0000000000000010.YieldToken.Vault
|    New Price: 2.00000000 MOET
|    Previous Price: (not tracked - consider adding if needed)
|    Price update successful
======================================================================


**********************************************************************
* MIXED SCENARIO STATE: Before Rebalancing
**********************************************************************
* CURRENT PRICES:
*   FLOW: 0.80000000 MOET
*   YieldToken: 2.00000000 MOET
*   MOET: 1.00000000 (pegged)
**********************************************************************

======================================================================
| POSITION STATE: Auto-Borrow
======================================================================
| Position ID: 0
| Health Ratio: 0.86666666
======================================================================
| PRICES:
|   FLOW: 0.80000000 MOET
|   MOET: 1.00000000 (pegged)
======================================================================
| BALANCES:
|   MOET Debt: 738.46153846 (BORROWED)
|   -> Value: 738.46153846 MOET
|   FLOW Collateral: 1000.00000000
|   -> Value: 800.00000000 MOET
======================================================================
| METRICS:
|   Effective Collateral: 640.00000000 MOET
|   Utilization Rate: 115.38461500%
======================================================================


======================================================================
| AUTO-BALANCER STATE: Auto-Balancer
======================================================================
| Tide ID: 0
| AutoBalancer ID: 0
======================================================================
| PRICES:
|   FLOW: 0.80000000 MOET
|   YieldToken: 2.00000000 MOET
|   MOET: 1.00000000 (pegged)
======================================================================
| HOLDINGS:
|   YieldToken Balance: 689.77176372
|   -> Value in MOET: 1379.54352744
|   -> Value in USD: 1379.54352744
======================================================================
| POSITION METRICS:
|   Initial FLOW Deposit: 1000.00000000
|   Initial Value: 800.00000000 MOET
|   Expected MOET Borrowed: ~492.30769230
|   Expected YieldTokens: ~246.15384615
======================================================================
| PERFORMANCE:
|   Current/Expected Value: 280.21977900%
|   Status: ABOVE threshold (>105%) - should rebalance DOWN
======================================================================


Triggering simultaneous rebalances...

**********************************************************************
* MIXED SCENARIO STATE: After Rebalancing
**********************************************************************
* CURRENT PRICES:
*   FLOW: 0.80000000 MOET
*   YieldToken: 2.00000000 MOET
*   MOET: 1.00000000 (pegged)
**********************************************************************

======================================================================
| POSITION STATE: Auto-Borrow
======================================================================
| Position ID: 0
| Health Ratio: 1.11428571
======================================================================
| PRICES:
|   FLOW: 0.80000000 MOET
|   MOET: 1.00000000 (pegged)
======================================================================
| BALANCES:
|   MOET Debt: 574.35897184 (BORROWED)
|   -> Value: 574.35897184 MOET
|   FLOW Collateral: 1000.00000000
|   -> Value: 800.00000000 MOET
======================================================================
| METRICS:
|   Effective Collateral: 640.00000000 MOET
|   Utilization Rate: 89.74358900%
======================================================================


======================================================================
| AUTO-BALANCER STATE: Auto-Balancer
======================================================================
| Tide ID: 0
| AutoBalancer ID: 0
======================================================================
| PRICES:
|   FLOW: 0.80000000 MOET
|   YieldToken: 2.00000000 MOET
|   MOET: 1.00000000 (pegged)
======================================================================
| HOLDINGS:
|   YieldToken Balance: 689.77176372
|   -> Value in MOET: 1379.54352744
|   -> Value in USD: 1379.54352744
======================================================================
| POSITION METRICS:
|   Initial FLOW Deposit: 1000.00000000
|   Initial Value: 800.00000000 MOET
|   Expected MOET Borrowed: ~492.30769230
|   Expected YieldTokens: ~246.15384615
======================================================================
| PERFORMANCE:
|   Current/Expected Value: 280.21977900%
|   Status: ABOVE threshold (>105%) - should rebalance DOWN
======================================================================


CHANGES:
  Health IMPROVED by: 0.24761905
  Balance UNCHANGED

======================================================================
|== Stage 5: Return to baseline
======================================================================


======================================================================
| [PRICE UPDATE] Setting FLOW price
|    Token Identifier: A.0000000000000003.FlowToken.Vault
|    New Price: 1.00000000 MOET
|    Previous Price: (not tracked - consider adding if needed)
|    Price update successful
======================================================================


======================================================================
| [PRICE UPDATE] Setting YieldToken price
|    Token Identifier: A.0000000000000010.YieldToken.Vault
|    New Price: 0.50000000 MOET
|    Previous Price: (not tracked - consider adding if needed)
|    Price update successful
======================================================================


**********************************************************************
* MIXED SCENARIO STATE: Before Rebalancing
**********************************************************************
* CURRENT PRICES:
*   FLOW: 1.00000000 MOET
*   YieldToken: 0.50000000 MOET
*   MOET: 1.00000000 (pegged)
**********************************************************************

======================================================================
| POSITION STATE: Auto-Borrow
======================================================================
| Position ID: 0
| Health Ratio: 1.39285714
======================================================================
| PRICES:
|   FLOW: 1.00000000 MOET
|   MOET: 1.00000000 (pegged)
======================================================================
| BALANCES:
|   MOET Debt: 574.35897184 (BORROWED)
|   -> Value: 574.35897184 MOET
|   FLOW Collateral: 1000.00000000
|   -> Value: 1000.00000000 MOET
======================================================================
| METRICS:
|   Effective Collateral: 800.00000000 MOET
|   Utilization Rate: 71.79487100%
======================================================================


======================================================================
| AUTO-BALANCER STATE: Auto-Balancer
======================================================================
| Tide ID: 0
| AutoBalancer ID: 0
======================================================================
| PRICES:
|   FLOW: 1.00000000 MOET
|   YieldToken: 0.50000000 MOET
|   MOET: 1.00000000 (pegged)
======================================================================
| HOLDINGS:
|   YieldToken Balance: 689.77176372
|   -> Value in MOET: 344.88588186
|   -> Value in USD: 344.88588186
======================================================================
| POSITION METRICS:
|   Initial FLOW Deposit: 1000.00000000
|   Initial Value: 1000.00000000 MOET
|   Expected MOET Borrowed: ~615.38461538
|   Expected YieldTokens: ~1230.76923076
======================================================================
| PERFORMANCE:
|   Current/Expected Value: 56.04395500%
|   Status: BELOW threshold (<95%) - should rebalance UP
======================================================================


Triggering simultaneous rebalances...

**********************************************************************
* MIXED SCENARIO STATE: After Rebalancing
**********************************************************************
* CURRENT PRICES:
*   FLOW: 1.00000000 MOET
*   YieldToken: 0.50000000 MOET
*   MOET: 1.00000000 (pegged)
**********************************************************************

======================================================================
| POSITION STATE: Auto-Borrow
======================================================================
| Position ID: 0
| Health Ratio: 1.30000000
======================================================================
| PRICES:
|   FLOW: 1.00000000 MOET
|   MOET: 1.00000000 (pegged)
======================================================================
| BALANCES:
|   MOET Debt: 615.38461538 (BORROWED)
|   -> Value: 615.38461538 MOET
|   FLOW Collateral: 1000.00000000
|   -> Value: 1000.00000000 MOET
======================================================================
| METRICS:
|   Effective Collateral: 800.00000000 MOET
|   Utilization Rate: 76.92307600%
======================================================================


======================================================================
| AUTO-BALANCER STATE: Auto-Balancer
======================================================================
| Tide ID: 0
| AutoBalancer ID: 0
======================================================================
| PRICES:
|   FLOW: 1.00000000 MOET
|   YieldToken: 0.50000000 MOET
|   MOET: 1.00000000 (pegged)
======================================================================
| HOLDINGS:
|   YieldToken Balance: 140.45126308
|   -> Value in MOET: 70.22563154
|   -> Value in USD: 70.22563154
======================================================================
| POSITION METRICS:
|   Initial FLOW Deposit: 1000.00000000
|   Initial Value: 1000.00000000 MOET
|   Expected MOET Borrowed: ~615.38461538
|   Expected YieldTokens: ~1230.76923076
======================================================================
| PERFORMANCE:
|   Current/Expected Value: 11.41166500%
|   Status: BELOW threshold (<95%) - should rebalance UP
======================================================================


CHANGES:
  Health DETERIORATED by: 0.09285714
  Balance DECREASED by: 549.32050064

======================================================================
|== Final State Summary
======================================================================


**********************************************************************
* MIXED SCENARIO STATE: Final State
**********************************************************************
* CURRENT PRICES:
*   FLOW: 1.00000000 MOET
*   YieldToken: 0.50000000 MOET
*   MOET: 1.00000000 (pegged)
**********************************************************************

======================================================================
| POSITION STATE: Auto-Borrow
======================================================================
| Position ID: 0
| Health Ratio: 1.30000000
======================================================================
| PRICES:
|   FLOW: 1.00000000 MOET
|   MOET: 1.00000000 (pegged)
======================================================================
| BALANCES:
|   MOET Debt: 615.38461538 (BORROWED)
|   -> Value: 615.38461538 MOET
|   FLOW Collateral: 1000.00000000
|   -> Value: 1000.00000000 MOET
======================================================================
| METRICS:
|   Effective Collateral: 800.00000000 MOET
|   Utilization Rate: 76.92307600%
======================================================================


======================================================================
| AUTO-BALANCER STATE: Auto-Balancer
======================================================================
| Tide ID: 0
| AutoBalancer ID: 0
======================================================================
| PRICES:
|   FLOW: 1.00000000 MOET
|   YieldToken: 0.50000000 MOET
|   MOET: 1.00000000 (pegged)
======================================================================
| HOLDINGS:
|   YieldToken Balance: 140.45126308
|   -> Value in MOET: 70.22563154
|   -> Value in USD: 70.22563154
======================================================================
| POSITION METRICS:
|   Initial FLOW Deposit: 1000.00000000
|   Initial Value: 1000.00000000 MOET
|   Expected MOET Borrowed: ~615.38461538
|   Expected YieldTokens: ~1230.76923076
======================================================================
| PERFORMANCE:
|   Current/Expected Value: 11.41166500%
|   Status: BELOW threshold (<95%) - should rebalance UP
======================================================================


OVERALL CHANGES:
  Borrow Health: 1.30000000 -> 1.30000000
  Balancer Balance: 615.38461538 -> 140.45126308 YieldToken

Generated test file: ./cadence/tests/generated_mixed_test.cdc
Running mixed scenario test with 6 price points...
Scenario: Decorrelated Price Movements
FLOW Prices: [1.0, 1.1, 0.9, 1.2, 0.8, 1.0]
Yield Prices: [1.0, 1.0, 1.5, 0.7, 2.0, 0.5]


Test results: "./cadence/tests/generated_mixed_test.cdc"
- PASS: testMixedPriceScenario
Coverage: 72.6% of statements



==================================================================
All tests completed successfully!
==================================================================
